unit EplanCalcTool;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, EPlanUtilityBasefrm, Vcl.StdActns,
  Vcl.ActnList, Vcl.ImgList, Vcl.Menus, Vcl.ComCtrls, Vcl.ToolWin,
  Vcl.Imaging.jpeg, Vcl.ExtCtrls, Vcl.StdCtrls, shellApi, Vcl.Buttons, ePlanUtils,
  VCLTee.TeEngine, VCLTee.Series, VCLTee.TeeProcs, VCLTee.Chart,
  Vcl.Imaging.pngimage, Vcl.DBCtrls, Vcl.Grids, Vcl.DBGrids, Vcl.ActnMan,
  Vcl.ActnCtrls, Vcl.Ribbon, Vcl.RibbonLunaStyleActnCtrls, Vcl.ValEdit,
  Vcl.ActnColorMaps;

type
  TExecuteToolMain = class(TEPlanUtilityBaseform)

    Text: TEdit;
    OpenDialog1: TOpenDialog;
    Reset: TBitBtn;
    ScrollBox3: TScrollBox;
    PageControl3: TPageControl;
    Overview: TTabSheet;
    Screen: TTabSheet;
    buDumpAscii: TButton;
    buSelectDataFileSum: TBitBtn;
    Button1: TButton;
    Button2: TButton;
    Button3: TButton;
    ChoseProgram: TButton;
    Label1: TLabel;
    Label2: TLabel;
    Label3: TLabel;
    Label5: TLabel;
    Label7: TLabel;
    Label8: TLabel;
    LabelTestWarning: TLabel;
    PrintDialog1: TPrintDialog;
    ButtonResultInputFile1: TBitBtn;
    Label6: TLabel;
    Label24: TLabel;
    Label4: TLabel;
    ButtonIncludeInputFile1: TBitBtn;
    buSelectDataFile1: TBitBtn;
    LabelNameInputFile1: TLabel;
    ButtonResultInputFile2: TBitBtn;
    ButtonIncludeInputFile2: TBitBtn;
    buSelectDataFile2: TBitBtn;
    LabelNameInputFile2: TLabel;
    ButtonResultInputFile3: TBitBtn;
    ButtonIncludeInputFile3: TBitBtn;
    buSelectDataFile3: TBitBtn;
    LabelNameInputFile3: TLabel;
    ButtonResultInputFile4: TBitBtn;
    ButtonIncludeInputFile4: TBitBtn;
    buSelectDataFile4: TBitBtn;
    LabelNameInputFile4: TLabel;
    ButtonResultInputFile5: TBitBtn;
    ButtonIncludeInputFile5: TBitBtn;
    buSelectDataFile5: TBitBtn;
    LabelNameInputFile5: TLabel;
    ButtonResultInputFile6: TBitBtn;
    ButtonIncludeInputFile6: TBitBtn;
    buSelectDataFile6: TBitBtn;
    LabelNameInputFile6: TLabel;
    ButtonResultInputFile7: TBitBtn;
    ButtonIncludeInputFile7: TBitBtn;
    buSelectDataFile7: TBitBtn;
    LabelNameInputFile7: TLabel;
    ButtonResultInputFile8: TBitBtn;
    ButtonIncludeInputFile8: TBitBtn;
    buSelectDataFile8: TBitBtn;
    LabelNameInputFile8: TLabel;
    ButtonResultInputFile9: TBitBtn;
    ButtonIncludeInputFile9: TBitBtn;
    buSelectDataFile9: TBitBtn;
    ButtonResultInputFile10: TBitBtn;
    ButtonIncludeInputFile10: TBitBtn;
    buSelectDataFile10: TBitBtn;
    LabelNameInputFile10: TLabel;
    LabelNameInputFile9: TLabel;
    ButtonResultInputFile11: TBitBtn;
    ButtonIncludeInputFile11: TBitBtn;
    buSelectDataFile11: TBitBtn;
    ButtonResultInputFile12: TBitBtn;
    ButtonIncludeInputFile12: TBitBtn;
    buSelectDataFile12: TBitBtn;
    ButtonResultInputFile13: TBitBtn;
    ButtonIncludeInputFile13: TBitBtn;
    buSelectDataFile13: TBitBtn;
    LabelNameInputFile13: TLabel;
    LabelNameInputFile12: TLabel;
    LabelNameInputFile11: TLabel;
    ButtonResultInputFile14: TBitBtn;
    ButtonIncludeInputFile14: TBitBtn;
    buSelectDataFile14: TBitBtn;
    LabelNameInputFile14: TLabel;
    ButtonResultInputFile28: TBitBtn;
    ButtonResultInputFile27: TBitBtn;
    ButtonResultInputFile26: TBitBtn;
    ButtonResultInputFile25: TBitBtn;
    ButtonResultInputFile24: TBitBtn;
    ButtonResultInputFile23: TBitBtn;
    ButtonResultInputFile22: TBitBtn;
    ButtonResultInputFile21: TBitBtn;
    ButtonResultInputFile20: TBitBtn;
    ButtonResultInputFile19: TBitBtn;
    ButtonResultInputFile18: TBitBtn;
    ButtonResultInputFile17: TBitBtn;
    ButtonResultInputFile16: TBitBtn;
    ButtonResultInputFile15: TBitBtn;
    Label23: TLabel;
    Label25: TLabel;
    ButtonIncludeInputFile15: TBitBtn;
    ButtonIncludeInputFile16: TBitBtn;
    ButtonIncludeInputFile17: TBitBtn;
    ButtonIncludeInputFile18: TBitBtn;
    ButtonIncludeInputFile19: TBitBtn;
    ButtonIncludeInputFile20: TBitBtn;
    ButtonIncludeInputFile21: TBitBtn;
    ButtonIncludeInputFile22: TBitBtn;
    ButtonIncludeInputFile23: TBitBtn;
    ButtonIncludeInputFile24: TBitBtn;
    ButtonIncludeInputFile25: TBitBtn;
    ButtonIncludeInputFile26: TBitBtn;
    ButtonIncludeInputFile27: TBitBtn;
    ButtonIncludeInputFile28: TBitBtn;
    buSelectDataFile28: TBitBtn;
    buSelectDataFile27: TBitBtn;
    buSelectDataFile26: TBitBtn;
    buSelectDataFile25: TBitBtn;
    buSelectDataFile24: TBitBtn;
    buSelectDataFile23: TBitBtn;
    buSelectDataFile22: TBitBtn;
    buSelectDataFile21: TBitBtn;
    buSelectDataFile20: TBitBtn;
    buSelectDataFile19: TBitBtn;
    buSelectDataFile18: TBitBtn;
    buSelectDataFile17: TBitBtn;
    buSelectDataFile16: TBitBtn;
    buSelectDataFile15: TBitBtn;
    LabelNameInputFile15: TLabel;
    LabelNameInputFile16: TLabel;
    LabelNameInputFile17: TLabel;
    LabelNameInputFile18: TLabel;
    LabelNameInputFile19: TLabel;
    LabelNameInputFile20: TLabel;
    LabelNameInputFile21: TLabel;
    LabelNameInputFile22: TLabel;
    LabelNameInputFile23: TLabel;
    LabelNameInputFile24: TLabel;
    LabelNameInputFile25: TLabel;
    LabelNameInputFile26: TLabel;
    LabelNameInputFile27: TLabel;
    LabelNameInputFile28: TLabel;
    Image2: TImage;
    Label9: TLabel;
    Label10: TLabel;
    Label11: TLabel;
    Label12: TLabel;
    Label14: TLabel;
    Label15: TLabel;
    Label18: TLabel;
    Unit1: TLabel;
    RES1: TLabel;
    Unit2: TLabel;
    Res2: TLabel;
    res3: TLabel;
    Unit3: TLabel;
    res4: TLabel;
    Unit4: TLabel;
    res7: TLabel;
    Unit7: TLabel;
    res8: TLabel;
    Unit8: TLabel;
    res9: TLabel;
    Unit9: TLabel;
    res10: TLabel;
    Unit10: TLabel;
    res11: TLabel;
    Unit11: TLabel;
    res12: TLabel;
    Unit12: TLabel;
    res13: TLabel;
    Unit13: TLabel;
    res14: TLabel;
    Unit14: TLabel;
    Label47: TLabel;
    Label48: TLabel;
    Unit6: TLabel;
    res6: TLabel;
    Unit5: TLabel;
    res5: TLabel;
    Unit28: TLabel;
    res28: TLabel;
    res27: TLabel;
    Unit27: TLabel;
    res26: TLabel;
    Unit26: TLabel;
    res25: TLabel;
    Unit25: TLabel;
    res24: TLabel;
    Unit24: TLabel;
    res23: TLabel;
    Unit23: TLabel;
    res22: TLabel;
    Unit22: TLabel;
    res21: TLabel;
    Unit21: TLabel;
    res20: TLabel;
    Unit20: TLabel;
    res19: TLabel;
    Unit19: TLabel;
    res18: TLabel;
    Unit18: TLabel;
    res17: TLabel;
    Unit17: TLabel;
    res16: TLabel;
    Unit16: TLabel;
    res15: TLabel;
    Unit15: TLabel;
    SettingsTab: TTabSheet;
    Label252: TLabel;
    LabelMonetaryUnit: TLabel;
    LabelCapacityUnit: TLabel;
    Label174: TLabel;
    LabelEnergyUnit: TLabel;
    Label988: TLabel;
    LabelWaterStorageUnit: TLabel;
    Label986: TLabel;
    LabelDesalinationUnit: TLabel;
    Label173: TLabel;
    Label13: TLabel;
    LabelMegaUnit: TLabel;
    Label16: TLabel;
    LabelEmissionUnit: TLabel;
    Label17: TLabel;
    LabelStorageUnit: TLabel;
    LabelRES1: TLabel;
    LabelRES2: TLabel;
    LabelRES3: TLabel;
    LabelRES4: TLabel;
    Label80: TLabel;
    ButtonMonetaryUnit: TButton;
    ButtonUnit: TButton;
    ButtonRES1: TButton;
    ButtonRES2: TButton;
    ButtonRES3: TButton;
    ButtonRES4: TButton;
    TestUnit: TButton;
    TestRES: TButton;
    TestUnitFail: TBitBtn;
    TestResFail: TBitBtn;
    Label19: TLabel;
    OpModeBu: TButton;
    Label20: TLabel;
    Label21: TLabel;
    Label22: TLabel;
    OpModeLabel: TLabel;
    Image3: TImage;
    Label26: TLabel;
    OpMode: TButton;
    Label27: TLabel;
    Label28: TLabel;
    TransTab: TTabSheet;
    Shape11: TShape;
    StringGrid1: TStringGrid;
    ImTrans: TButton;
    ExTrans: TButton;
    Label29: TLabel;
    Label30: TLabel;
    ImpExp: TButton;
    SaveDialog1: TSaveDialog;
    procedure buStartEnergyPlanClick(Sender: TObject);
    procedure edProjectFileDblClick(Sender: TObject);
    procedure buReadProjectfileClick(Sender: TObject);
    procedure buReadAndModifyClick(Sender: TObject);
    procedure buOnlineClick(Sender: TObject);
    procedure buDumpAsciiClick(Sender: TObject);
    procedure edModFileDblClick(Sender: TObject);
    procedure edAsciiDumpFileDblClick(Sender: TObject);
    procedure TextDblClick(Sender: TObject);
    procedure buSelectDataFile1Click(Sender: TObject);
    procedure buSelectEnergyPlan1Click(Sender: TObject);
    procedure buSelectEnergyPlan2Click(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure PreviewReportClick(Sender: TObject);
    procedure FindLinesTESTNEW(Lines: TStringList);
    procedure FindLinesTEST(Lines: TStringList);
    procedure ButtonIncludeInputFile1Click(Sender: TObject);
    procedure ButtonIncludeInputFile2Click(Sender: TObject);
    procedure ButtonIncludeInputFile3Click(Sender: TObject);
    procedure ButtonIncludeInputFile4Click(Sender: TObject);
    procedure ButtonIncludeInputFile5Click(Sender: TObject);
    procedure ButtonIncludeInputFile6Click(Sender: TObject);
    procedure buSelectDataFile2Click(Sender: TObject);
    procedure buSelectDataFile3Click(Sender: TObject);
    procedure buSelectDataFile4Click(Sender: TObject);
    procedure buSelectDataFile5Click(Sender: TObject);
    procedure ResetClick(Sender: TObject);
    procedure ChoseProgramClick(Sender: TObject);
    procedure Contents1Click(Sender: TObject);
    procedure About1Click(Sender: TObject);
    procedure PrinterClick(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure Button2Click(Sender: TObject);
    procedure Button3Click(Sender: TObject);
    procedure buSelectDataFile6Click(Sender: TObject);
    procedure ButtonIncludeInputFile7Click(Sender: TObject);
    procedure buSelectDataFile7Click(Sender: TObject);
    procedure ButtonIncludeInputFile8Click(Sender: TObject);
    procedure buSelectDataFile8Click(Sender: TObject);
    procedure ButtonIncludeInputFile9Clck(Sender: TObject);
    procedure buSelectDataFile9Click(Sender: TObject);
    procedure ButtonIncludeInputFile10Click(Sender: TObject);
    procedure ButtonIncludeInputFile11Click(Sender: TObject);
    procedure ButtonIncludeInputFile12Click(Sender: TObject);
    procedure ButtonIncludeInputFile13Click(Sender: TObject);
    procedure ButtonIncludeInputFile14Click(Sender: TObject);
    procedure buSelectDataFile10Click(Sender: TObject);
    procedure buSelectDataFile11Click(Sender: TObject);
    procedure buSelectDataFile12Click(Sender: TObject);
    procedure buSelectDataFile13Click(Sender: TObject);
    procedure buSelectDataFile14Click(Sender: TObject);
    procedure ButtonIncludeInputFile15Click(Sender: TObject);
    procedure ButtonIncludeInputFile16Click(Sender: TObject);
    procedure ButtonIncludeInputFile17Click(Sender: TObject);
    procedure ButtonIncludeInputFile18Click(Sender: TObject);
    procedure ButtonIncludeInputFile19Click(Sender: TObject);
    procedure ButtonIncludeInputFile20Click(Sender: TObject);
    procedure ButtonIncludeInputFile21Click(Sender: TObject);
    procedure ButtonIncludeInputFile22Click(Sender: TObject);
    procedure ButtonIncludeInputFile23Click(Sender: TObject);
    procedure ButtonIncludeInputFile24Click(Sender: TObject);
    procedure ButtonIncludeInputFile25Click(Sender: TObject);
    procedure ButtonIncludeInputFile26Click(Sender: TObject);
    procedure ButtonIncludeInputFile27Click(Sender: TObject);
    procedure ButtonIncludeInputFile28Click(Sender: TObject);
    procedure buSelectDataFile15Click(Sender: TObject);
    procedure buSelectDataFile16Click(Sender: TObject);
    procedure buSelectDataFile17Click(Sender: TObject);
    procedure buSelectDataFile18Click(Sender: TObject);
    procedure buSelectDataFile19Click(Sender: TObject);
    procedure buSelectDataFile20Click(Sender: TObject);
    procedure buSelectDataFile21Click(Sender: TObject);
    procedure buSelectDataFile22Click(Sender: TObject);
    procedure buSelectDataFile23Click(Sender: TObject);
    procedure buSelectDataFile24Click(Sender: TObject);
    procedure buSelectDataFile25Click(Sender: TObject);
    procedure buSelectDataFile26Click(Sender: TObject);
    procedure buSelectDataFile27Click(Sender: TObject);
    procedure buSelectDataFile28Click(Sender: TObject);
    procedure ButtonUnitClick(Sender: TObject);
    procedure ButtonMonetaryUnitClick(Sender: TObject);
    procedure ButtonRES1Click(Sender: TObject);
    procedure ButtonRES2Click(Sender: TObject);
    procedure ButtonRES3Click(Sender: TObject);
    procedure ButtonRES4Click(Sender: TObject);
  procedure TestUnitClick(Sender: TObject);
    procedure TestRESClick(Sender: TObject);
    procedure OpModeBuClick(Sender: TObject);
        procedure OpModeClick(Sender: TObject);



    procedure ShapeToMoveMouseMove(Sender: TObject; Shift: TShiftState; X,
      Y: Integer);
    procedure PageControl3Change(Sender: TObject);
    procedure ImpExpClick(Sender: TObject);




    //Procedure CompareDataSet(Data1: TestDataSet; var Result: Integer);




  private
    { Private declarations }
    Filnavn,
    NameInputFile1, NameInputFile2, NameInputFile3, NameInputFile4, NameInputFile5, NameInputFile6, NameInputFile7, NameInputFile8, NameInputFile9, NameInputFile10, NameInputFile11, NameInputFile12, NameInputFile13, NameInputFile14, NameInputFile15, NameInputFile16, NameInputFile17, NameInputFile18, NameInputFile19, NameInputFile20, NameInputFile21, NameInputFile22, NameInputFile23, NameInputFile24, NameInputFile25, NameInputFile26, NameInputFile27, NameInputFile28,
    NameExecuteFile1,  NameOutputFile1,
    NameExecuteFile2 : string;
    EnergyPlanExePath : String;


//    hourarray_dh_sum : Thourvalues;

    Procedure RunEnergyPlan(ACommandline,AEnergyPLANVersion: String);
  public

   { Public declarations }


    var

  end;

type
  TestDataSet = array [1 .. 8784] of double;
  MultiDataSet = array [1..250] of array [1 .. 8784] of double;
  //hourarray = array [1 .. 8784] of double;

var
  ExecuteToolMain: TExecuteToolMain;
  //Filnavn: string;
  DataSet11, DataSet12, DataSetSum, DataSet, DataFile1,DataFile2,DataFile3,DataFile4,DataFile5,DataFile6,DataFile7,DataFile8,DataFile9,DataFile10,DataFile11,DataFile12,DataFile13,DataFile14,DataFile15,DataFile16,DataFile17,DataFile18,DataFile19,DataFile20,DataFile21,DataFile22,DataFile23,DataFile24,DataFile25,DataFile26,DataFile27,DataFile28 : MultiDataSet;
  TestDataSet21, TestDataSet22, TestDataSet31, TestDataSet32, Bank0,Bank,
  TestDataSet41, TestDataSet42, TestDataSet51, TestDataSet52 : TestDataSet;
  //  NameInputFile1, NameExecuteFile1, NameExecuteFile2 : string;

  bic1,bic2,bic3,bic4,bic5,bic6,bic7,bic8,bic9,bic10,bic11,bic12,bic13,bic14,bic15,bic16,bic17,bic18,bic19,bic20,bic21,bic22,bic23,bic24,bic25,bic26,bic27,bic28 : integer;
  countinc : integer;
  TestEnergyUnit,TestCapacityUnit,TestMonetaryUNit,TestNameRES1,TestNameRES2,TestNameRES3,TestNameRES4 : String;

    DData, DDataNew, DurationData, DurationDataNew : THourvalues;

implementation

{$R *.dfm}
uses  ePLANMain, MainResultRep, PreviewResultFrm;


Function stringfunktion(value: double; decimal: integer): string;
var
  string1: string;
Begin
  case decimal of
    0:
      string1 := floattostr(round(value));
    1:
      string1 := formatfloat('0.0', value);
    2:
      string1 := formatfloat('0.00', value);
    3:
      string1 := formatfloat('0.000', value);
    4:
      string1 := formatfloat('0.0000', value);
    5:
      string1 := formatfloat('0.00000', value);
  end;
  case length(string1) of
    1:
      stringfunktion := '       ' + string1;
    2:
      stringfunktion := '      ' + string1;
    3:
      stringfunktion := '     ' + string1;
    4:
      stringfunktion := '    ' + string1;
    5:
      stringfunktion := '   ' + string1;
    6:
      stringfunktion := '  ' + string1;
    7:
      stringfunktion := ' ' + string1;
    8:
      stringfunktion := '' + string1;
    9:
      stringfunktion := '' + string1;
  end;
end;



procedure MoveControl(AControl: TControl; const X, Y: Integer);
var
  lPoint: TPoint;
begin
  lPoint := AControl.Parent.ScreenToClient(AControl.ClientToScreen(Point(X, Y)));
  AControl.Left := lPoint.X - AControl.Width div 2;
  AControl.Top := lPoint.Y - AControl.Height div 2;
end;




Procedure ClearDatasetSum;
Var x, y: integer;
Begin
  for y:=1 to 250 do
  begin
   for x:=1 to 8784 do DatasetSum[y,x]:=0;
  end;
End;


Procedure AddToDatasetSum;
Var x, y: integer;
Begin
  for y:=1 to 250 do
  begin
   for x:=1 to 8784 do DatasetSum[y,x]:=DatasetSum[y,x]+Dataset11[y,x];
  end;
End;
    {
Procedure ImportBank;
Var x,y:integer;
Begin
  for x := 1 to 8784 do Bank[2,x]:=Bank[2,x]+Bank0[2,x];

End;

Procedure ExportBank;
Var x,y:integer;
Begin

  for x := 1 to 8784 do Bank[1,x]:=Bank[1,x]+Bank0[1,x];
End;          }

Procedure AddToDataset;
Var x, y: integer;
Begin
  for y:=1 to 250 do
  begin
   for x:=1 to 8784 do DataSet[y,x]:=Dataset11[y,x];
  end;
End;


Procedure CompareDataSet(Data1, Data2: TestDataSet; var Result: Integer);
Var x: integer;
Begin
  result:=0;
  for x:=1 to 250 do
    begin
      if Data1[x]<>Data2[x]
      then result:=result+1;
    end;
End;



Procedure ReadDataSet(Afilnavn: string; var TestDataSet: MultiDataSet;
  AUnit : TStringList = nil; AComment: TStringList = nil);
var
  F: textfile;
  s: String;
  s1: string;
  p, x, y: integer;

  lPath : String;

begin
  // Succes := False;
  try
    try
      lPath := ExtractFilePath(Application.Exename);
      lpath := StringrePlace(lPath,'\energyPlan tools','',[rfIgnoreCase]);
      AssignFile(F, lPath +
        'energyPLAN Data\' + Afilnavn);
      Reset(F);
    except
      on EInOutError do
      begin
        showmessage('File not found: ' + lPath +
          'energyPLAN Data\' + Afilnavn);
        exit;
      end;
    end;
    y := 1;
    x := 1;
    Repeat
    begin
      Readln(F, s); { Read the first line out of the file }
      If s[1] <> '/' then
      begin
        if pos('.', s) <> 0 then
          s[pos('.', s)] := FormatSettings.DecimalSeparator;
        if pos(',', s) <> 0 then
          s[pos(',', s)] := FormatSettings.DecimalSeparator;
        TestDataSet[y,x] := strtofloat(s);
        x := x + 1;
      end
      else
      begin
        if AComment <> nil then
          if pos(AnsiLowerCase('Comment:'), AnsiLowerCase(s)) > 0 then
          begin
            s1 := s;
            p := pos(':', s1);
            delete(s1, 1, p);
            AComment.Append(s1);
          end;
        if pos(AnsiLowerCase('Unit:'), AnsiLowerCase(s)) > 0 then
        begin
          s1 := s;
          p := pos(':', s1);
          delete(s1, 1, p);
          AUnit.Append(s1);
        end;
      end;
      if x=8785 then
      begin
        x:=1;
        y:=y+1;
      end;
    end;
    until y = 250;
    // Succes := True;
  Finally
    try
      CloseFile(F);
    except
    end;
  end;
end;

procedure TExecuteToolMain.buStartEnergyPlanClick(Sender: TObject);
var
  lExecuteFile: string;
begin
  inherited;
  // identifying exefile based on senders.tag and list of exefiles
  RunEnergyPlan('','');
end;

procedure TExecuteToolMain.ChoseProgramClick(Sender: TObject);
begin
  inherited;
  If ChoseProgram.Caption='Scandinavia'
  then ChoseProgram.Caption:='EU28'
  else
  begin
    If ChoseProgram.Caption='EU28'
    then ChoseProgram.Caption:='Baltikum'
    else ChoseProgram.Caption:='Scandinavia'
  end;
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.Contents1Click(Sender: TObject);
var lfile :string;
begin
  lfile := ExtractFilePath(Application.Exename) + '\energyPlan Help\Documentation.pdf';
  if FileExists(lFile) then
    ShellExecute(Handle, nil, PChar(lFile), nil,  nil, SW_SHOWNORMAL)
  else
   showMessage('File documentation.pdf not found')
end;






procedure TExecuteToolMain.Button1Click(Sender: TObject);
var lfile, lpath : string;
    showresult : boolean;

begin
  LabelTestWarning.visible:=false;
  showresult:=true;
  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile1;
    if FileExists(lFile) then
    begin
      buSelectDataFile1.kind :=bkOK;
      buSelectDataFile1.Caption := 'OK !';
      bic1:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile1.kind :=bkAbort;
      buSelectDataFile1.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
  if ButtonIncludeInputFile2.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile2;
    if FileExists(lFile) then
    begin
      buSelectDataFile2.kind :=bkOK;
      buSelectDataFile2.Caption := 'OK !';
      bic2:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile2.kind :=bkAbort;
      buSelectDataFile2.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
  if ButtonIncludeInputFile3.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile3;
    if FileExists(lFile) then
    begin
      buSelectDataFile3.kind :=bkOK;
      buSelectDataFile3.Caption := 'OK !';
      bic3:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile3.kind :=bkAbort;
      buSelectDataFile3.Caption := 'Fail !';
      showresult:=false;
     end;
  end;
  if ButtonIncludeInputFile4.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile4;
    if FileExists(lFile) then
    begin
      buSelectDataFile4.kind :=bkOK;
      buSelectDataFile4.Caption := 'OK !';
    bic4:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile4.kind :=bkAbort;
      buSelectDataFile4.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
  if ButtonIncludeInputFile5.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile5;
    if FileExists(lFile) then
    begin
      buSelectDataFile5.kind :=bkOK;
      buSelectDataFile5.Caption := 'OK !';
    bic5:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile5.kind :=bkAbort;
      buSelectDataFile5.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
   if ButtonIncludeInputFile6.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile6;
    if FileExists(lFile) then
    begin
      buSelectDataFile6.kind :=bkOK;
      buSelectDataFile6.Caption := 'OK !';
    bic6:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile6.kind :=bkAbort;
      buSelectDataFile6.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
     if ButtonIncludeInputFile7.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile7;
    if FileExists(lFile) then
    begin
      buSelectDataFile7.kind :=bkOK;
      buSelectDataFile7.Caption := 'OK !';
    bic7:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile7.kind :=bkAbort;
      buSelectDataFile7.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
       if ButtonIncludeInputFile8.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile8;
    if FileExists(lFile) then
    begin
      buSelectDataFile8.kind :=bkOK;
      buSelectDataFile8.Caption := 'OK !';
    bic8:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile8.kind :=bkAbort;
      buSelectDataFile8.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
         if ButtonIncludeInputFile9.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile9;
    if FileExists(lFile) then
    begin
      buSelectDataFile9.kind :=bkOK;
      buSelectDataFile9.Caption := 'OK !';
    bic9:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile9.kind :=bkAbort;
      buSelectDataFile9.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
        if ButtonIncludeInputFile10.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile10;
    if FileExists(lFile) then
    begin
      buSelectDataFile10.kind :=bkOK;
      buSelectDataFile10.Caption := 'OK !';
    bic10:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile10.kind :=bkAbort;
      buSelectDataFile10.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
         if ButtonIncludeInputFile11.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile11;
    if FileExists(lFile) then
    begin
      buSelectDataFile11.kind :=bkOK;
      buSelectDataFile11.Caption := 'OK !';
    bic11:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile11.kind :=bkAbort;
      buSelectDataFile11.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
         if ButtonIncludeInputFile12.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile12;
    if FileExists(lFile) then
    begin
      buSelectDataFile12.kind :=bkOK;
      buSelectDataFile12.Caption := 'OK !';
    bic12:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile12.kind :=bkAbort;
      buSelectDataFile12.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
         if ButtonIncludeInputFile13.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile13;
    if FileExists(lFile) then
    begin
      buSelectDataFile13.kind :=bkOK;
      buSelectDataFile13.Caption := 'OK !';
    bic13:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile13.kind :=bkAbort;
      buSelectDataFile13.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
         if ButtonIncludeInputFile14.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile14;
    if FileExists(lFile) then
    begin
      buSelectDataFile14.kind :=bkOK;
      buSelectDataFile14.Caption := 'OK !';
    bic14:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile14.kind :=bkAbort;
      buSelectDataFile14.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
   if ButtonIncludeInputFile15.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile15;
    if FileExists(lFile) then
    begin
      buSelectDataFile15.kind :=bkOK;
      buSelectDataFile15.Caption := 'OK !';
    bic15:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile15.kind :=bkAbort;
      buSelectDataFile15.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
         if ButtonIncludeInputFile16.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile16;
    if FileExists(lFile) then
    begin
      buSelectDataFile16.kind :=bkOK;
      buSelectDataFile16.Caption := 'OK !';
    bic16:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile16.kind :=bkAbort;
      buSelectDataFile16.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
         if ButtonIncludeInputFile17.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile17;
    if FileExists(lFile) then
    begin
      buSelectDataFile17.kind :=bkOK;
      buSelectDataFile17.Caption := 'OK !';
    bic17:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile17.kind :=bkAbort;
      buSelectDataFile17.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
         if ButtonIncludeInputFile18.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile18;
    if FileExists(lFile) then
    begin
      buSelectDataFile18.kind :=bkOK;
      buSelectDataFile18.Caption := 'OK !';
    bic18:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile18.kind :=bkAbort;
      buSelectDataFile18.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
         if ButtonIncludeInputFile19.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile19;
    if FileExists(lFile) then
    begin
      buSelectDataFile19.kind :=bkOK;
      buSelectDataFile19.Caption := 'OK !';
    bic19:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile19.kind :=bkAbort;
      buSelectDataFile19.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
         if ButtonIncludeInputFile20.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile20;
    if FileExists(lFile) then
    begin
      buSelectDataFile20.kind :=bkOK;
      buSelectDataFile20.Caption := 'OK !';
    bic20:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile20.kind :=bkAbort;
      buSelectDataFile20.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
         if ButtonIncludeInputFile21.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile21;
    if FileExists(lFile) then
    begin
      buSelectDataFile21.kind :=bkOK;
      buSelectDataFile21.Caption := 'OK !';
    bic21:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile21.kind :=bkAbort;
      buSelectDataFile21.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
         if ButtonIncludeInputFile22.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile22;
    if FileExists(lFile) then
    begin
      buSelectDataFile22.kind :=bkOK;
      buSelectDataFile22.Caption := 'OK !';
    bic22:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile22.kind :=bkAbort;
      buSelectDataFile22.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
         if ButtonIncludeInputFile23.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile23;
    if FileExists(lFile) then
    begin
      buSelectDataFile23.kind :=bkOK;
      buSelectDataFile23.Caption := 'OK !';
    bic23:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile23.kind :=bkAbort;
      buSelectDataFile23.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
         if ButtonIncludeInputFile24.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile24;
    if FileExists(lFile) then
    begin
      buSelectDataFile24.kind :=bkOK;
      buSelectDataFile24.Caption := 'OK !';
    bic24:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile24.kind :=bkAbort;
      buSelectDataFile24.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
          if ButtonIncludeInputFile25.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile25;
    if FileExists(lFile) then
    begin
      buSelectDataFile25.kind :=bkOK;
      buSelectDataFile25.Caption := 'OK !';
    bic25:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile25.kind :=bkAbort;
      buSelectDataFile25.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
          if ButtonIncludeInputFile26.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile26;
    if FileExists(lFile) then
    begin
      buSelectDataFile26.kind :=bkOK;
      buSelectDataFile26.Caption := 'OK !';
    bic26:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile26.kind :=bkAbort;
      buSelectDataFile26.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
          if ButtonIncludeInputFile27.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile27;
    if FileExists(lFile) then
    begin
      buSelectDataFile27.kind :=bkOK;
      buSelectDataFile27.Caption := 'OK !';
    bic27:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile24.kind :=bkAbort;
      buSelectDataFile24.Caption := 'Fail !';
      showresult:=false;
    end;
  end;
          if ButtonIncludeInputFile28.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile28;
    if FileExists(lFile) then
    begin
      buSelectDataFile28.kind :=bkOK;
      buSelectDataFile28.Caption := 'OK !';
    bic28:=1;
    end else
    begin
      showmessage('File not found: ' + lfile);
      buSelectDataFile28.kind :=bkAbort;
      buSelectDataFile28.Caption := 'Fail !';
      showresult:=false;
    end;
  end;


  If showresult=true then
  begin
    buSelectDataFileSum.kind :=bkOK;
    buSelectDataFileSum.Caption := 'OK !';
  end else
  begin
    buSelectDataFileSum.kind :=bkAbort;
    buSelectDataFileSum.Caption := 'Fail !';
  end;
 countinc := ( bic1+bic2+bic3+bic4+bic5+bic6+bic7+bic8+bic9+bic10+bic11+bic12+bic13+bic14+bic15+bic16+bic17+bic18+bic19+bic20+bic21+bic22+bic23+bic24+bic25+bic26+bic27+bic28);
end;



Procedure NameCut(Name1, Name2: String; var NameResult: String);
var
 ch : char;
 teller, x, tellerslut : integer;
Begin
  teller:=length(Name1)+1;
  tellerslut:=length(Name2)-teller;
  NameResult:='';
  for x:=1 to tellerslut do
  begin
    teller:=teller+1;
    ch:=Name2[teller];
    NameResult:=NameResult+ch;
  end;
End;

Procedure NameCuttxt(Name1 : String; var NameResult: String);
var
 ch : char;
 teller, x, tellerslut : integer;
Begin
  teller:=length(Name1)+1;
  tellerslut:=teller-5;
  NameResult:='';
  for x:=1 to tellerslut do
  begin
    ch:=Name1[x];
    NameResult:=NameResult+ch;
  end;
End;


procedure TExecuteToolMain.Button2Click(Sender: TObject);
var TextOut : string;
begin
  inherited;
    NameCuttxt(NameInputFile1,TextOut);
    NameInputFile1:=TextOut + text.text + '.txt';
    LabelNameInputFile1.Caption:= NameInputFile1;
    buSelectDataFile1.kind :=bkHelp;
    buSelectDataFile1.Caption := 'Not testet';

    NameCuttxt(NameInputFile2,TextOut);
    NameInputFile2:=TextOut + text.text + '.txt';
    LabelNameInputFile2.Caption:= NameInputFile2;
    buSelectDataFile2.kind :=bkHelp;
    buSelectDataFile2.Caption := 'Not testet';

    NameCuttxt(NameInputFile3,TextOut);
    NameInputFile3:=TextOut + text.text + '.txt';
    LabelNameInputFile3.Caption:= NameInputFile3;
    buSelectDataFile3.kind :=bkHelp;
    buSelectDataFile3.Caption := 'Not testet';

    NameCuttxt(NameInputFile4,TextOut);
    NameInputFile4:=TextOut + text.text + '.txt';
    LabelNameInputFile4.Caption:= NameInputFile4;
    buSelectDataFile4.kind :=bkHelp;
    buSelectDataFile4.Caption := 'Not testet';

    NameCuttxt(NameInputFile5,TextOut);
    NameInputFile5:=TextOut + text.text + '.txt';
    LabelNameInputFile5.Caption:= NameInputFile5;
    buSelectDataFile5.kind :=bkHelp;
    buSelectDataFile5.Caption := 'Not testet';

        NameCuttxt(NameInputFile6,TextOut);
    NameInputFile6:=TextOut + text.text + '.txt';
    LabelNameInputFile6.Caption:= NameInputFile6;
    buSelectDataFile6.kind :=bkHelp;
    buSelectDataFile6.Caption := 'Not testet';

        NameCuttxt(NameInputFile7,TextOut);
    NameInputFile7:=TextOut + text.text + '.txt';
    LabelNameInputFile7.Caption:= NameInputFile7;
    buSelectDataFile7.kind :=bkHelp;
    buSelectDataFile7.Caption := 'Not testet';

            NameCuttxt(NameInputFile8,TextOut);
    NameInputFile8:=TextOut + text.text + '.txt';
    LabelNameInputFile8.Caption:= NameInputFile8;
    buSelectDataFile8.kind :=bkHelp;
    buSelectDataFile8.Caption := 'Not testet';

                NameCuttxt(NameInputFile9,TextOut);
    NameInputFile9:=TextOut + text.text + '.txt';
    LabelNameInputFile9.Caption:= NameInputFile9;
    buSelectDataFile9.kind :=bkHelp;
    buSelectDataFile9.Caption := 'Not testet';

                    NameCuttxt(NameInputFile10,TextOut);
    NameInputFile10:=TextOut + text.text + '.txt';
    LabelNameInputFile10.Caption:= NameInputFile10;
    buSelectDataFile10.kind :=bkHelp;
    buSelectDataFile10.Caption := 'Not testet';
                    NameCuttxt(NameInputFile11,TextOut);
    NameInputFile11:=TextOut + text.text + '.txt';
    LabelNameInputFile11.Caption:= NameInputFile11;
    buSelectDataFile11.kind :=bkHelp;
    buSelectDataFile11.Caption := 'Not testet';
                    NameCuttxt(NameInputFile12,TextOut);
    NameInputFile12:=TextOut + text.text + '.txt';
    LabelNameInputFile12.Caption:= NameInputFile12;
    buSelectDataFile12.kind :=bkHelp;
    buSelectDataFile12.Caption := 'Not testet';
                    NameCuttxt(NameInputFile13,TextOut);
    NameInputFile13:=TextOut + text.text + '.txt';
    LabelNameInputFile13.Caption:= NameInputFile13;
    buSelectDataFile13.kind :=bkHelp;
    buSelectDataFile13.Caption := 'Not testet';
                    NameCuttxt(NameInputFile14,TextOut);
    NameInputFile14:=TextOut + text.text + '.txt';
    LabelNameInputFile14.Caption:= NameInputFile14;
    buSelectDataFile14.kind :=bkHelp;
    buSelectDataFile14.Caption := 'Not testet';
                   NameCuttxt(NameInputFile15,TextOut);
    NameInputFile15:=TextOut + text.text + '.txt';
    LabelNameInputFile15.Caption:= NameInputFile15;
    buSelectDataFile15.kind :=bkHelp;
    buSelectDataFile15.Caption := 'Not testet';
                    NameCuttxt(NameInputFile16,TextOut);
    NameInputFile16:=TextOut + text.text + '.txt';
    LabelNameInputFile16.Caption:= NameInputFile16;
    buSelectDataFile16.kind :=bkHelp;
    buSelectDataFile16.Caption := 'Not testet';
                    NameCuttxt(NameInputFile17,TextOut);
    NameInputFile17:=TextOut + text.text + '.txt';
    LabelNameInputFile17.Caption:= NameInputFile17;
    buSelectDataFile17.kind :=bkHelp;
    buSelectDataFile17.Caption := 'Not testet';
                    NameCuttxt(NameInputFile18,TextOut);
    NameInputFile18:=TextOut + text.text + '.txt';
    LabelNameInputFile18.Caption:= NameInputFile18;
    buSelectDataFile18.kind :=bkHelp;
    buSelectDataFile18.Caption := 'Not testet';
                    NameCuttxt(NameInputFile19,TextOut);
    NameInputFile19:=TextOut + text.text + '.txt';
    LabelNameInputFile19.Caption:= NameInputFile19;
    buSelectDataFile19.kind :=bkHelp;
    buSelectDataFile19.Caption := 'Not testet';
                    NameCuttxt(NameInputFile20,TextOut);
    NameInputFile20:=TextOut + text.text + '.txt';
    LabelNameInputFile20.Caption:= NameInputFile20;
    buSelectDataFile20.kind :=bkHelp;
    buSelectDataFile20.Caption := 'Not testet';
                    NameCuttxt(NameInputFile21,TextOut);
    NameInputFile21:=TextOut + text.text + '.txt';
    LabelNameInputFile21.Caption:= NameInputFile21;
    buSelectDataFile21.kind :=bkHelp;
    buSelectDataFile21.Caption := 'Not testet';
                    NameCuttxt(NameInputFile22,TextOut);
    NameInputFile22:=TextOut + text.text + '.txt';
    LabelNameInputFile22.Caption:= NameInputFile22;
    buSelectDataFile22.kind :=bkHelp;
    buSelectDataFile22.Caption := 'Not testet';
                    NameCuttxt(NameInputFile23,TextOut);
    NameInputFile23:=TextOut + text.text + '.txt';
    LabelNameInputFile23.Caption:= NameInputFile23;
    buSelectDataFile23.kind :=bkHelp;
    buSelectDataFile23.Caption := 'Not testet';
                    NameCuttxt(NameInputFile24,TextOut);
    NameInputFile24:=TextOut + text.text + '.txt';
    LabelNameInputFile24.Caption:= NameInputFile24;
    buSelectDataFile24.kind :=bkHelp;
    buSelectDataFile24.Caption := 'Not testet';
                    NameCuttxt(NameInputFile25,TextOut);
    NameInputFile25:=TextOut + text.text + '.txt';
    LabelNameInputFile25.Caption:= NameInputFile25;
    buSelectDataFile25.kind :=bkHelp;
    buSelectDataFile25.Caption := 'Not testet';
                    NameCuttxt(NameInputFile26,TextOut);
    NameInputFile26:=TextOut + text.text + '.txt';
    LabelNameInputFile26.Caption:= NameInputFile26;
    buSelectDataFile26.kind :=bkHelp;
    buSelectDataFile26.Caption := 'Not testet';
                    NameCuttxt(NameInputFile27,TextOut);
    NameInputFile27:=TextOut + text.text + '.txt';
    LabelNameInputFile27.Caption:= NameInputFile27;
    buSelectDataFile27.kind :=bkHelp;
    buSelectDataFile27.Caption := 'Not testet';
                    NameCuttxt(NameInputFile28,TextOut);
    NameInputFile28:=TextOut + text.text + '.txt';
    LabelNameInputFile28.Caption:= NameInputFile28;
    buSelectDataFile28.kind :=bkHelp;
    buSelectDataFile28.Caption := 'Not testet';


    buSelectDataFileSum.kind :=bkHelp;
    buSelectDataFileSum.Caption := 'Not testet';
end;

procedure TExecuteToolMain.Button3Click(Sender: TObject);
begin
  inherited;
    NameInputFile1:=text.text + '\' + NameInputFile1;
    LabelNameInputFile1.Caption:= NameInputFile1;
    buSelectDataFile1.kind :=bkHelp;
    buSelectDataFile1.Caption := 'Not testet';

    NameInputFile2:=text.text + '\' + NameInputFile2;
    LabelNameInputFile2.Caption:= NameInputFile2;
    buSelectDataFile2.kind :=bkHelp;
    buSelectDataFile2.Caption := 'Not testet';

    NameInputFile3:=text.text + '\' + NameInputFile3;
    LabelNameInputFile3.Caption:= NameInputFile3;
    buSelectDataFile3.kind :=bkHelp;
    buSelectDataFile3.Caption := 'Not testet';

    NameInputFile4:=text.text + '\' + NameInputFile4;
    LabelNameInputFile4.Caption:= NameInputFile4;
    buSelectDataFile4.kind :=bkHelp;
    buSelectDataFile4.Caption := 'Not testet';

    NameInputFile5:=text.text + '\' + NameInputFile5;
    LabelNameInputFile5.Caption:= NameInputFile5;
    buSelectDataFile5.kind :=bkHelp;
    buSelectDataFile5.Caption := 'Not testet';

   NameInputFile6:=text.text + '\' + NameInputFile6;
    LabelNameInputFile6.Caption:= NameInputFile6;
    buSelectDataFile6.kind :=bkHelp;
    buSelectDataFile6.Caption := 'Not testet';

    NameInputFile7:=text.text + '\' + NameInputFile7;
    LabelNameInputFile7.Caption:= NameInputFile7;
    buSelectDataFile7.kind :=bkHelp;
    buSelectDataFile7.Caption := 'Not testet';

        NameInputFile8:=text.text + '\' + NameInputFile8;
    LabelNameInputFile8.Caption:= NameInputFile8;
    buSelectDataFile8.kind :=bkHelp;
    buSelectDataFile8.Caption := 'Not testet';

            NameInputFile9:=text.text + '\' + NameInputFile9;
    LabelNameInputFile9.Caption:= NameInputFile9;
    buSelectDataFile9.kind :=bkHelp;
    buSelectDataFile9.Caption := 'Not testet';

            NameInputFile10:=text.text + '\' + NameInputFile10;
    LabelNameInputFile10.Caption:= NameInputFile10;
    buSelectDataFile10.kind :=bkHelp;
    buSelectDataFile10.Caption := 'Not testet';
            NameInputFile11:=text.text + '\' + NameInputFile11;
    LabelNameInputFile11.Caption:= NameInputFile11;
    buSelectDataFile11.kind :=bkHelp;
    buSelectDataFile11.Caption := 'Not testet';
            NameInputFile12:=text.text + '\' + NameInputFile12;
    LabelNameInputFile12.Caption:= NameInputFile12;
    buSelectDataFile12.kind :=bkHelp;
    buSelectDataFile12.Caption := 'Not testet';
            NameInputFile13:=text.text + '\' + NameInputFile13;
    LabelNameInputFile13.Caption:= NameInputFile13;
    buSelectDataFile13.kind :=bkHelp;
    buSelectDataFile13.Caption := 'Not testet';
            NameInputFile14:=text.text + '\' + NameInputFile14;
    LabelNameInputFile14.Caption:= NameInputFile14;
    buSelectDataFile14.kind :=bkHelp;
    buSelectDataFile14.Caption := 'Not testet';
            NameInputFile15:=text.text + '\' + NameInputFile15;
    LabelNameInputFile15.Caption:= NameInputFile15;
    buSelectDataFile15.kind :=bkHelp;
    buSelectDataFile15.Caption := 'Not testet';
            NameInputFile16:=text.text + '\' + NameInputFile16;
    LabelNameInputFile16.Caption:= NameInputFile16;
    buSelectDataFile16.kind :=bkHelp;
    buSelectDataFile16.Caption := 'Not testet';
            NameInputFile17:=text.text + '\' + NameInputFile17;
    LabelNameInputFile17.Caption:= NameInputFile17;
    buSelectDataFile17.kind :=bkHelp;
    buSelectDataFile17.Caption := 'Not testet';
            NameInputFile18:=text.text + '\' + NameInputFile18;
    LabelNameInputFile18.Caption:= NameInputFile18;
    buSelectDataFile18.kind :=bkHelp;
    buSelectDataFile18.Caption := 'Not testet';
            NameInputFile19:=text.text + '\' + NameInputFile19;
    LabelNameInputFile19.Caption:= NameInputFile19;
    buSelectDataFile19.kind :=bkHelp;
    buSelectDataFile19.Caption := 'Not testet';
            NameInputFile20:=text.text + '\' + NameInputFile20;
    LabelNameInputFile20.Caption:= NameInputFile20;
    buSelectDataFile20.kind :=bkHelp;
    buSelectDataFile20.Caption := 'Not testet';
            NameInputFile21:=text.text + '\' + NameInputFile21;
    LabelNameInputFile21.Caption:= NameInputFile21;
    buSelectDataFile21.kind :=bkHelp;
    buSelectDataFile21.Caption := 'Not testet';
            NameInputFile22:=text.text + '\' + NameInputFile22;
    LabelNameInputFile22.Caption:= NameInputFile22;
    buSelectDataFile22.kind :=bkHelp;
    buSelectDataFile22.Caption := 'Not testet';
            NameInputFile23:=text.text + '\' + NameInputFile23;
    LabelNameInputFile23.Caption:= NameInputFile23;
    buSelectDataFile23.kind :=bkHelp;
    buSelectDataFile23.Caption := 'Not testet';
            NameInputFile24:=text.text + '\' + NameInputFile24;
    LabelNameInputFile24.Caption:= NameInputFile24;
    buSelectDataFile24.kind :=bkHelp;
    buSelectDataFile24.Caption := 'Not testet';
            NameInputFile25:=text.text + '\' + NameInputFile25;
    LabelNameInputFile25.Caption:= NameInputFile25;
    buSelectDataFile25.kind :=bkHelp;
    buSelectDataFile25.Caption := 'Not testet';
            NameInputFile26:=text.text + '\' + NameInputFile26;
    LabelNameInputFile26.Caption:= NameInputFile26;
    buSelectDataFile26.kind :=bkHelp;
    buSelectDataFile26.Caption := 'Not testet';
            NameInputFile27:=text.text + '\' + NameInputFile27;
    LabelNameInputFile27.Caption:= NameInputFile27;
    buSelectDataFile27.kind :=bkHelp;
    buSelectDataFile27.Caption := 'Not testet';
            NameInputFile28:=text.text + '\' + NameInputFile28;
    LabelNameInputFile28.Caption:= NameInputFile28;
    buSelectDataFile28.kind :=bkHelp;
    buSelectDataFile28.Caption := 'Not testet';


    buSelectDataFileSum.kind :=bkHelp;
    buSelectDataFileSum.Caption := 'Not testet';
end;



procedure TExecuteToolMain.OpModeClick(Sender: TObject);

begin
  inherited;
  If OpMode.Caption='Copper Plate'
  then OpMode.Caption:='Island'
  else
  begin
    If OpMode.Caption='Island'
    then OpMode.Caption:='Transmission'
    else OpMode.Caption:='Copper Plate'
  end;
  if OpMode.Caption='Transmission' then
  begin
    label27.Visible:=true      ;
    label27.Caption:='Define transmission capacities in Transmission Tab'
   end
   else label27.Visible:=false;
end;


procedure TExecuteToolMain.OpModeBuClick(Sender: TObject);
begin
  inherited;
inherited    ;
  If OpModeLabel.Caption = 'Click button to select operation mode' then
  begin
    OpModeLabel.Caption := 'Summarise results' ;
end
else If OpModeLabel.Caption  = 'Summarise results' then
Begin
      OpModeLabel.Caption  := 'Recalculate using defined transmission'         ;
end
else if OpModeLabel.Caption  = 'Recalculate using defined transmission' then
begin
        OpModeLabel.Caption  := 'Summarise results'   ;

end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile1Click(Sender: TObject);
begin
  inherited;
  If ButtonIncludeInputFile1.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile1.kind := bkOK;
     ButtonIncludeInputFile1.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'       ;

    StringGrid1.Cells[1, 0] := NameInputFile1;
    StringGrid1.Cells[0, 1] := NameInputFile1;
    end else
  begin
     ButtonIncludeInputFile1.kind := bkAbort;
     ButtonIncludeInputFile1.Caption:='Not Actice';

        StringGrid1.Cells[1, 0] := '';


  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile2Click(Sender: TObject);
begin
  inherited;
  If ButtonIncludeInputFile2.Caption='Not Actice'then
  begin
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet';
     ButtonIncludeInputFile2.kind := bkOK;
     ButtonIncludeInputFile2.Caption:='Actice'
  end else
  begin
     ButtonIncludeInputFile2.kind := bkAbort;
     ButtonIncludeInputFile2.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile3Click(Sender: TObject);
begin
  inherited;
  If ButtonIncludeInputFile3.Caption='Not Actice'then
  begin
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet';
     ButtonIncludeInputFile3.kind := bkOK;
     ButtonIncludeInputFile3.Caption:='Actice'
  end else
  begin
     ButtonIncludeInputFile3.kind := bkAbort;
     ButtonIncludeInputFile3.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile4Click(Sender: TObject);
begin
  inherited;
  If ButtonIncludeInputFile4.Caption='Not Actice'then
  begin
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet';
     ButtonIncludeInputFile4.kind := bkOK;
     ButtonIncludeInputFile4.Caption:='Actice'
  end else
  begin
     ButtonIncludeInputFile4.kind := bkAbort;
     ButtonIncludeInputFile4.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile5Click(Sender: TObject);
begin
  inherited;
  If ButtonIncludeInputFile5.Caption='Not Actice'then
  begin
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet';
     ButtonIncludeInputFile5.kind := bkOK;
     ButtonIncludeInputFile5.Caption:='Actice'
  end else
  begin
     ButtonIncludeInputFile5.kind := bkAbort;
     ButtonIncludeInputFile5.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile6Click(Sender: TObject);
begin
  inherited;
  If ButtonIncludeInputFile6.Caption='Not Actice'then
  begin
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet';
     ButtonIncludeInputFile6.kind := bkOK;
     ButtonIncludeInputFile6.Caption:='Actice'
  end else
  begin
     ButtonIncludeInputFile6.kind := bkAbort;
     ButtonIncludeInputFile6.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile7Click(Sender: TObject);
begin
  inherited;
  If ButtonIncludeInputFile7.Caption='Not Actice'then
  begin
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet';
     ButtonIncludeInputFile7.kind := bkOK;
     ButtonIncludeInputFile7.Caption:='Actice'
  end else
  begin
     ButtonIncludeInputFile7.kind := bkAbort;
     ButtonIncludeInputFile7.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile8Click(Sender: TObject);
begin
  inherited;
   If ButtonIncludeInputFile8.Caption='Not Actice'then
  begin
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet';
     ButtonIncludeInputFile8.kind := bkOK;
     ButtonIncludeInputFile8.Caption:='Actice'
  end else
  begin
     ButtonIncludeInputFile8.kind := bkAbort;
     ButtonIncludeInputFile8.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile9Clck(Sender: TObject);
begin
  inherited;
   If ButtonIncludeInputFile9.Caption='Not Actice'then
  begin
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet';
     ButtonIncludeInputFile9.kind := bkOK;
     ButtonIncludeInputFile9.Caption:='Actice'
  end else
  begin
     ButtonIncludeInputFile9.kind := bkAbort;
     ButtonIncludeInputFile9.Caption:='Not Actice';
  end;
end;




procedure TExecuteToolMain.ButtonMonetaryUnitClick(Sender: TObject);
begin
  TestUnitFail.kind :=bkHelp;
  TestUnitFail.Caption := 'Not testet';
Unit1.Visible:=False;
Unit2.Visible:=False;
Unit3.Visible:=False;
Unit4.Visible:=False;
Unit5.Visible:=False;
Unit6.Visible:=False;
Unit7.Visible:=False;
Unit8.Visible:=False;
Unit9.Visible:=False;
Unit10.Visible:=False;
Unit11.Visible:=False;
Unit12.Visible:=False;
Unit13.Visible:=False;
Unit14.Visible:=False;
Unit15.Visible:=False;
Unit16.Visible:=False;
Unit17.Visible:=False;
Unit18.Visible:=False;
Unit19.Visible:=False;
Unit20.Visible:=False;
Unit21.Visible:=False;
Unit22.Visible:=False;
Unit23.Visible:=False;
Unit24.Visible:=False;
Unit25.Visible:=False;
Unit26.Visible:=False;
Unit27.Visible:=False;
Unit28.Visible:=False;
  inherited;
If LabelMonetaryUnit.Caption = 'DKK' then
begin
    LabelMonetaryUnit.Caption := 'EUR';
    MonetaryUnit:='EUR';
  end
else If LabelMonetaryUnit.Caption = 'EUR' then
begin
      LabelMonetaryUnit.Caption := 'USD'  ;
      MonetaryUnit:='USD';
end
else If LabelMonetaryUnit.Caption = 'USD' then
Begin
        LabelMonetaryUnit.Caption := 'NIO'  ;
        MonetaryUnit:='NIO'
end
else If LabelMonetaryUnit.Caption = 'NIO' then
begin
       LabelMonetaryUnit.Caption := 'YEN';
       MonetaryUnit:='YEN';
end
else  If LabelMonetaryUnit.Caption = 'YEN' then
begin
LabelMonetaryUnit.Caption := 'HRK';
MonetaryUnit:='HRK';
end
else
begin
              LabelMonetaryUnit.Caption := 'DKK';
              MonetaryUnit:='DKK';
          end;
end;


procedure TExecuteToolMain.ButtonRES1Click(Sender: TObject);
begin
  TestRESFail.kind :=bkHelp;
  TestRESFail.Caption := 'Not testet';
res1.Visible:=False;
res2.Visible:=False;
res3.Visible:=False;
res4.Visible:=False;
res5.Visible:=False;
res6.Visible:=False;
res7.Visible:=False;
res8.Visible:=False;
res9.Visible:=False;
res10.Visible:=False;
res11.Visible:=False;
res12.Visible:=False;
res13.Visible:=False;
res14.Visible:=False;
res15.Visible:=False;
res16.Visible:=False;
res17.Visible:=False;
res18.Visible:=False;
res19.Visible:=False;
res20.Visible:=False;
res21.Visible:=False;
res22.Visible:=False;
res23.Visible:=False;
res24.Visible:=False;
res25.Visible:=False;
res26.Visible:=False;
res27.Visible:=False;
res28.Visible:=False;
inherited    ;
  If LabelRES1.Caption = 'Wind' then
  begin
    LabelRES1.Caption := 'Offshore Wind' ;
    NameRES1:='Offshore Wind';
end
else If LabelRES1.Caption = 'Offshore Wind' then
Begin
      LabelRES1.Caption := 'Photo Voltaic'         ;
      NameRES1:='Photo Voltaic';
end
else if LabelRES1.Caption = 'Photo Voltaic' then
begin
        LabelRES1.Caption := 'Wave Power'   ;
        NameRes1:='Wave Power';
End
else if LabelRES1.Caption = 'Wave Power' then
begin
          LabelRES1.Caption := 'River Hydro';
          NameRES1:='River Hydro';
end
else if LabelRES1.Caption = 'River Hydro' then
begin
        LabelRES1.Caption := 'Tidal' ;
        NameRES1:='Tidal';
end
else if LabelRES1.Caption = 'Tidal' then
Begin
     LabelRES1.Caption := 'CSP Solar Power' ;
     NameRES1:='CSP Solar Power';
End
else
begin
              LabelRES1.Caption := 'Wind';
              NameRES1:='Wind';


end;
end;



procedure TExecuteToolMain.ButtonRES2Click(Sender: TObject);
begin
  TestRESFail.kind :=bkHelp;
  TestRESFail.Caption := 'Not testet';
res1.Visible:=False;
res2.Visible:=False;
res3.Visible:=False;
res4.Visible:=False;
res5.Visible:=False;
res6.Visible:=False;
res7.Visible:=False;
res8.Visible:=False;
res9.Visible:=False;
res10.Visible:=False;
res11.Visible:=False;
res12.Visible:=False;
res13.Visible:=False;
res14.Visible:=False;
res15.Visible:=False;
res16.Visible:=False;
res17.Visible:=False;
res18.Visible:=False;
res19.Visible:=False;
res20.Visible:=False;
res21.Visible:=False;
res22.Visible:=False;
res23.Visible:=False;
res24.Visible:=False;
res25.Visible:=False;
res26.Visible:=False;
res27.Visible:=False;
res28.Visible:=False;
 inherited    ;
  If LabelRES2.Caption = 'Wind' then
  begin
    LabelRES2.Caption := 'Offshore Wind' ;
    NameRES2:='Offshore Wind';
end
else If LabelRES2.Caption = 'Offshore Wind' then
Begin
      LabelRES2.Caption := 'Photo Voltaic'         ;
      NameRES2:='Photo Voltaic';
end
else if LabelRES2.Caption = 'Photo Voltaic' then
begin
        LabelRES2.Caption := 'Wave Power'   ;
        NameRes2:='Wave Power';
End
else if LabelRES2.Caption = 'Wave Power' then
begin
          LabelRES2.Caption := 'River Hydro';
          NameRES2:='River Hydro';
end
else if LabelRES2.Caption = 'River Hydro' then
begin
        LabelRES2.Caption := 'Tidal' ;
        NameRES2:='Tidal';
end
else if LabelRES2.Caption = 'Tidal' then
Begin
     LabelRES2.Caption := 'CSP Solar Power' ;
     NameRES2:='CSP Solar Power';
End
else
begin
              LabelRES2.Caption := 'Wind';
              NameRES2:='Wind';
end;
end;

procedure TExecuteToolMain.ButtonRES3Click(Sender: TObject);
begin
  TestRESFail.kind :=bkHelp;
  TestRESFail.Caption := 'Not testet';
res1.Visible:=False;
res2.Visible:=False;
res3.Visible:=False;
res4.Visible:=False;
res5.Visible:=False;
res6.Visible:=False;
res7.Visible:=False;
res8.Visible:=False;
res9.Visible:=False;
res10.Visible:=False;
res11.Visible:=False;
res12.Visible:=False;
res13.Visible:=False;
res14.Visible:=False;
res15.Visible:=False;
res16.Visible:=False;
res17.Visible:=False;
res18.Visible:=False;
res19.Visible:=False;
res20.Visible:=False;
res21.Visible:=False;
res22.Visible:=False;
res23.Visible:=False;
res24.Visible:=False;
res25.Visible:=False;
res26.Visible:=False;
res27.Visible:=False;
res28.Visible:=False;
 inherited    ;
  If LabelRES3.Caption = 'Wind' then
  begin
    LabelRES3.Caption := 'Offshore Wind' ;
    NameRES3:='Offshore Wind';
end
else If LabelRES3.Caption = 'Offshore Wind' then
Begin
      LabelRES3.Caption := 'Photo Voltaic'         ;
      NameRES3:='Photo Voltaic';
end
else if LabelRES3.Caption = 'Photo Voltaic' then
begin
        LabelRES3.Caption := 'Wave Power'   ;
        NameRes3:='Wave Power';
End
else if LabelRES3.Caption = 'Wave Power' then
begin
          LabelRES3.Caption := 'River Hydro';
          NameRES3:='River Hydro';
end
else if LabelRES3.Caption = 'River Hydro' then
begin
        LabelRES3.Caption := 'Tidal' ;
        NameRES3:='Tidal';
end
else if LabelRES3.Caption = 'Tidal' then
Begin
     LabelRES3.Caption := 'CSP Solar Power' ;
     NameRES3:='CSP Solar Power';
End
else
begin
              LabelRES3.Caption := 'Wind';
              NameRES3:='Wind';
end;
end;

procedure TExecuteToolMain.ButtonRES4Click(Sender: TObject);
begin
  TestRESFail.kind :=bkHelp;
  TestRESFail.Caption := 'Not testet';
res1.Visible:=False;
res2.Visible:=False;
res3.Visible:=False;
res4.Visible:=False;
res5.Visible:=False;
res6.Visible:=False;
res7.Visible:=False;
res8.Visible:=False;
res9.Visible:=False;
res10.Visible:=False;
res11.Visible:=False;
res12.Visible:=False;
res13.Visible:=False;
res14.Visible:=False;
res15.Visible:=False;
res16.Visible:=False;
res17.Visible:=False;
res18.Visible:=False;
res19.Visible:=False;
res20.Visible:=False;
res21.Visible:=False;
res22.Visible:=False;
res23.Visible:=False;
res24.Visible:=False;
res25.Visible:=False;
res26.Visible:=False;
res27.Visible:=False;
res28.Visible:=False;
inherited    ;
  If LabelRES4.Caption = 'Wind' then
  begin
    LabelRES4.Caption := 'Offshore Wind' ;
    NameRES4:='Offshore Wind';
end
else If LabelRES4.Caption = 'Offshore Wind' then
Begin
      LabelRES4.Caption := 'Photo Voltaic'         ;
      NameRES4:='Photo Voltaic';
end
else if LabelRES4.Caption = 'Photo Voltaic' then
begin
        LabelRES4.Caption := 'Wave Power'   ;
        NameRes4:='Wave Power';
End
else if LabelRES4.Caption = 'Wave Power' then
begin
          LabelRES4.Caption := 'River Hydro';
          NameRES4:='River Hydro';
end
else if LabelRES4.Caption = 'River Hydro' then
begin
        LabelRES4.Caption := 'Tidal' ;
        NameRES4:='Tidal';
end
else if LabelRES4.Caption = 'Tidal' then
Begin
     LabelRES4.Caption := 'CSP Solar Power' ;
     NameRES4:='CSP Solar Power';
End
else
begin
              LabelRES4.Caption := 'Wind';
              NameRES4:='Wind';
end;
end;

procedure TExecuteToolMain.ButtonUnitClick(Sender: TObject);
begin
  TestUnitFail.kind :=bkHelp;
  TestUnitFail.Caption := 'Not testet';
Unit1.Visible:=False;
Unit2.Visible:=False;
Unit3.Visible:=False;
Unit4.Visible:=False;
Unit5.Visible:=False;
Unit6.Visible:=False;
Unit7.Visible:=False;
Unit8.Visible:=False;
Unit9.Visible:=False;
Unit10.Visible:=False;
Unit11.Visible:=False;
Unit12.Visible:=False;
Unit13.Visible:=False;
Unit14.Visible:=False;
Unit15.Visible:=False;
Unit16.Visible:=False;
Unit17.Visible:=False;
Unit18.Visible:=False;
Unit19.Visible:=False;
Unit20.Visible:=False;
Unit21.Visible:=False;
Unit22.Visible:=False;
Unit23.Visible:=False;
Unit24.Visible:=False;
Unit25.Visible:=False;
Unit26.Visible:=False;
Unit27.Visible:=False;
Unit28.Visible:=False;

  inherited;
 if LabelCapacityUnit.Caption = 'GW' then
 begin
    LabelMegaUnit.Caption := 'k';
    LabelCapacityUnit.Caption := 'kW';
    LabelEmissionUnit.Caption := 'kt';
    LabelEnergyUnit.Caption := 'GWh/year';
    LabelStorageUnit.Caption := 'MWh';
    LabelDesalinationUnit.Caption := 'm3 fresh water/hour';
    LabelWaterStorageUnit.Caption := '1000 m3';
    CapacityUnit:='kW';
    EmissionUnit := 'kt';
    MegaUnit := 'k';
    EnergyUnit := 'GWh/year';
    StorageUnit := 'MWh';
    DesalinationUnit := 'm3 fresh water/hour';
    WaterStorageUnit := '1000 m3';
 end
 else if LabelCapacityUnit.Caption = 'MW' then
 begin
    LabelMegaUnit.Caption := 'G';
    LabelCapacityUnit.Caption := 'GW';
    LabelEmissionUnit.Caption := 'Gt';
   LabelEnergyUnit.Caption := 'PWh/year';
    LabelStorageUnit.Caption := 'TWh';
    LabelDesalinationUnit.Caption := 'Mm3 fresh water/hour';
    LabelWaterStorageUnit.Caption := 'Gm3';
    CapacityUnit:='GW';
    EmissionUnit := 'Gt';
    MegaUnit := 'G';
    EnergyUnit := 'PWh/year';
    StorageUnit := 'TWh';
    DesalinationUnit := 'Mm3 fresh water/hour';
    WaterStorageUnit := 'Gm3';
 end
 else
 begin
    LabelMegaUnit.Caption := 'M';
    LabelCapacityUnit.Caption := 'MW';
    LabelEmissionUnit.Caption := 'Mt';
    LabelEnergyUnit.Caption := 'TWh/year';
    LabelStorageUnit.Caption := 'GWh';
    LabelDesalinationUnit.Caption := '1000 m3 fresh water/hour';
    LabelWaterStorageUnit.Caption := 'Mm3';
    CapacityUnit:='MW';
    EmissionUnit := 'Mt';
    MegaUnit := 'M';
    EnergyUnit := 'TWh/year';
    StorageUnit := 'GWh';
    DesalinationUnit := '1000 m3 fresh water/hour';
    WaterStorageUnit := 'Mm3';
 end;
 StringGrid1.Cells[0,0] := CapacityUnit;
end;



procedure TExecuteToolMain.ButtonIncludeInputFile10Click(Sender: TObject);
begin
  inherited;
     If ButtonIncludeInputFile10.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile10.kind := bkOK;
     ButtonIncludeInputFile10.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile10.kind := bkAbort;
     ButtonIncludeInputFile10.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile11Click(Sender: TObject);
begin
  inherited;
       If ButtonIncludeInputFile11.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile11.kind := bkOK;
     ButtonIncludeInputFile11.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile11.kind := bkAbort;
     ButtonIncludeInputFile11.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile12Click(Sender: TObject);
begin
  inherited;
     If ButtonIncludeInputFile12.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile12.kind := bkOK;
     ButtonIncludeInputFile12.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile12.kind := bkAbort;
     ButtonIncludeInputFile12.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile13Click(Sender: TObject);
begin
  inherited;
     If ButtonIncludeInputFile13.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile13.kind := bkOK;
     ButtonIncludeInputFile13.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile13.kind := bkAbort;
     ButtonIncludeInputFile13.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile14Click(Sender: TObject);
begin
  inherited;
      If ButtonIncludeInputFile14.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile14.kind := bkOK;
     ButtonIncludeInputFile14.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile14.kind := bkAbort;
     ButtonIncludeInputFile14.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile15Click(Sender: TObject);
begin
  inherited;
       If ButtonIncludeInputFile15.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile15.kind := bkOK;
     ButtonIncludeInputFile15.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile15.kind := bkAbort;
     ButtonIncludeInputFile15.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile16Click(Sender: TObject);
begin
  inherited;
      If ButtonIncludeInputFile16.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile16.kind := bkOK;
     ButtonIncludeInputFile16.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile16.kind := bkAbort;
     ButtonIncludeInputFile16.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile17Click(Sender: TObject);
begin
  inherited;
      If ButtonIncludeInputFile17.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile17.kind := bkOK;
     ButtonIncludeInputFile17.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile17.kind := bkAbort;
     ButtonIncludeInputFile17.Caption:='Not Actice';
  end;
end;


procedure TExecuteToolMain.ButtonIncludeInputFile18Click(Sender: TObject);
begin
  inherited;
      If ButtonIncludeInputFile18.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile18.kind := bkOK;
     ButtonIncludeInputFile18.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile18.kind := bkAbort;
     ButtonIncludeInputFile18.Caption:='Not Actice';
  end;
end;



procedure TExecuteToolMain.ButtonIncludeInputFile19Click(Sender: TObject);
begin
  inherited;
      If ButtonIncludeInputFile19.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile19.kind := bkOK;
     ButtonIncludeInputFile19.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile19.kind := bkAbort;
     ButtonIncludeInputFile19.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile20Click(Sender: TObject);
begin
  inherited;
  If ButtonIncludeInputFile20.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile20.kind := bkOK;
     ButtonIncludeInputFile20.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile20.kind := bkAbort;
     ButtonIncludeInputFile20.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile21Click(Sender: TObject);
begin
  inherited;
If ButtonIncludeInputFile21.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile21.kind := bkOK;
     ButtonIncludeInputFile21.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile21.kind := bkAbort;
     ButtonIncludeInputFile21.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile22Click(Sender: TObject);
begin
  inherited;
If ButtonIncludeInputFile22.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile22.kind := bkOK;
     ButtonIncludeInputFile22.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile22.kind := bkAbort;
     ButtonIncludeInputFile22.Caption:='Not Actice';
  end;
end;



procedure TExecuteToolMain.ButtonIncludeInputFile23Click(Sender: TObject);
begin
  inherited;
If ButtonIncludeInputFile23.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile23.kind := bkOK;
     ButtonIncludeInputFile23.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile23.kind := bkAbort;
     ButtonIncludeInputFile23.Caption:='Not Actice';
  end;
end;



procedure TExecuteToolMain.ButtonIncludeInputFile24Click(Sender: TObject);
begin
  inherited;
If ButtonIncludeInputFile24.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile24.kind := bkOK;
     ButtonIncludeInputFile24.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile24.kind := bkAbort;
     ButtonIncludeInputFile24.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile25Click(Sender: TObject);
begin
  inherited;
If ButtonIncludeInputFile25.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile25.kind := bkOK;
     ButtonIncludeInputFile25.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile25.kind := bkAbort;
     ButtonIncludeInputFile25.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile26Click(Sender: TObject);
begin
  inherited;
If ButtonIncludeInputFile26.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile26.kind := bkOK;
     ButtonIncludeInputFile26.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile26.kind := bkAbort;
     ButtonIncludeInputFile26.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ButtonIncludeInputFile27Click(Sender: TObject);
begin
  inherited;
If ButtonIncludeInputFile27.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile27.kind := bkOK;
     ButtonIncludeInputFile27.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile27.kind := bkAbort;
     ButtonIncludeInputFile27.Caption:='Not Actice';
  end;
end;



procedure TExecuteToolMain.ButtonIncludeInputFile28Click(Sender: TObject);
begin
  inherited;
If ButtonIncludeInputFile28.Caption='Not Actice'then
  begin
     ButtonIncludeInputFile28.kind := bkOK;
     ButtonIncludeInputFile28.Caption:='Actice';
     buSelectDataFileSum.kind :=bkHelp;
     buSelectDataFileSum.Caption := 'Not testet'
   end else
  begin
     ButtonIncludeInputFile28.kind := bkAbort;
     ButtonIncludeInputFile28.Caption:='Not Actice';
  end;
end;

procedure TExecuteToolMain.ResetClick(Sender: TObject);
begin
  inherited;
  If ChoseProgram.Caption='Scandinavia' then
  begin
    NameInputFile1:='Denmark.txt';
    LabelNameInputFile1.Caption:= NameInputFile1;
    buSelectDataFile1.kind :=bkHelp;
    buSelectDataFile1.Caption := 'Not testet';
    ButtonIncludeInputFile1.kind := bkOK;
    ButtonIncludeInputFile1.Caption:='Actice';
    NameInputFile2:='Finland.txt';
    LabelNameInputFile2.Caption:= NameInputFile2;
    buSelectDataFile2.kind :=bkHelp;
    buSelectDataFile2.Caption := 'Not testet';
    ButtonIncludeInputFile2.kind := bkOK;
    ButtonIncludeInputFile2.Caption:='Actice';
    NameInputFile3:='Norway.txt';
    LabelNameInputFile3.Caption:= NameInputFile3;
    buSelectDataFile3.kind :=bkHelp;
    buSelectDataFile3.Caption := 'Not testet';
    ButtonIncludeInputFile3.kind := bkOK;
    ButtonIncludeInputFile3.Caption:='Actice';
    NameInputFile4:='Sweden.txt';
    LabelNameInputFile4.Caption:= NameInputFile4;
    buSelectDataFile4.kind :=bkHelp;
    buSelectDataFile4.Caption := 'Not testet';
    ButtonIncludeInputFile4.kind := bkOK;
    ButtonIncludeInputFile4.Caption:='Actice';
    buSelectDataFile5.kind := bkAbort;
    buSelectDataFile5.Caption := 'Select';
    ButtonIncludeInputFile5.kind := bkAbort;
    ButtonIncludeInputFile5.Caption:='Not Actice';
        buSelectDataFile6.kind := bkAbort;
    buSelectDataFile6.Caption := 'Select';
    ButtonIncludeInputFile6.kind := bkAbort;
    ButtonIncludeInputFile6.Caption:='Not Actice';
        buSelectDataFile7.kind := bkAbort;
    buSelectDataFile7.Caption := 'Select';
    ButtonIncludeInputFile7.kind := bkAbort;
    ButtonIncludeInputFile7.Caption:='Not Actice';
        buSelectDataFile8.kind := bkAbort;
    buSelectDataFile8.Caption := 'Select';
    ButtonIncludeInputFile8.kind := bkAbort;
    ButtonIncludeInputFile8.Caption:='Not Actice';
        buSelectDataFile9.kind := bkAbort;
    buSelectDataFile9.Caption := 'Select';
    ButtonIncludeInputFile9.kind := bkAbort;
    ButtonIncludeInputFile9.Caption:='Not Actice';
        buSelectDataFile10.kind := bkAbort;
    buSelectDataFile10.Caption := 'Select';
    ButtonIncludeInputFile10.kind := bkAbort;
    ButtonIncludeInputFile10.Caption:='Not Actice';
        buSelectDataFile11.kind := bkAbort;
    buSelectDataFile11.Caption := 'Select';
    ButtonIncludeInputFile11.kind := bkAbort;
    ButtonIncludeInputFile11.Caption:='Not Actice';
        buSelectDataFile12.kind := bkAbort;
    buSelectDataFile12.Caption := 'Select';
    ButtonIncludeInputFile12.kind := bkAbort;
    ButtonIncludeInputFile12.Caption:='Not Actice';
        buSelectDataFile13.kind := bkAbort;
    buSelectDataFile13.Caption := 'Select';
    ButtonIncludeInputFile13.kind := bkAbort;
    ButtonIncludeInputFile13.Caption:='Not Actice';
        buSelectDataFile14.kind := bkAbort;
    buSelectDataFile14.Caption := 'Select';
    ButtonIncludeInputFile14.kind := bkAbort;
    ButtonIncludeInputFile14.Caption:='Not Actice';
        buSelectDataFile15.kind := bkAbort;
    buSelectDataFile15.Caption := 'Select';
    ButtonIncludeInputFile15.kind := bkAbort;
    ButtonIncludeInputFile15.Caption:='Not Actice';
        buSelectDataFile16.kind := bkAbort;
    buSelectDataFile16.Caption := 'Select';
    ButtonIncludeInputFile16.kind := bkAbort;
    ButtonIncludeInputFile16.Caption:='Not Actice';
        buSelectDataFile17.kind := bkAbort;
    buSelectDataFile17.Caption := 'Select';
    ButtonIncludeInputFile17.kind := bkAbort;
    ButtonIncludeInputFile17.Caption:='Not Actice';
            buSelectDataFile18.kind := bkAbort;
    buSelectDataFile18.Caption := 'Select';
    ButtonIncludeInputFile18.kind := bkAbort;
    ButtonIncludeInputFile18.Caption:='Not Actice';
            buSelectDataFile19.kind := bkAbort;
    buSelectDataFile19.Caption := 'Select';
    ButtonIncludeInputFile19.kind := bkAbort;
    ButtonIncludeInputFile19.Caption:='Not Actice';
            buSelectDataFile20.kind := bkAbort;
    buSelectDataFile20.Caption := 'Select';
    ButtonIncludeInputFile20.kind := bkAbort;
    ButtonIncludeInputFile20.Caption:='Not Actice';
            buSelectDataFile21.kind := bkAbort;
    buSelectDataFile21.Caption := 'Select';
    ButtonIncludeInputFile21.kind := bkAbort;
    ButtonIncludeInputFile21.Caption:='Not Actice';
            buSelectDataFile22.kind := bkAbort;
    buSelectDataFile22.Caption := 'Select';
    ButtonIncludeInputFile22.kind := bkAbort;
    ButtonIncludeInputFile22.Caption:='Not Actice';
            buSelectDataFile23.kind := bkAbort;
    buSelectDataFile23.Caption := 'Select';
    ButtonIncludeInputFile23.kind := bkAbort;
    ButtonIncludeInputFile23.Caption:='Not Actice';
            buSelectDataFile24.kind := bkAbort;
    buSelectDataFile24.Caption := 'Select';
    ButtonIncludeInputFile24.kind := bkAbort;
    ButtonIncludeInputFile24.Caption:='Not Actice';
            buSelectDataFile25.kind := bkAbort;
    buSelectDataFile25.Caption := 'Select';
    ButtonIncludeInputFile25.kind := bkAbort;
    ButtonIncludeInputFile25.Caption:='Not Actice';
            buSelectDataFile26.kind := bkAbort;
    buSelectDataFile26.Caption := 'Select';
    ButtonIncludeInputFile26.kind := bkAbort;
    ButtonIncludeInputFile26.Caption:='Not Actice';
            buSelectDataFile27.kind := bkAbort;
    buSelectDataFile27.Caption := 'Select';
    ButtonIncludeInputFile27.kind := bkAbort;
    ButtonIncludeInputFile27.Caption:='Not Actice';
            buSelectDataFile28.kind := bkAbort;
    buSelectDataFile28.Caption := 'Select';
    ButtonIncludeInputFile28.kind := bkAbort;
    ButtonIncludeInputFile28.Caption:='Not Actice';
  end else
  begin If ChoseProgram.Caption='EU28' then
  begin
    NameInputFile1:='Austria.txt';
    LabelNameInputFile1.Caption:= NameInputFile1;
    buSelectDataFile1.kind :=bkHelp;
    buSelectDataFile1.Caption := 'Not testet';
    ButtonIncludeInputFile1.kind := bkOK;
    ButtonIncludeInputFile1.Caption:='Actice';
    NameInputFile2:='Belgium.txt';
    LabelNameInputFile2.Caption:= NameInputFile2;
    buSelectDataFile2.kind :=bkHelp;
    buSelectDataFile2.Caption := 'Not testet';
    ButtonIncludeInputFile2.kind := bkOK;
    ButtonIncludeInputFile2.Caption:='Actice';
    NameInputFile3:='Bulgaria.txt';
    LabelNameInputFile3.Caption:= NameInputFile3;
    buSelectDataFile3.kind :=bkHelp;
    buSelectDataFile3.Caption := 'Not testet';
    ButtonIncludeInputFile3.kind := bkOK;
    ButtonIncludeInputFile3.Caption:='Actice';
    NameInputFile4:='Croatia.txt';
    LabelNameInputFile4.Caption:= NameInputFile4;
    buSelectDataFile4.kind :=bkHelp;
    buSelectDataFile4.Caption := 'Not testet';
    ButtonIncludeInputFile4.kind := bkOK;
    ButtonIncludeInputFile4.Caption:='Actice';
    NameInputFile5:='Cyprus.txt';
    LabelNameInputFile5.Caption:= NameInputFile5;
    buSelectDataFile5.kind :=bkHelp;
    buSelectDataFile5.Caption := 'Not testet';
    ButtonIncludeInputFile5.kind := bkOK;
    ButtonIncludeInputFile5.Caption:='Actice';
    NameInputFile6:='Czech Republic.txt';
    LabelNameInputFile6.Caption:= NameInputFile6;
    buSelectDataFile6.kind :=bkHelp;
    buSelectDataFile6.Caption := 'Not testet';
    ButtonIncludeInputFile6.kind := bkOK;
    ButtonIncludeInputFile6.Caption:='Actice';
        NameInputFile7:='Denmark.txt';
    LabelNameInputFile7.Caption:= NameInputFile7 ;
    buSelectDataFile7.kind :=bkHelp;
    buSelectDataFile7.Caption := 'Not testet';
    ButtonIncludeInputFile7.kind := bkOK;
    ButtonIncludeInputFile7.Caption:='Actice';
           NameInputFile8:='Estonia.txt';
    LabelNameInputFile8.Caption:= NameInputFile8 ;
    buSelectDataFile8.kind :=bkHelp;
    buSelectDataFile8.Caption := 'Not testet';
    ButtonIncludeInputFile8.kind := bkOK;
    ButtonIncludeInputFile8.Caption:='Actice';
               NameInputFile9:='Finland.txt';
    LabelNameInputFile9.Caption:= NameInputFile9 ;
    buSelectDataFile9.kind :=bkHelp;
    buSelectDataFile9.Caption := 'Not testet';
    ButtonIncludeInputFile9.kind := bkOK;
    ButtonIncludeInputFile9.Caption:='Actice';
               NameInputFile10:='France.txt';
    LabelNameInputFile10.Caption:= NameInputFile10 ;
    buSelectDataFile10.kind :=bkHelp;
    buSelectDataFile10.Caption := 'Not testet';
    ButtonIncludeInputFile10.kind := bkOK;
    ButtonIncludeInputFile10.Caption:='Actice';
               NameInputFile11:='Germany.txt';
    LabelNameInputFile11.Caption:= NameInputFile11 ;
    buSelectDataFile11.kind :=bkHelp;
    buSelectDataFile11.Caption := 'Not testet';
    ButtonIncludeInputFile11.kind := bkOK;
    ButtonIncludeInputFile11.Caption:='Actice';
               NameInputFile12:='Greece.txt';
    LabelNameInputFile12.Caption:= NameInputFile12 ;
    buSelectDataFile12.kind :=bkHelp;
    buSelectDataFile12.Caption := 'Not testet';
    ButtonIncludeInputFile12.kind := bkOK;
    ButtonIncludeInputFile12.Caption:='Actice';
               NameInputFile13:='Hungary.txt';
    LabelNameInputFile13.Caption:= NameInputFile13 ;
    buSelectDataFile13.kind :=bkHelp;
    buSelectDataFile13.Caption := 'Not testet';
    ButtonIncludeInputFile13.kind := bkOK;
    ButtonIncludeInputFile13.Caption:='Actice';
               NameInputFile14:='Ireland.txt';
    LabelNameInputFile14.Caption:= NameInputFile14 ;
    buSelectDataFile14.kind :=bkHelp;
    buSelectDataFile14.Caption := 'Not testet';
    ButtonIncludeInputFile14.kind := bkOK;
    ButtonIncludeInputFile14.Caption:='Actice';
               NameInputFile15:='Italy.txt';
    LabelNameInputFile15.Caption:= NameInputFile15 ;
    buSelectDataFile15.kind :=bkHelp;
    buSelectDataFile15.Caption := 'Not testet';
    ButtonIncludeInputFile15.kind := bkOK;
    ButtonIncludeInputFile15.Caption:='Actice';
               NameInputFile16:='Latvia.txt';
    LabelNameInputFile16.Caption:= NameInputFile16 ;
    buSelectDataFile16.kind :=bkHelp;
    buSelectDataFile16.Caption := 'Not testet';
    ButtonIncludeInputFile16.kind := bkOK;
    ButtonIncludeInputFile16.Caption:='Actice';
               NameInputFile17:='Lithuania.txt';
    LabelNameInputFile17.Caption:= NameInputFile17 ;
    buSelectDataFile17.kind :=bkHelp;
    buSelectDataFile17.Caption := 'Not testet';
    ButtonIncludeInputFile17.kind := bkOK;
    ButtonIncludeInputFile17.Caption:='Actice';
               NameInputFile18:='Luxembourg.txt';
    LabelNameInputFile18.Caption:= NameInputFile18 ;
    buSelectDataFile18.kind :=bkHelp;
    buSelectDataFile18.Caption := 'Not testet';
    ButtonIncludeInputFile18.kind := bkOK;
    ButtonIncludeInputFile18.Caption:='Actice';
               NameInputFile19:='Malta.txt';
    LabelNameInputFile19.Caption:= NameInputFile19 ;
    buSelectDataFile19.kind :=bkHelp;
    buSelectDataFile19.Caption := 'Not testet';
    ButtonIncludeInputFile19.kind := bkOK;
    ButtonIncludeInputFile19.Caption:='Actice';
               NameInputFile20:='Netherlands.txt';
    LabelNameInputFile20.Caption:= NameInputFile20 ;
    buSelectDataFile20.kind :=bkHelp;
    buSelectDataFile20.Caption := 'Not testet';
    ButtonIncludeInputFile20.kind := bkOK;
    ButtonIncludeInputFile20.Caption:='Actice';
               NameInputFile21:='Poland.txt';
    LabelNameInputFile21.Caption:= NameInputFile21 ;
    buSelectDataFile21.kind :=bkHelp;
    buSelectDataFile21.Caption := 'Not testet';
    ButtonIncludeInputFile21.kind := bkOK;
    ButtonIncludeInputFile21.Caption:='Actice';
               NameInputFile22:='Portugal.txt';
    LabelNameInputFile22.Caption:= NameInputFile22 ;
    buSelectDataFile22.kind :=bkHelp;
    buSelectDataFile22.Caption := 'Not testet';
    ButtonIncludeInputFile22.kind := bkOK;
    ButtonIncludeInputFile22.Caption:='Actice';
               NameInputFile23:='Romania.txt';
    LabelNameInputFile23.Caption:= NameInputFile23 ;
    buSelectDataFile23.kind :=bkHelp;
    buSelectDataFile23.Caption := 'Not testet';
    ButtonIncludeInputFile23.kind := bkOK;
    ButtonIncludeInputFile23.Caption:='Actice';
               NameInputFile24:='Slovakia.txt';
    LabelNameInputFile24.Caption:= NameInputFile24 ;
    buSelectDataFile24.kind :=bkHelp;
    buSelectDataFile24.Caption := 'Not testet';
    ButtonIncludeInputFile24.kind := bkOK;
    ButtonIncludeInputFile24.Caption:='Actice';
               NameInputFile25:='Slovenia.txt';
    LabelNameInputFile25.Caption:= NameInputFile25 ;
    buSelectDataFile25.kind :=bkHelp;
    buSelectDataFile25.Caption := 'Not testet';
    ButtonIncludeInputFile25.kind := bkOK;
    ButtonIncludeInputFile25.Caption:='Actice';
               NameInputFile26:='Spain.txt';
    LabelNameInputFile26.Caption:= NameInputFile26 ;
    buSelectDataFile26.kind :=bkHelp;
    buSelectDataFile26.Caption := 'Not testet';
    ButtonIncludeInputFile26.kind := bkOK;
    ButtonIncludeInputFile26.Caption:='Actice';
               NameInputFile27:='Sweden.txt';
    LabelNameInputFile27.Caption:= NameInputFile27 ;
    buSelectDataFile27.kind :=bkHelp;
    buSelectDataFile27.Caption := 'Not testet';
    ButtonIncludeInputFile27.kind := bkOK;
    ButtonIncludeInputFile27.Caption:='Actice';
                   NameInputFile28:='United Kingdom.txt';
    LabelNameInputFile28.Caption:= NameInputFile28 ;
    buSelectDataFile28.kind :=bkHelp;
    buSelectDataFile28.Caption := 'Not testet';
    ButtonIncludeInputFile28.kind := bkOK;
    ButtonIncludeInputFile28.Caption:='Actice';

  end else
  begin
    NameInputFile1:='Estonia.txt';
    LabelNameInputFile1.Caption:= NameInputFile1;
    buSelectDataFile1.kind :=bkHelp;
    buSelectDataFile1.Caption := 'Not testet';
    ButtonIncludeInputFile1.kind := bkOK;
    ButtonIncludeInputFile1.Caption:='Actice';
    NameInputFile2:='Latvia.txt';
    LabelNameInputFile2.Caption:= NameInputFile2;
    buSelectDataFile2.kind :=bkHelp;
    buSelectDataFile2.Caption := 'Not testet';
    ButtonIncludeInputFile2.kind := bkOK;
    ButtonIncludeInputFile2.Caption:='Actice';
    NameInputFile3:='Lithuania.txt';
    LabelNameInputFile3.Caption:= NameInputFile3;
    buSelectDataFile3.kind :=bkHelp;
    buSelectDataFile3.Caption := 'Not testet';
    ButtonIncludeInputFile3.kind := bkOK;
    ButtonIncludeInputFile3.Caption:='Actice';
    buSelectDataFile5.kind := bkAbort;
    buSelectDataFile5.Caption := 'Select';
    ButtonIncludeInputFile5.kind := bkAbort;
    ButtonIncludeInputFile5.Caption:='Not Actice';
    buSelectDataFile4.kind := bkAbort;
    buSelectDataFile4.Caption := 'Select';
    ButtonIncludeInputFile4.kind := bkAbort;
    ButtonIncludeInputFile4.Caption:='Not Actice';
        buSelectDataFile5.kind := bkAbort;
    buSelectDataFile5.Caption := 'Select';
    ButtonIncludeInputFile5.kind := bkAbort;
    ButtonIncludeInputFile5.Caption:='Not Actice';
        buSelectDataFile6.kind := bkAbort;
    buSelectDataFile6.Caption := 'Select';
    ButtonIncludeInputFile6.kind := bkAbort;
    ButtonIncludeInputFile6.Caption:='Not Actice';
        buSelectDataFile7.kind := bkAbort;
    buSelectDataFile7.Caption := 'Select';
    ButtonIncludeInputFile7.kind := bkAbort;
    ButtonIncludeInputFile7.Caption:='Not Actice';
        buSelectDataFile8.kind := bkAbort;
    buSelectDataFile8.Caption := 'Select';
    ButtonIncludeInputFile8.kind := bkAbort;
    ButtonIncludeInputFile8.Caption:='Not Actice';
        buSelectDataFile9.kind := bkAbort;
    buSelectDataFile9.Caption := 'Select';
    ButtonIncludeInputFile9.kind := bkAbort;
    ButtonIncludeInputFile9.Caption:='Not Actice';
        buSelectDataFile10.kind := bkAbort;
    buSelectDataFile10.Caption := 'Select';
    ButtonIncludeInputFile10.kind := bkAbort;
    ButtonIncludeInputFile10.Caption:='Not Actice';
        buSelectDataFile11.kind := bkAbort;
    buSelectDataFile11.Caption := 'Select';
    ButtonIncludeInputFile11.kind := bkAbort;
    ButtonIncludeInputFile11.Caption:='Not Actice';
        buSelectDataFile12.kind := bkAbort;
    buSelectDataFile12.Caption := 'Select';
    ButtonIncludeInputFile12.kind := bkAbort;
    ButtonIncludeInputFile12.Caption:='Not Actice';
        buSelectDataFile13.kind := bkAbort;
    buSelectDataFile13.Caption := 'Select';
    ButtonIncludeInputFile13.kind := bkAbort;
    ButtonIncludeInputFile13.Caption:='Not Actice';
        buSelectDataFile14.kind := bkAbort;
    buSelectDataFile14.Caption := 'Select';
    ButtonIncludeInputFile14.kind := bkAbort;
    ButtonIncludeInputFile14.Caption:='Not Actice';
       buSelectDataFile15.kind := bkAbort;
    buSelectDataFile15.Caption := 'Select';
    ButtonIncludeInputFile15.kind := bkAbort;
    ButtonIncludeInputFile15.Caption:='Not Actice';
        buSelectDataFile16.kind := bkAbort;
    buSelectDataFile16.Caption := 'Select';
    ButtonIncludeInputFile16.kind := bkAbort;
    ButtonIncludeInputFile16.Caption:='Not Actice';
        buSelectDataFile17.kind := bkAbort;
    buSelectDataFile17.Caption := 'Select';
    ButtonIncludeInputFile17.kind := bkAbort;
      ButtonIncludeInputFile17.Caption:='Not Actice';
                    buSelectDataFile18.kind := bkAbort;
    buSelectDataFile18.Caption := 'Select';
    ButtonIncludeInputFile18.kind := bkAbort;
    ButtonIncludeInputFile18.Caption:='Not Actice';
            buSelectDataFile19.kind := bkAbort;
    buSelectDataFile19.Caption := 'Select';
    ButtonIncludeInputFile19.kind := bkAbort;
    ButtonIncludeInputFile19.Caption:='Not Actice';
            buSelectDataFile20.kind := bkAbort;
    buSelectDataFile20.Caption := 'Select';
    ButtonIncludeInputFile20.kind := bkAbort;
    ButtonIncludeInputFile20.Caption:='Not Actice';
            buSelectDataFile21.kind := bkAbort;
    buSelectDataFile21.Caption := 'Select';
    ButtonIncludeInputFile21.kind := bkAbort;
    ButtonIncludeInputFile21.Caption:='Not Actice';
            buSelectDataFile22.kind := bkAbort;
    buSelectDataFile22.Caption := 'Select';
    ButtonIncludeInputFile22.kind := bkAbort;
    ButtonIncludeInputFile22.Caption:='Not Actice';
            buSelectDataFile23.kind := bkAbort;
    buSelectDataFile23.Caption := 'Select';
    ButtonIncludeInputFile23.kind := bkAbort;
    ButtonIncludeInputFile23.Caption:='Not Actice';
            buSelectDataFile24.kind := bkAbort;
    buSelectDataFile24.Caption := 'Select';
    ButtonIncludeInputFile24.kind := bkAbort;
    ButtonIncludeInputFile24.Caption:='Not Actice';
            buSelectDataFile25.kind := bkAbort;
    buSelectDataFile25.Caption := 'Select';
    ButtonIncludeInputFile25.kind := bkAbort;
    ButtonIncludeInputFile25.Caption:='Not Actice';
            buSelectDataFile26.kind := bkAbort;
    buSelectDataFile26.Caption := 'Select';
    ButtonIncludeInputFile26.kind := bkAbort;
    ButtonIncludeInputFile26.Caption:='Not Actice';
            buSelectDataFile27.kind := bkAbort;
    buSelectDataFile27.Caption := 'Select';
    ButtonIncludeInputFile27.kind := bkAbort;
    ButtonIncludeInputFile27.Caption:='Not Actice';
            buSelectDataFile28.kind := bkAbort;
    buSelectDataFile28.Caption := 'Select';
    ButtonIncludeInputFile28.kind := bkAbort;
    ButtonIncludeInputFile28.Caption:='Not Actice';
  end;
  end;
  buSelectDataFileSum.kind :=bkHelp;
  buSelectDataFileSum.Caption := 'Not testet';
  Reset.kind := bkOK;
  Reset.Caption:='Reset';
end;




procedure TExecuteToolMain.buSelectDataFile1Click(Sender: TObject);

begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile1 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile1);
  LabelNameInputFile1.Caption:= NameInputFile1;
  buSelectDataFile1.kind := bkOK;
  buSelectDataFile1.Caption := 'OK !';
  ButtonIncludeInputFile1.kind := bkOK;
  ButtonIncludeInputFile1.Caption:='Actice';

  StringGrid1.Cells[1, 0] := NameInputFile1;
  StringGrid1.Cells[0, 1] := NameInputFile1;
  StringGrid1.Cells[1,1]:='N/A';


  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile2Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile2 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile2);
  LabelNameInputFile2.Caption:= NameInputFile2;
  buSelectDataFile2.kind := bkOK;
  buSelectDataFile2.Caption := 'OK !';
  ButtonIncludeInputFile2.kind := bkOK;
  ButtonIncludeInputFile2.Caption:='Actice';

  StringGrid1.RowCount:=StringGrid1.RowCount+1;
  StringGrid1.ColCount:=StringGrid1.ColCount+1;
  StringGrid1.Cells[2, 0] := NameInputFile2;
  StringGrid1.Cells[0, 2] := NameInputFile2;
    StringGrid1.Cells[2,2]:='N/A';

  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile3Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile3 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath +'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile3);
  LabelNameInputFile3.Caption:= NameInputFile3;
  buSelectDataFile3.kind := bkOK;
  buSelectDataFile3.Caption := 'OK !';
  ButtonIncludeInputFile3.kind := bkOK;
  ButtonIncludeInputFile3.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile4Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile4 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile4);
  LabelNameInputFile4.Caption:= NameInputFile4;
  buSelectDataFile4.kind := bkOK;
  buSelectDataFile4.Caption := 'OK !';
  ButtonIncludeInputFile4.kind := bkOK;
  ButtonIncludeInputFile4.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile5Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile5 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile5);
  LabelNameInputFile5.Caption:= NameInputFile5;
  buSelectDataFile5.kind := bkOK;
  buSelectDataFile5.Caption := 'OK !';
  ButtonIncludeInputFile5.kind := bkOK;
  ButtonIncludeInputFile5.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile6Click(Sender: TObject);
begin
  inherited;
    OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile6 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile6);
  LabelNameInputFile6.Caption:= NameInputFile6;
  buSelectDataFile6.kind := bkOK;
  buSelectDataFile6.Caption := 'OK !';
  ButtonIncludeInputFile6.kind := bkOK;
  ButtonIncludeInputFile6.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile7Click(Sender: TObject);
begin
  inherited;
    OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile7 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile7);
  LabelNameInputFile7.Caption:= NameInputFile7;
  buSelectDataFile7.kind := bkOK;
  buSelectDataFile7.Caption := 'OK !';
  ButtonIncludeInputFile7.kind := bkOK;
  ButtonIncludeInputFile7.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile8Click(Sender: TObject);
begin
  inherited;
      OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile8 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile8);
  LabelNameInputFile8.Caption:= NameInputFile8;
  buSelectDataFile8.kind := bkOK;
  buSelectDataFile8.Caption := 'OK !';
  ButtonIncludeInputFile8.kind := bkOK;
  ButtonIncludeInputFile8.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile9Click(Sender: TObject);
begin
  inherited;
        OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile9 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile9);
  LabelNameInputFile9.Caption:= NameInputFile9;
  buSelectDataFile9.kind := bkOK;
  buSelectDataFile9.Caption := 'OK !';
  ButtonIncludeInputFile9.kind := bkOK;
  ButtonIncludeInputFile9.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile10Click(Sender: TObject);
begin
  inherited;
     OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile10 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile10);
  LabelNameInputFile10.Caption:= NameInputFile10;
  buSelectDataFile10.kind := bkOK;
  buSelectDataFile10.Caption := 'OK !';
  ButtonIncludeInputFile10.kind := bkOK;
  ButtonIncludeInputFile10.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile11Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile11 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile11);
  LabelNameInputFile11.Caption:= NameInputFile11;
  buSelectDataFile11.kind := bkOK;
  buSelectDataFile11.Caption := 'OK !';
  ButtonIncludeInputFile11.kind := bkOK;
  ButtonIncludeInputFile11.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile12Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile12 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile12);
  LabelNameInputFile12.Caption:= NameInputFile12;
  buSelectDataFile12.kind := bkOK;
  buSelectDataFile12.Caption := 'OK !';
  ButtonIncludeInputFile12.kind := bkOK;
  ButtonIncludeInputFile12.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile13Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile13 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile13);
  LabelNameInputFile13.Caption:= NameInputFile13;
  buSelectDataFile13.kind := bkOK;
  buSelectDataFile13.Caption := 'OK !';
  ButtonIncludeInputFile13.kind := bkOK;
  ButtonIncludeInputFile13.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile14Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile14 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile14);
  LabelNameInputFile14.Caption:= NameInputFile14;
  buSelectDataFile14.kind := bkOK;
  buSelectDataFile14.Caption := 'OK !';
  ButtonIncludeInputFile14.kind := bkOK;
  ButtonIncludeInputFile14.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile15Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile15 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile15);
  LabelNameInputFile15.Caption:= NameInputFile15;
  buSelectDataFile15.kind := bkOK;
  buSelectDataFile15.Caption := 'OK !';
  ButtonIncludeInputFile15.kind := bkOK;
  ButtonIncludeInputFile15.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;



procedure TExecuteToolMain.buSelectDataFile16Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile16 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile16);
  LabelNameInputFile16.Caption:= NameInputFile16;
  buSelectDataFile16.kind := bkOK;
  buSelectDataFile16.Caption := 'OK !';
  ButtonIncludeInputFile16.kind := bkOK;
  ButtonIncludeInputFile16.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile17Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile17 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile17);
  LabelNameInputFile17.Caption:= NameInputFile17;
  buSelectDataFile17.kind := bkOK;
  buSelectDataFile17.Caption := 'OK !';
  ButtonIncludeInputFile17.kind := bkOK;
  ButtonIncludeInputFile17.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;



procedure TExecuteToolMain.buSelectDataFile18Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile18 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile18);
  LabelNameInputFile18.Caption:= NameInputFile18;
  buSelectDataFile18.kind := bkOK;
  buSelectDataFile18.Caption := 'OK !';
  ButtonIncludeInputFile18.kind := bkOK;
  ButtonIncludeInputFile18.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile19Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile19 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile19);
  LabelNameInputFile19.Caption:= NameInputFile19;
  buSelectDataFile19.kind := bkOK;
  buSelectDataFile19.Caption := 'OK !';
  ButtonIncludeInputFile19.kind := bkOK;
  ButtonIncludeInputFile19.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile20Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile20 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile20);
  LabelNameInputFile20.Caption:= NameInputFile20;
  buSelectDataFile20.kind := bkOK;
  buSelectDataFile20.Caption := 'OK !';
  ButtonIncludeInputFile20.kind := bkOK;
  ButtonIncludeInputFile20.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile21Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile21 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile21);
  LabelNameInputFile21.Caption:= NameInputFile21;
  buSelectDataFile21.kind := bkOK;
  buSelectDataFile21.Caption := 'OK !';
  ButtonIncludeInputFile21.kind := bkOK;
  ButtonIncludeInputFile21.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile22Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile22 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile22);
  LabelNameInputFile22.Caption:= NameInputFile22;
  buSelectDataFile22.kind := bkOK;
  buSelectDataFile22.Caption := 'OK !';
  ButtonIncludeInputFile22.kind := bkOK;
  ButtonIncludeInputFile22.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile23Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile23 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile23);
  LabelNameInputFile23.Caption:= NameInputFile23;
  buSelectDataFile23.kind := bkOK;
  buSelectDataFile23.Caption := 'OK !';
  ButtonIncludeInputFile23.kind := bkOK;
  ButtonIncludeInputFile23.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile24Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile24 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile24);
  LabelNameInputFile24.Caption:= NameInputFile24;
  buSelectDataFile24.kind := bkOK;
  buSelectDataFile24.Caption := 'OK !';
  ButtonIncludeInputFile24.kind := bkOK;
  ButtonIncludeInputFile24.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile25Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile25 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile25);
  LabelNameInputFile25.Caption:= NameInputFile25;
  buSelectDataFile25.kind := bkOK;
  buSelectDataFile25.Caption := 'OK !';
  ButtonIncludeInputFile25.kind := bkOK;
  ButtonIncludeInputFile25.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile26Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile26 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile26);
  LabelNameInputFile26.Caption:= NameInputFile26;
  buSelectDataFile26.kind := bkOK;
  buSelectDataFile26.Caption := 'OK !';
  ButtonIncludeInputFile26.kind := bkOK;
  ButtonIncludeInputFile26.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile27Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile27 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile27);
  LabelNameInputFile27.Caption:= NameInputFile27;
  buSelectDataFile27.kind := bkOK;
  buSelectDataFile27.Caption := 'OK !';
  ButtonIncludeInputFile27.kind := bkOK;
  ButtonIncludeInputFile27.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectDataFile28Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath +
    'energyPLAN Data\Data';
  OpenDialog1.Execute;
  NameInputFile28 := OpenDialog1.FileName;
  ExtractFileName(OpenDialog1.FileName);
  NameCut(EnergyPlanExePath+'energyPLAN Data\Data',
              OpenDialog1.FileName,NameInputFile28);
  LabelNameInputFile28.Caption:= NameInputFile28;
  buSelectDataFile28.kind := bkOK;
  buSelectDataFile28.Caption := 'OK !';
  ButtonIncludeInputFile28.kind := bkOK;
  ButtonIncludeInputFile28.Caption:='Actice';
  buSelectDataFileSum.kind :=bkHelp;
 buSelectDataFileSum.Caption := 'Not testet'; TestUnitFail.kind :=bkHelp; TestUnitFail.Caption := 'Not testet'; TestRESFail.kind :=bkHelp; TestRESFail.Caption := 'Not testet';
  Reset.kind := bkAbort;
  Reset.Caption:='Reset';
end;

procedure TExecuteToolMain.buSelectEnergyPlan1Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath;
  OpenDialog1.Execute;
  NameExecuteFile1 := ExtractFileName(OpenDialog1.FileName);
end;

procedure TExecuteToolMain.buSelectEnergyPlan2Click(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath;
  OpenDialog1.Execute;
  NameExecuteFile2 := ExtractFileName(OpenDialog1.FileName);
end;

procedure TExecuteToolMain.About1Click(Sender: TObject);
var lfile :string;
begin
  lfile := EnergyPlanExePath + '\energyPlan Help\ExternExecuteDocumentation.pdf';
  if FileExists(lFile) then
    ShellExecute(Handle, nil, PChar(lFile), nil,  nil, SW_SHOWNORMAL)
  else
   showMessage('File documentation.pdf not found')
end;






procedure TExecuteToolMain.buDumpAsciiClick(Sender: TObject);
var
  x,y,z : integer;
  lExecuteCommandLine: string;
  //CompareResult : Integer;
begin
 inherited;
 If buSelectDataFilesum.Caption = 'OK !' then
 Begin
  ButtonResultInputFile1.visible:=false;
  ButtonResultInputFile2.visible:=false;
  ButtonResultInputFile3.visible:=false;
  ButtonResultInputFile4.visible:=false;
  ButtonResultInputFile5.visible:=false;
  ButtonResultInputFile6.Visible:=false;
    ButtonResultInputFile7.visible:=false;
  ButtonResultInputFile8.visible:=false;
  ButtonResultInputFile9.visible:=false;
  ButtonResultInputFile10.visible:=false;
  ButtonResultInputFile11.visible:=false;
  ButtonResultInputFile12.Visible:=false;
    ButtonResultInputFile13.visible:=false;
  ButtonResultInputFile14.visible:=false;
  ButtonResultInputFile15.visible:=false;
  ButtonResultInputFile16.visible:=false;
 ButtonResultInputFile17.visible:=false;
  ButtonResultInputFile18.Visible:=false;
    ButtonResultInputFile19.visible:=false;
  ButtonResultInputFile20.visible:=false;
  ButtonResultInputFile21.visible:=false;
  ButtonResultInputFile22.visible:=false;
  ButtonResultInputFile23.visible:=false;
  ButtonResultInputFile24.Visible:=false;
    ButtonResultInputFile25.visible:=false;
  ButtonResultInputFile26.visible:=false;
  ButtonResultInputFile27.visible:=false;
  ButtonResultInputFile28.visible:=false;

  Unit1.Visible:=False;
Unit2.Visible:=False;
Unit3.Visible:=False;
Unit4.Visible:=False;
Unit5.Visible:=False;
Unit6.Visible:=False;
Unit7.Visible:=False;
Unit8.Visible:=False;
Unit9.Visible:=False;
Unit10.Visible:=False;
Unit11.Visible:=False;
Unit12.Visible:=False;
Unit13.Visible:=False;
Unit14.Visible:=False;
Unit15.Visible:=False;
Unit16.Visible:=False;
Unit17.Visible:=False;
Unit18.Visible:=False;
Unit19.Visible:=False;
Unit20.Visible:=False;
Unit21.Visible:=False;
Unit22.Visible:=False;
Unit23.Visible:=False;
Unit24.Visible:=False;
Unit25.Visible:=False;
Unit26.Visible:=False;
Unit27.Visible:=False;
Unit28.Visible:=False;

  ClearDatasetSum;

  If ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile1+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:= 'MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile1.kind := bkOK;
    ButtonResultInputFile1.Caption := 'Done !';
    ButtonResultInputFile1.visible:=true;
    AddtoDataset;
    DataFile1:=DataSet;
    AddtoDatasetSum;
  end;

  If ButtonIncludeInputFile2.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile2+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:= 'MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile2.kind := bkOK;
    ButtonResultInputFile2.Caption := 'Done !';
    ButtonResultInputFile2.visible:=true;
    AddtoDataset;
    DataFile2:=DataSet;
    AddtoDatasetSum;
  end;

  If ButtonIncludeInputFile3.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile3+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:= 'MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile3.kind := bkOK;
    ButtonResultInputFile3.Caption := 'Done !';
    ButtonResultInputFile3.visible:=true;
    DataFile3:=DataSet;
    AddtoDatasetSum;
  end;

  If ButtonIncludeInputFile4.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile4+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:= 'MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile4.kind := bkOK;
    ButtonResultInputFile4.Caption := 'Done !';
    ButtonResultInputFile4.visible:=true;
       DataFile4:=DataSet;
    AddtoDatasetSum;
  end;

  If ButtonIncludeInputFile5.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile5+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:= 'MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile5.kind := bkOK;
    ButtonResultInputFile5.Caption := 'Done !';
    ButtonResultInputFile5.visible:=true;
       DataFile5:=DataSet;
    AddtoDatasetSum;
  end;

  if ButtonIncludeInputFile6.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile6+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile6.kind := bkOK;
    ButtonResultInputFile6.Caption := 'Done !';
    ButtonResultInputFile6.visible:=true;
       DataFile6:=DataSet;
    AddtoDatasetSum;
  end;

    if ButtonIncludeInputFile7.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile7+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile7.kind := bkOK;
    ButtonResultInputFile7.Caption := 'Done !';
    ButtonResultInputFile7.visible:=true;
       DataFile7:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile8.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile8+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MulipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile8.kind := bkOK;
    ButtonResultInputFile8.Caption := 'Done !';
    ButtonResultInputFile8.visible:=true;
       DataFile8:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile9.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile9+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile9.kind := bkOK;
    ButtonResultInputFile9.Caption := 'Done !';
    ButtonResultInputFile9.visible:=true;
       DataFile9:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile10.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile10+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile10.kind := bkOK;
    ButtonResultInputFile10.Caption := 'Done !';
    ButtonResultInputFile10.visible:=true;
       DataFile10:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile11.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile11+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile11.kind := bkOK;
    ButtonResultInputFile11.Caption := 'Done !';
    ButtonResultInputFile11.visible:=true;
       DataFile11:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile12.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile12+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile12.kind := bkOK;
    ButtonResultInputFile12.Caption := 'Done !';
    ButtonResultInputFile12.visible:=true;
       DataFile12:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile13.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile13+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile13.kind := bkOK;
    ButtonResultInputFile13.Caption := 'Done !';
    ButtonResultInputFile13.visible:=true;
       DataFile13:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile14.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile14+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile14.kind := bkOK;
    ButtonResultInputFile14.Caption := 'Done !';
    ButtonResultInputFile14.visible:=true;
       DataFile14:=DataSet;
    AddtoDatasetSum;
  end;

  if ButtonIncludeInputFile15.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile15+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile15.kind := bkOK;
    ButtonResultInputFile15.Caption := 'Done !';
    ButtonResultInputFile15.visible:=true;
       DataFile15:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile16.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile16+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile16.kind := bkOK;
    ButtonResultInputFile16.Caption := 'Done !';
    ButtonResultInputFile16.visible:=true;
       DataFile16:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile17.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile17+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile17.kind := bkOK;
    ButtonResultInputFile17.Caption := 'Done !';
    ButtonResultInputFile17.visible:=true;
       DataFile17:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile18.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile18+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile18.kind := bkOK;
    ButtonResultInputFile18.Caption := 'Done !';
    ButtonResultInputFile18.visible:=true;
       DataFile18:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile19.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile19+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile19.kind := bkOK;
    ButtonResultInputFile19.Caption := 'Done !';
    ButtonResultInputFile19.visible:=true;
       DataFile19:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile20.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile20+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile20.kind := bkOK;
    ButtonResultInputFile20.Caption := 'Done !';
    ButtonResultInputFile20.visible:=true;
       DataFile20:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile21.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile21+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile21.kind := bkOK;
    ButtonResultInputFile21.Caption := 'Done !';
    ButtonResultInputFile21.visible:=true;
    DataFile21:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile22.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile22+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile22.kind := bkOK;
    ButtonResultInputFile22.Caption := 'Done !';
    ButtonResultInputFile22.visible:=true;
    DataFile22:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile23.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile23+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile23.kind := bkOK;
    ButtonResultInputFile23.Caption := 'Done !';
    ButtonResultInputFile23.visible:=true;
    DataFile23:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile24.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile24+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile24.kind := bkOK;
    ButtonResultInputFile24.Caption := 'Done !';
    ButtonResultInputFile24.visible:=true;
    DataFile24:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile25.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile25+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile25.kind := bkOK;
    ButtonResultInputFile25.Caption := 'Done !';
    ButtonResultInputFile25.visible:=true;
    DataFile25:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile26.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile26+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile26.kind := bkOK;
    ButtonResultInputFile26.Caption := 'Done !';
    ButtonResultInputFile26.visible:=true;
    DataFile26:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile27.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile27+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile27.kind := bkOK;
    ButtonResultInputFile27.Caption := 'Done !';
    ButtonResultInputFile27.visible:=true;
    DataFile27:=DataSet;
    AddtoDatasetSum;
  end;

      if ButtonIncludeInputFile28.Caption='Actice' then
  begin
    lExecuteCommandLine := ' -i '+NameInputFile28+' -test MultipleExecutionToolDataTransport';
    RunEnergyPlan(lExecuteCommandLine,'EnergyPLAN.exe');
    Filnavn:='MultipleExecutionToolDataTransport';
    ReadDataset(Filnavn, DataSet11);
    ButtonResultInputFile28.kind := bkOK;
    ButtonResultInputFile28.Caption := 'Done !';
    ButtonResultInputFile28.visible:=true;
    DataFile28:=DataSet;
    AddtoDatasetSum;
  end;

 End else LabelTestWarning.visible:=true;

end;



//Create Import Export Balance. When finished run Multiple Execution again.
procedure TExecuteToolMain.ImpExpClick(Sender: TObject);
var
x,y:integer;
txt:string ;
Input:TRichEdit;
Lines: TStringList   ;
begin
  inherited;

  //Create array of import
  for x := 1 to 8784 do hourarray_pp_sum[x]:=DataFile1[51,x];
  //Create array of export
  for x := 1 to 8784 do hourarray_export[x]:=DataFile1[53,x];

  //Create Bank
  Bank[x]:=hourarray_export[x]-hourarray_pp_sum[x] ;

 //Export Bank til txt file

    SaveDialog1.InitialDir := EnergyPlanExePath +
  'energyPLAN Data\Distributions';
  SaveDialog1.Execute;
  Filnavn:=SaveDialog1.FileName;
    For x := 1 to 8784 do
    begin
      txt:=floattostr(hourarray_pp_sum[x]);
      Input.Lines.add(txt);
    end;

    Input.Lines.SaveToFile(FilNavn);
    NameCut(EnergyPlanExePath+'energyPLAN Data\Distributions',
              Filnavn,NameOutputFile1);


end;




procedure TExecuteToolMain.buOnlineClick(Sender: TObject);
var
  lExecuteCommandLine: string;
begin
  inherited;
  //lExecuteCommandLine := ' -i '+edProjectFile.Text+ ' -m '+ edModFile.Text+' -online '+ edOnlinedumpfile.Text;
  //RunEnergyPlan(lExecuteCommandLine,NameExecuteFile1);
end;

procedure TExecuteToolMain.buReadAndModifyClick(Sender: TObject);
var
  lExecuteCommandLine: string;
begin
  inherited;
  //lExecuteCommandLine := ' -i '+edProjectFile.Text+' -m '+ edModFile.Text;
  //RunEnergyPlan(lExecuteCommandLine,NameExecuteFile1);
end;

procedure TExecuteToolMain.buReadProjectfileClick(Sender: TObject);
var
  lExecuteCommandLine: string;
begin
  inherited;
  lExecuteCommandLine := ' -i '+NameInputFile1;
  RunEnergyPlan(lExecuteCommandLine,NameExecuteFile1);
end;


procedure TExecuteToolMain.edAsciiDumpFileDblClick(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath;
  OpenDialog1.Execute;
end;

procedure TExecuteToolMain.edModFileDblClick(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath;
  OpenDialog1.Execute;
end;


Procedure read_data_file(filnavn: string);

var

  F: textfile;

  // s: string;

  // x : Integer;

  i: integer;

  SL: TStringList;

begin

  Succes := False;

  try

    try

      AssignFile(F, filnavn);

      Reset(F);

    except

      on EInOutError do

      begin

        showmessage('File not found: ' +  filnavn);

        exit;

      end;

    end;

  finally

    CloseFile(F);

  end;

  SL := TStringList.Create;

  try

    SL.LoadFromFile(filnavn);

    for i := 0 to SL.Count - 1 do

      Data[i + 1] := SL[i];

  finally

    FreeAndNil(SL);

  end;

  (* x := 1;

    Repeat

    Readln(F, s); { Read the first line out of the file }

    // if pos('.',s)<>0 then s[pos('.',s)]:=DecimalSeparator;  //Henning

    // if pos(',',s)<>0 then s[pos(',',s)]:=DecimalSeparator;  //Henning

    Data[x] := s;

    x := x + 1;

    until eof(F);

    Succes := True;

    Finally

    try

    CloseFile(F);

    except

    end;}

    end; *)

end;

Procedure Transfer_from_file_to_Input_variables;
var
  x: integer;

  function strtofloatSubst(s: String): double;
  Begin
    if pos('.', s) <> 0 then
      s[pos('.', s)] := FormatSettings.DecimalSeparator;
    if pos(',', s) <> 0 then
      s[pos(',', s)] := FormatSettings.DecimalSeparator;
    result := strtofloat(s);
  end;

Begin
  // Vrdier fra fil overfres til input variable
   with TExecuteToolMain do
  Begin
    version := 500;
    if Data[1] = 'EnergyPLAN version' then
      version := strtofloatSubst(Data[2]);
    If version >= 670 then
      for x := 1 to 1500 do
      begin
        if Data[x] = 'EnergyUnit=' then
          TestEnergyUnit := Data[x + 1];
        if Data[x] = 'CapacityUnit=' then
          TestCapacityUnit := Data[x + 1];
        if Data[x] = 'MonetaryUnit=' then
          TestMonetaryUnit := Data[x + 1];
        if Data[x] = 'Input_el_demand_Twh=' then
          input_El_demand_TWh := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_El_demand_elec_heating_share=' then
          Input_El_demand_elec_heating_share := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_El_demand_cooling_share=' then
          Input_El_demand_cooling_share := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_dh_demand_TWh=' then
          input_dh_demand_twh := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RES1_capacity=' then
          input_RES1_capacity := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RES2_capacity=' then
          input_RES2_capacity := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RES1_factor=' then
          input_RES1_factor := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RES2_factor=' then
          input_RES2_factor := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RES3_capacity=' then
          input_RES3_capacity := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RES3_factor=' then
          input_RES3_factor := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RES4_capacity=' then
          input_RES4_capacity := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RES4_factor=' then
          input_RES4_factor := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'NameRES1=' then
          TestNameRES1 := Data[x + 1];
        if Data[x] = 'NameRES2=' then
          TestNameRES2 := Data[x + 1];
        if Data[x] = 'NameRES3=' then
          TestNameRES3 := Data[x + 1];
        if Data[x] = 'NameRES4=' then
          TestNameRES4 := Data[x + 1];
        if Data[x] = 'input_dh_ann_gr1=' then
          input_dh_ann_gr1 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_dh_ann_gr2=' then
          input_dh_ann_gr2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_dh_ann_gr3=' then
          input_dh_ann_gr3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_solar_ann_gr1=' then
          input_solar_ann_gr1 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_solar_ann_gr2=' then
          input_solar_ann_gr2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_solar_ann_gr3=' then
          input_solar_ann_gr3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cshp_th_gr1=' then
          input_cshp_th_gr1 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cshp_th_gr2=' then
          input_cshp_th_gr2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cshp_th_gr3=' then
          input_cshp_th_gr3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_AddExport_TWh=' then
          input_AddExport_twh := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_flexible_day_TWh=' then
          input_flexible_day_twh := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_flexible_week_TWh=' then
          input_flexible_week_twh := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_flexible_4weeks_TWh=' then
          input_flexible_4weeks_twh := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_flexible_day_max=' then
          input_flexible_day_max := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_flexible_week_max=' then
          input_flexible_week_max := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_flexible_4weeks_max=' then
          input_flexible_4weeks_max := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cshp_el_gr1=' then
          input_cshp_el_gr1 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cshp_el_gr2=' then
          input_cshp_el_gr2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cshp_el_gr3=' then
          input_cshp_el_gr3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cshp_el_gr3=' then
          input_cshp_el_gr3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Filnavn_elbehov=' then
          Filnavn_elbehov := Data[x + 1];
        if Data[x] = 'Filnavn_individual_heatdemand=' then
          Filnavn_individual_heatdemand := Data[x + 1];
        if Data[x] = 'Filnavn_cooling_demand=' then
          Filnavn_cooling_demand := Data[x + 1];
        if Data[x] = 'Filnavn_individual_solar=' then
          Filnavn_individual_solar := Data[x + 1];
        if Data[x] = 'Filnavn_dh=' then
          Filnavn_dh := Data[x + 1];
        if Data[x] = 'input_button_add_subtract=' then
          input_button_add_subtract := Data[x + 1];
        if Data[x] = 'input_button_add2=' then
          input_button_add2 := Data[x + 1];
        if Data[x] = 'Filnavn_AddExport=' then
          Filnavn_AddExport := Data[x + 1];
        if Data[x] = 'Filnavn_wind=' then
          Filnavn_wind := Data[x + 1];
        if Data[x] = 'Filnavn_wave=' then
          Filnavn_wave := Data[x + 1];
        if Data[x] = 'Filnavn_solar=' then
          Filnavn_solar := Data[x + 1];
        if Data[x] = 'Filnavn_cshp=' then
          Filnavn_cshp := Data[x + 1];
        if Data[x] = 'Filnavn_pv=' then
          Filnavn_pv := Data[x + 1];
        if Data[x] = 'Filnavn_RES4=' then
          Filnavn_res4 := Data[x + 1];
        if Data[x] = 'filnavn_hydro_water=' then
          filnavn_hydro_water := Data[x + 1];
        if Data[x] = 'filnavn_nuclear=' then
          filnavn_nuclear := Data[x + 1];
        if Data[x] = 'input_transport_TWh=' then
          input_transport_twh := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_transport_TWh_V2G=' then
          input_transport_twh_v2g := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Filnavn_transport=' then
          Filnavn_transport := Data[x + 1];
        if Data[x] = 'Filnavn_transport_V2G=' then
          Filnavn_transport_V2G := Data[x + 1];
        if Data[x] = 'Filnavn_transport_H2=' then
          Filnavn_transport_h2 := Data[x + 1];
        if Data[x] = 'input_km_diesel=' then
          input_km_diesel := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_km_ngas=' then
          input_km_ngas := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_km_biomass=' then
          input_km_biomass := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_km_h2=' then
          input_km_h2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_km_ev=' then
          input_km_ev := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_km_v2g=' then
          input_km_v2g := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_V2G_MaxShare=' then
          input_V2G_MaxShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_V2G_Cap_Charge=' then
          input_V2G_Cap_Charge := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_V2G_ConnectionShare=' then
          input_V2G_ConnectionShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_V2G_Eff_Charge=' then
          input_V2G_Eff_Charge := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_V2G_Eff_Inv=' then
          input_V2G_Eff_Inv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_V2G_Battery=' then
          input_V2G_Battery := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_V2G_Cap_Inv=' then
          input_V2G_Cap_Inv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cap_chp2_el=' then
          input_cap_chp2_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_chp2_el=' then
          input_eff_chp2_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_chp2_th=' then
          input_eff_chp2_th := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cap_hp2_el=' then
          input_cap_hp2_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_hp2_cop=' then
          input_eff_hp2_cop := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cap_boiler2_th=' then
          input_cap_boiler2_th := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_boiler2_th=' then
          input_eff_boiler2_th := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cap_chp3_el=' then
          input_cap_chp3_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_chp3_el=' then
          input_eff_chp3_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_chp3_th=' then
          input_eff_chp3_th := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cap_hp3_el=' then
          input_cap_hp3_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_hp3_cop=' then
          input_eff_hp3_cop := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cap_boiler3_th=' then
          input_cap_boiler3_th := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_boiler3_th=' then
          input_eff_boiler3_th := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cap_pp_el=' then
          input_cap_pp_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_hydro_cap=' then
          input_hydro_cap := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_hydro_eff=' then
          input_hydro_eff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_hydro_watersupply=' then
          input_hydro_watersupply := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_hydro_storage=' then
          input_hydro_storage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_hydro_pump_cap=' then
          input_hydro_pump_cap := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_hydro_pump_eff=' then
          input_hydro_pump_eff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_nuclear_cap=' then
          input_nuclear_cap := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_nuclear_eff=' then
          input_nuclear_eff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_pp_el=' then
          input_eff_pp_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_dhp_th=' then
          input_eff_dhp_th := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_storage_gr2_cap=' then
          input_storage_gr2_cap := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_storage_gr3_cap=' then
          input_storage_gr3_cap := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_FixedBoiler2=' then
          input_FixedBoiler2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_FixedBoiler3=' then
          input_FixedBoiler3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_regulation=' then
          input_regulation := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_marketmodel=' then
          input_marketmodel := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_chpgr3_cap_minimum=' then
          input_chpgr3_cap_minimum := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_hp_maxload=' then
          input_hp_maxload := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_imp_reg_fac=' then
          input_imp_reg_fac := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_exp_pp_reg_fac=' then
          input_exp_pp_reg_fac := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_exp_chp_reg_fac=' then
          input_exp_chp_reg_fac := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Filnavn_prices=' then
          Filnavn_prices := Data[x + 1];
        if Data[x] = 'input_exp_hp_reg_fac=' then
          input_exp_hp_reg_fac := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_max_imp_exp=' then
          input_max_imp_exp := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_lost_value=' then
          input_lost_value := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_nordpool_add_fac=' then
          input_nordpool_add_fac := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_nordpool_mult_fac=' then
          input_nordpool_mult_fac := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_keol_reg=' then
          Input_keol_reg := Data[x + 1];
        if Data[x] = 'input_depend_fac=' then
          input_depend_fac := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_import_bottleneck_addprice_factor=' then
          input_import_bottleneck_addprice_factor :=
            strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_stabilisation_share_min=' then
          input_stabilisation_share_min := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_stabilisation_share_chp2=' then
          input_stabilisation_share_chp2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RES1_stab_share=' then
          input_RES1_stab_share := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RES2_stab_share=' then
          input_RES2_stab_share := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RES3_stab_share=' then
          input_RES3_stab_share := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RES4_stab_share=' then
          input_RES4_stab_share := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_dhp[1]=' then
          Input_fuel_dhp[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_dhp[2]=' then
          Input_fuel_dhp[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_dhp[3]=' then
          Input_fuel_dhp[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_dhp[4]=' then
          Input_fuel_dhp[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_chp2[1]=' then
          Input_fuel_chp2[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_chp2[2]=' then
          Input_fuel_chp2[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_chp2[3]=' then
          Input_fuel_chp2[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_chp2[4]=' then
          Input_fuel_chp2[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_chp3[1]=' then
          Input_fuel_chp3[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_chp3[2]=' then
          Input_fuel_chp3[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_chp3[3]=' then
          Input_fuel_chp3[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_chp3[4]=' then
          Input_fuel_chp3[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Boiler2[1]=' then
          Input_fuel_boiler2[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Boiler2[2]=' then
          Input_fuel_boiler2[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Boiler2[3]=' then
          Input_fuel_boiler2[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Boiler2[4]=' then
          Input_fuel_boiler2[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Boiler3[1]=' then
          Input_fuel_boiler3[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Boiler3[2]=' then
          Input_fuel_boiler3[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Boiler3[3]=' then
          Input_fuel_boiler3[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Boiler3[4]=' then
          Input_fuel_boiler3[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_PP[1]=' then
          Input_fuel_pp[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_PP[2]=' then
          Input_fuel_pp[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_PP[3]=' then
          Input_fuel_pp[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_PP[4]=' then
          Input_fuel_pp[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Transport[1]=' then
          Input_fuel_transport[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Transport[2]=' then
          Input_fuel_transport[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Transport[3]=' then
          Input_fuel_transport[3] := strtofloatSubst(Data[x + 1]);
        // if Data[x] = 'input_fuel_Transport[4]=' then
        // Input_fuel_transport[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Transport[6]=' then
          Input_fuel_transport[6] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_VC_boiler_dh=' then
          Input_VC_boiler_dh := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_VC_chp_dh=' then
          Input_VC_chp_dh := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_VC_hp_dh=' then
          Input_VC_hp_dh := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_VC_pp=' then
          Input_VC_pp := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_VC_hydro=' then
          Input_VC_hydro := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_VC_eh_dh=' then
          Input_VC_eh_dh := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_VC_geothermal=' then
          Input_VC_geothermal := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_VC_electrolyser=' then
          Input_VC_electrolyser := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_VC_pump=' then
          input_VC_pump := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_VC_turbine=' then
          input_VC_turbine := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_VC_boiler_indv=' then
          Input_VC_boiler_indv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_VC_chp_indv=' then
          Input_VC_chp_indv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_VC_hp_indv=' then
          Input_VC_hp_indv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_VC_eh_indv=' then
          Input_VC_eh_indv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Households[1]=' then
          Input_fuel_households[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Households[2]=' then
          Input_fuel_households[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Households[3]=' then
          Input_fuel_households[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Households[4]=' then
          Input_fuel_households[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_coalboiler_eff=' then
          Input_HH_coalboiler_eff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_oilboiler_eff=' then
          Input_HH_oilboiler_eff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_ngasboiler_eff=' then
          Input_HH_Ngasboiler_eff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_bioboiler_eff=' then
          Input_HH_Bioboiler_eff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_H2CHP_eff_th=' then
          Input_HH_H2CHP_eff_th := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_NgasCHP_eff_th=' then
          Input_HH_NgasCHP_eff_th := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_BioCHP_eff_th=' then
          Input_HH_BioCHP_eff_th := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_H2CHP_heat=' then
          Input_HH_H2CHP_heat := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_NgasCHP_heat=' then
          Input_HH_NgasCHP_heat := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_H2CHP_solar=' then
          Input_HH_H2CHP_solar := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_NgasCHP_solar=' then
          Input_HH_NgasCHP_solar := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_BioCHP_solar=' then
          Input_HH_BioCHP_solar := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_HP_solar=' then
          Input_HH_HP_solar := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_EB_solar=' then
          Input_HH_EB_solar := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_BioCHP_heat=' then
          Input_HH_BioCHP_heat := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_HP_heat=' then
          Input_HH_HP_heat := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_EB_heat=' then
          Input_HH_EB_heat := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_H2CHP_eff_el=' then
          Input_HH_H2CHP_eff_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_NgasCHP_eff_el=' then
          Input_HH_NgasCHP_eff_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_BioCHP_eff_el=' then
          Input_HH_BioCHP_eff_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_HP_COP=' then
          input_HH_HP_COP := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_H2CHP_storage=' then
          Input_HH_H2CHP_Storage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_NgasCHP_storage=' then
          Input_HH_NgasCHP_Storage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_BioCHP_storage=' then
          Input_HH_BioCHP_Storage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_HP_storage=' then
          Input_HH_HP_Storage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_EB_storage=' then
          Input_HH_EB_Storage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_H2CHP_CapLimit=' then
          Input_HH_H2CHP_CapLimit := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_NgasCHP_CapLimit=' then
          Input_HH_NgasCHP_CapLimit := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_BioCHP_CapLimit=' then
          Input_HH_BioCHP_CapLimit := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_HP_CapLimit=' then
          Input_HH_HP_CapLimit := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_CSHP[1]=' then
          Input_fuel_cshp[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_CSHP[2]=' then
          Input_fuel_cshp[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_CSHP[3]=' then
          Input_fuel_cshp[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_CSHP[4]=' then
          Input_fuel_cshp[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Various[1]=' then
          Input_fuel_various[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Various[2]=' then
          Input_fuel_various[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Various[3]=' then
          Input_fuel_various[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Various[4]=' then
          Input_fuel_various[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_CO2[1]=' then
          Input_fuel_CO2[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_CO2[2]=' then
          Input_fuel_CO2[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_CO2[3]=' then
          Input_fuel_CO2[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price[1]=' then
          Input_fuel_price[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price[2]=' then
          Input_fuel_price[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price[3]=' then
          Input_fuel_price[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price[4]=' then
          Input_fuel_price[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Cen[1]=' then
          Input_Handling_Cen[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Cen[2]=' then
          Input_Handling_Cen[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Cen[3]=' then
          Input_Handling_Cen[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Cen[4]=' then
          Input_Handling_Cen[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Dec[1]=' then
          Input_Handling_Dec[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Dec[2]=' then
          Input_Handling_Dec[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Dec[3]=' then
          Input_Handling_Dec[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Dec[4]=' then
          Input_Handling_Dec[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Indv[1]=' then
          Input_Handling_Indv[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Indv[2]=' then
          Input_Handling_Indv[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Indv[3]=' then
          Input_Handling_Indv[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Indv[4]=' then
          Input_Handling_Indv[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price[6]=' then
          Input_fuel_price[6] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Transp[2]=' then
          Input_Handling_Transp[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Transp[3]=' then
          Input_Handling_Transp[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Transp[4]=' then
          Input_Handling_Transp[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_Indv[1]=' then
          Input_Tax_Indv[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_Indv[2]=' then
          Input_Tax_Indv[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_Indv[3]=' then
          Input_Tax_Indv[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_Indv[4]=' then
          Input_Tax_Indv[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_Indu[1]=' then
          Input_Tax_Indu[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_Indu[2]=' then
          Input_Tax_Indu[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_Indu[3]=' then
          Input_Tax_Indu[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_Indu[4]=' then
          Input_Tax_Indu[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_Boiler[1]=' then
          Input_Tax_Boiler[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_Boiler[2]=' then
          Input_Tax_Boiler[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_Boiler[3]=' then
          Input_Tax_Boiler[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_Boiler[4]=' then
          Input_Tax_Boiler[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_CHP[1]=' then
          Input_Tax_CHP[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_CHP[2]=' then
          Input_Tax_CHP[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_CHP[3]=' then
          Input_Tax_CHP[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_CHP[4]=' then
          Input_Tax_CHP[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_CO2_price=' then
          Input_CO2_price := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Maintain_price=' then
          Input_Maintain_price := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Button_Price=' then
          Input_Button_Price := Data[x + 1];
        if Data[x] = 'Input_Button_Coal=' then
          Input_button_coal := Data[x + 1];
        if Data[x] = 'Input_Button_oil=' then
          Input_button_oil := Data[x + 1];
        if Data[x] = 'Input_Button_Ngas=' then
          Input_button_Ngas := Data[x + 1];
        if Data[x] = 'Input_Button_Biomass=' then
          Input_button_Biomass := Data[x + 1];
        if Data[x] = 'input_cap_elt2_el=' then
          input_cap_elt2_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_elt2_fuel=' then
          input_eff_elt2_fuel := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_elt2_th=' then
          input_eff_elt2_th := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cap_elt3_el=' then
          input_cap_elt3_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_elt3_fuel=' then
          input_eff_elt3_fuel := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_elt3_th=' then
          input_eff_elt3_th := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cap_ELTtrans_el=' then
          input_cap_ELTtrans_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_ELTtrans_fuel=' then
          input_eff_ELTtrans_fuel := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cap_eltCHPindv_el=' then
          input_cap_eltCHPindv_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_eltCHPindv_fuel=' then
          input_eff_eltCHPindv_fuel := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cap_pump_el=' then
          input_cap_pump_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_pump_el=' then
          input_eff_pump_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cap_turbine_el=' then
          input_cap_turbine_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_turbine_el=' then
          input_eff_turbine_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_H2storage_gr2_cap=' then
          input_H2storage_gr2_cap := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_H2storage_gr3_cap=' then
          input_H2storage_gr3_cap := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_H2storage_trans_cap=' then
          input_H2storage_trans_cap := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_H2storage_CHPindv_cap=' then
          input_H2storage_CHPindv_cap := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_storage_pump_cap=' then
          input_storage_pump_cap := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_CAES_fuel_ratio=' then
          input_CAES_fuel_ratio := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'TS_input[1]=' then
          TS_Input[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'TS_input[2]=' then
          TS_Input[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'TS_input[3]=' then
          TS_Input[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'TS_input[4]=' then
          TS_Input[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'TS_input[5]=' then
          TS_Input[5] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'TS_input[6]=' then
          TS_Input[6] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'TS_input[7]=' then
          TS_Input[7] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'TS_input[8]=' then
          TS_Input[8] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'TS_input[9]=' then
          TS_Input[9] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Cooling_el_demand=' then
          Input_Cooling_el_demand := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Cooling_DHgr1_Heatdemand=' then
          Input_Cooling_DHgr1_Heatdemand := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Cooling_DHgr2_Heatdemand=' then
          Input_Cooling_DHgr2_Heatdemand := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Cooling_DHgr3_Heatdemand=' then
          Input_Cooling_DHgr3_Heatdemand := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Cooling_el_eff=' then
          Input_Cooling_el_eff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Cooling_DHgr1_eff=' then
          Input_Cooling_DHgr1_eff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Cooling_DHgr2_eff=' then
          Input_Cooling_DHgr2_eff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Cooling_DHgr3_eff=' then
          Input_Cooling_DHgr3_eff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Tax_eh_dh=' then
          Input_Tax_eh_dh := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Tax_hp_dh=' then
          Input_Tax_hp_dh := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Tax_elt_dh=' then
          Input_Tax_elt_dh := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Tax_eh_indv=' then
          Input_Tax_eh_indv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Tax_hp_indv=' then
          Input_Tax_hp_indv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Tax_elt_indv=' then
          Input_Tax_elt_indv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Tax_cars_indv=' then
          Input_Tax_cars_indv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Interest=' then
          input_Interest := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_solar_dh=' then
          input_Inv_Solar_dh := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_solar_dh=' then
          input_Period_Solar_dh := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_solar_dh=' then
          input_FOM_Solar_dh := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_CHP2=' then
          input_Inv_CHP2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_CHP2=' then
          input_Period_CHP2 := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = ' input_FOM_CHP2=' then
          input_FOM_CHP2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_HP2=' then
          input_Inv_HP2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_HP2=' then
          input_Period_HP2 := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = ' input_FOM_HP2=' then
          input_FOM_HP2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Heatstorage2=' then
          input_Inv_HeatStorage2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Heatstorage2=' then
          input_Period_HeatStorage2 := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = ' input_FOM_Heatstorage2=' then
          input_FOM_HeatStorage2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_CHP3=' then
          input_Inv_CHP3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_CHP3=' then
          input_Period_CHP3 := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = ' input_FOM_CHP3=' then
          input_FOM_CHP3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_HP3=' then
          input_Inv_HP3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_HP3=' then
          input_Period_HP3 := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = ' input_FOM_HP3=' then
          input_FOM_HP3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Heatstorage3=' then
          input_Inv_HeatStorage3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Heatstorage3=' then
          input_Period_HeatStorage3 := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = ' input_FOM_Heatstorage3=' then
          input_FOM_HeatStorage3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Boilers_dh=' then
          input_Inv_Boilers_dh := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Boilers_dh=' then
          input_Period_Boilers_dh := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Boilers_dh=' then
          input_FOM_Boilers_dh := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_PP=' then
          input_Inv_PP := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_PP=' then
          input_Period_PP := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_PP=' then
          input_FOM_PP := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Wind=' then
          input_Inv_Wind := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Wind=' then
          input_Period_Wind := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Wind=' then
          input_FOM_Wind := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_WindOffshore=' then
          input_Inv_WindOffshore := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_WindOffshore=' then
          input_Period_WindOffshore := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_WindOffshore=' then
          input_FOM_WindOffshore := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_PV=' then
          input_Inv_PV := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_PV=' then
          input_Period_PV := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_PV=' then
          input_FOM_PV := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Wave=' then
          input_Inv_Wave := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Wave=' then
          input_Period_Wave := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Wave=' then
          input_FOM_Wave := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_RiverOffHydro=' then
          input_Inv_RiverOffHydro := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_RiverOffHydro=' then
          input_Period_RiverOffHydro := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_RiverOffHydro=' then
          input_FOM_RiverOffHydro := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_HydroPower=' then
          input_Inv_HydroPower := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_HydroPower=' then
          input_Period_HydroPower := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_HydroPower=' then
          input_FOM_HydroPower := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_HydroStorage=' then
          input_Inv_HydroStorage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_HydroStorage=' then
          input_Period_HydroStorage := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_HydroStorage=' then
          input_FOM_HydroStorage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_HydroPump=' then
          input_Inv_HydroPump := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_HydroPump=' then
          input_Period_HydroPump := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_HydroPump=' then
          input_FOM_HydroPump := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Nuclear=' then
          input_Inv_Nuclear := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Nuclear=' then
          input_Period_Nuclear := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Nuclear=' then
          input_FOM_Nuclear := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Geothermal=' then
          input_Inv_Geothermal := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Geothermal=' then
          input_Period_Geothermal := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Geothermal=' then
          input_FOM_Geothermal := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Electrolyser=' then
          input_Inv_Electrolyser := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Electrolyser=' then
          input_Period_Electrolyser := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Electrolyser=' then
          input_FOM_Electrolyser := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_HydrogenStorage=' then
          input_Inv_HydrogenStorage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_HydrogenStorage=' then
          input_Period_HydrogenStorage := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_HydrogenStorage=' then
          input_FOM_HydrogenStorage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Pump=' then
          input_Inv_Pump := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Pump=' then
          input_Period_Pump := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Pump=' then
          input_FOM_Pump := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Turbine=' then
          input_Inv_Turbine := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Turbine=' then
          input_Period_Turbine := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Turbine=' then
          input_FOM_Turbine := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_PumpStorage=' then
          input_Inv_PumpStorage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_PumpStorage=' then
          input_Period_PumpStorage := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_PumpStorage=' then
          input_FOM_PumpStorage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Boilers_indv=' then
          input_Inv_Boilers_indv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Boilers_indv=' then
          input_Period_Boilers_indv := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Boilers_indv=' then
          input_FOM_Boilers_indv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_CHP_indv=' then
          input_Inv_CHP_indv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_CHP_indv=' then
          input_Period_CHP_indv := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_CHP_indv=' then
          input_FOM_CHP_indv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_HP_indv=' then
          input_Inv_HP_indv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_HP_indv=' then
          input_Period_HP_indv := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_HP_indv=' then
          input_FOM_HP_indv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_EB_indv=' then
          input_Inv_EB_indv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_EB_indv=' then
          input_Period_EB_indv := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_EB_indv=' then
          input_FOM_EB_indv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Various1=' then
          input_Inv_Various1 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Various1=' then
          input_Period_Various1 := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Various1=' then
          input_FOM_Various1 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Various2=' then
          input_Inv_Various2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Various2=' then
          input_Period_Various2 := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Various2=' then
          input_FOM_Various2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Various3=' then
          input_Inv_Various3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Various3=' then
          input_Period_Various3 := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Various3=' then
          input_FOM_Various3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_coalboiler_SolarShare=' then
          Input_HH_coalboiler_SolarShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_oilboiler_SolarShare=' then
          Input_HH_oilboiler_SolarShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_ngasboiler_SolarShare=' then
          Input_HH_Ngasboiler_SolarShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_bioboiler_SolarShare=' then
          Input_HH_Bioboiler_SolarShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_H2CHP_SolarShare=' then
          Input_HH_H2CHP_SolarShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_NgasCHP_SolarShare=' then
          Input_HH_NgasCHP_SolarShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = ' input_HH_BioCHP_SolarShare=' then
          Input_HH_BioCHP_SolarShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = ' input_HH_HP_SolarShare=' then
          Input_HH_HP_SolarShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = ' input_HH_EB_SolarShare=' then
          Input_HH_EB_SolarShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = ' input_HH_coalboiler_Solar=' then
          Input_HH_coalboiler_Solar := strtofloatSubst(Data[x + 1]);
        if Data[x] = ' input_HH_oilboiler_Solar=' then
          Input_HH_oilboiler_Solar := strtofloatSubst(Data[x + 1]);
        if Data[x] = ' input_HH_ngasboiler_Solar=' then
          Input_HH_Ngasboiler_Solar := strtofloatSubst(Data[x + 1]);
        if Data[x] = ' input_HH_bioboiler_Solar=' then
          Input_HH_Bioboiler_Solar := strtofloatSubst(Data[x + 1]);
        if Data[x] = ' Input_HH_coalboiler_Storage=' then
          Input_HH_coalboiler_Storage := strtofloatSubst(Data[x + 1]);
        if Data[x] = ' Input_HH_oilboiler_Storage=' then
          Input_HH_oilboiler_Storage := strtofloatSubst(Data[x + 1]);
        if Data[x] = ' Input_HH_Ngasboiler_Storage=' then
          Input_HH_Ngasboiler_Storage := strtofloatSubst(Data[x + 1]);
        if Data[x] = ' Input_HH_Bioboiler_Storage=' then
          Input_HH_Bioboiler_Storage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_solar_storage_gr1=' then
          input_solar_storage_gr1 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_solar_storage_gr2=' then
          input_solar_storage_gr2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_solar_storage_gr3=' then
          input_solar_storage_gr3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_solar_share_gr1=' then
          input_solar_share_gr1 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_solar_share_gr2=' then
          input_solar_share_gr2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_solar_share_gr3=' then
          input_solar_share_gr3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_solar_loss_gr1=' then
          input_solar_loss_gr1 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_solar_loss_gr2=' then
          input_solar_loss_gr2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_solar_loss_gr3=' then
          input_solar_loss_gr3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_VC_V2G=' then
          input_VC_V2G := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_CAES=' then
          input_Tax_CAES := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_VC_HydroPump=' then
          input_VC_HydroPump := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_PumpCAES=' then
          Input_Tax_PumpCAES := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_solar_indv=' then
          input_Inv_Solar_indv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_solar_indv=' then
          input_Period_Solar_indv := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_solar_indv=' then
          input_FOM_Solar_indv := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Various4=' then
          input_Inv_Various4 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Various4=' then
          input_Period_Various4 := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Various4=' then
          input_FOM_Various4 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Various5=' then
          input_Inv_Various5 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Various5=' then
          input_Period_Various5 := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Various5=' then
          input_FOM_Various5 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Various6=' then
          input_Inv_Various6 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Various6=' then
          input_Period_Various6 := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Various6=' then
          input_FOM_Various6 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt1[1]=' then
          Input_fuel_price_alt1[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt1[2]=' then
          Input_fuel_price_alt1[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt1[3]=' then
          Input_fuel_price_alt1[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt1[4]=' then
          Input_fuel_price_alt1[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt2[1]=' then
          Input_fuel_price_alt2[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt2[2]=' then
          Input_fuel_price_alt2[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt2[3]=' then
          Input_fuel_price_alt2[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt2[4]=' then
          Input_fuel_price_alt2[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_km_petrol=' then
          input_km_petrol := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price[5]=' then
          Input_fuel_price[5] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt1[5]=' then
          Input_fuel_price_alt1[5] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt2[5]=' then
          Input_fuel_price_alt2[5] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt1[6]=' then
          Input_fuel_price_alt1[6] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt2[6]=' then
          Input_fuel_price_alt2[6] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Transp[5]=' then
          Input_Handling_Transp[5] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Transp[1]=' then
          Input_Handling_Transp[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Transport[5]=' then
          Input_fuel_transport[5] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Various7=' then
          input_Inv_Various7 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Various7=' then
          input_Period_Various7 := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Various7=' then
          input_FOM_Various7 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Various8=' then
          input_Inv_Various8 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Various8=' then
          input_Period_Various8 := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Various8=' then
          input_FOM_Various8 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Various9=' then
          input_Inv_Various9 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Various9=' then
          input_Period_Various9 := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Various9=' then
          input_FOM_Various9 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Various10=' then
          input_Inv_Various10 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Various10=' then
          input_Period_Various10 := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Various10=' then
          input_FOM_Various10 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_CO2[9]=' then
          Input_fuel_CO2[9] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price[9]=' then
          Input_fuel_price[9] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Cen[9]=' then
          Input_Handling_Cen[9] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_Dec[9]=' then
          Input_Handling_Dec[9] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_Indu[9]=' then
          Input_Tax_Indu[9] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_Boiler[9]=' then
          Input_Tax_Boiler[9] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Tax_CHP[9]=' then
          Input_Tax_CHP[9] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt1[9]=' then
          Input_fuel_price_alt1[9] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt2[9]=' then
          Input_fuel_price_alt2[9] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste1_Waste=' then
          input_Waste1_Waste := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste2_Waste=' then
          input_Waste2_Waste := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste3_Waste=' then
          input_Waste3_Waste := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste1_Eff_th=' then
          input_Waste1_Eff_th := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste2_Eff_th=' then
          input_Waste2_Eff_th := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste3_Eff_th=' then
          input_Waste3_Eff_th := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste1_Eff_el=' then
          input_Waste1_Eff_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste2_Eff_el=' then
          input_Waste2_Eff_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste3_Eff_el=' then
          input_Waste3_Eff_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste1_Eff_biofueltrans=' then
          input_Waste1_Eff_biofueltrans := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste2_Eff_biofueltrans=' then
          input_Waste2_Eff_biofueltrans := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste3_Eff_biofueltrans=' then
          input_Waste3_Eff_biofueltrans := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste1_Eff_biofuelCHP=' then
          input_Waste1_Eff_biofuelCHP := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste2_Eff_biofuelCHP=' then
          input_Waste2_Eff_biofuelCHP := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste3_Eff_biofuelCHP=' then
          input_Waste3_Eff_biofuelCHP := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste1_Eff_various=' then
          input_Waste1_Eff_various := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste2_Eff_various=' then
          input_Waste2_Eff_various := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste3_Eff_various=' then
          input_Waste3_Eff_various := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste1_price_various=' then
          input_Waste1_price_various := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste2_price_various=' then
          input_Waste2_price_various := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste3_price_various=' then
          input_Waste3_price_various := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_km_waste=' then
          input_km_waste := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eh2=' then
          input_eh2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eh3=' then
          input_eh3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_cap_pp2_el=' then
          input_cap_pp2_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_eff_pp2_el=' then
          input_eff_pp2_el := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_PP2[1]=' then
          Input_fuel_pp2[1] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_PP2[2]=' then
          Input_fuel_pp2[2] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_PP2[3]=' then
          Input_fuel_pp2[3] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_PP2[4]=' then
          Input_fuel_pp2[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RSC_Waste=' then
          input_RSC_Waste := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RSC_Coal=' then
          input_RSC_Coal := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RSC_Biomass=' then
          input_RSC_Biomass := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RSC_eff_fuel_M1=' then
          input_RSC_eff_fuel_M1 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RSC_eff_elec_M1=' then
          input_RSC_eff_elec_M1 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RSC_eff_th_M1=' then
          input_RSC_eff_th_M1 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RSC_eff_fuel_M2=' then
          input_RSC_eff_fuel_M2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RSC_eff_elec_M2=' then
          input_RSC_eff_elec_M2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_RSC_eff_th_M2=' then
          input_RSC_eff_th_M2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_VC_RSC_M1=' then
          input_VC_RSC_M1 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_VC_RSC_M2=' then
          input_VC_RSC_M2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Button_WasteVar=' then
          buttonWasteVar := Data[x + 1];
        if Data[x] = 'input_Waste2_eff_th_geo=' then
          input_Waste2_eff_th_geo := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste3_eff_th_geo=' then
          input_Waste3_eff_th_geo := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste2_eff_el_geo=' then
          input_Waste2_eff_el_geo := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste3_eff_el_geo=' then
          input_Waste3_eff_el_geo := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste2_eff_steam=' then
          input_Waste2_eff_steam := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste3_eff_steam=' then
          input_Waste3_eff_steam := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste2_cop_GeoHP_steam=' then
          input_Waste2_cop_GeoHP_steam := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste3_cop_GeoHP_steam=' then
          input_Waste3_cop_GeoHP_steam := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste2_cap_steamstorage=' then
          input_Waste2_cap_steamstorage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste3_cap_steamstorage=' then
          input_Waste3_cap_steamstorage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste2_loss_steamstorage=' then
          input_Waste2_loss_steamstorage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste3_loss_steamstorage=' then
          input_Waste3_loss_steamstorage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste2_cop_GeoHP_steamstorage=' then
          input_Waste2_cop_GeoHP_steamstorage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Waste3_cop_GeoHP_steamstorage=' then
          input_Waste3_cop_GeoHP_steamstorage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Button_PumpHydro=' then
          Input_Button_PumpHydro := Data[x + 1];
        if Data[x] = 'Filnavn_waste=' then
          Filnavn_Waste := Data[x + 1];
        if Data[x] = 'TS_input[10]=' then
          TS_Input[10] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'TS_input[11]=' then
          TS_Input[11] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_stabilisation_share_waste=' then
          input_stabilisation_share_waste := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Various1Text=' then
          Various1Text := Data[x + 1];
        if Data[x] = 'Various2Text=' then
          Various2Text := Data[x + 1];
        if Data[x] = 'Various3Text=' then
          Various3Text := Data[x + 1];
        if Data[x] = 'Various4Text=' then
          Various4Text := Data[x + 1];
        if Data[x] = 'Various5Text=' then
          Various5Text := Data[x + 1];
        if Data[x] = 'Various6Text=' then
          Various6Text := Data[x + 1];
        if Data[x] = 'Various7Text=' then
          Various7Text := Data[x + 1];
        if Data[x] = 'Various8Text=' then
          Various8Text := Data[x + 1];
        if Data[x] = 'Various9Text=' then
          Various9Text := Data[x + 1];
        if Data[x] = 'Various10Text=' then
          Various10Text := Data[x + 1];
        if Data[x] = 'input_Inv_Waste_CHP=' then
          input_inv_Waste_CHP := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Waste_CHP=' then
          input_Period_Waste_CHP := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Waste_CHP=' then
          input_FOM_Waste_CHP := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_absorp_HP=' then
          input_inv_Absorp_HP := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_absorp_HP=' then
          input_Period_Absorp_HP := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_absorp_HP=' then
          input_FOM_Absorp_HP := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Biogas_elec=' then
          input_biogas_elec := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Biogas_dh1=' then
          input_biogas_dh1 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Biogas_dh2=' then
          input_biogas_dh2 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Biogas_dh3=' then
          input_biogas_dh3 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Biogas_prod=' then
          input_biogas_prod := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Filnavn_Biogas_elec=' then
          Filnavn_Biogas_elec := Data[x + 1];
        if Data[x] = 'Filnavn_Biogas_dh=' then
          Filnavn_Biogas_DH := Data[x + 1];
        if Data[x] = 'Filnavn_Biogas_prod=' then
          Filnavn_Biogas_prod := Data[x + 1];
        if Data[x] = 'Input_V2GRegulation=' then
          Input_V2GRegulation := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_km_LPG=' then
          input_km_lpg := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_Transport[9]=' then
          Input_fuel_transport[12] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_pp_cap_minimum=' then
          Input_pp_cap_minimum := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Button_IndvHPStorage=' then
          input_Button_IndvHPStorage := Data[x + 1];
        if Data[x] = 'input_GeoPower_cap=' then
          input_GeoPower_cap := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_GeoPower_eff=' then
          input_GeoPower_eff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'filnavn_GeoPower=' then
          filnavn_GeoPower := Data[x + 1];
        if Data[x] = 'Filnavn_Gasi_dh=' then
          Filnavn_Gasi_DH := Data[x + 1];
        if Data[x] = 'Input_GasiElecShare=' then
          Input_GasiElecShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_GasiDH3Share=' then
          Input_GasiDH3Share := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_GasiBiomassInput=' then
          Input_GasiBiomassInput := strtofloatSubst(Data[x + 1]);
        if Data[x] = ' Input_GasiSteamShare=' then
          Input_GasiSteamShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = ' Input_GasiSteamEff=' then
          Input_GasiSteamEff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_GasiColdgasEff=' then
          Input_GasiColdgasEff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_GasiCapInput=' then
          Input_GasiCapInput := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_GasiUpgradeEff=' then
          Input_GasiUpgradeEff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BiogasUpgradeEff=' then
          Input_BiogasUpgradeEff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BiogasWetBiomassInput=' then
          Input_BiogasWetBiomassInput := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BiogasSolidBiomassInput=' then
          Input_BiogasSolidBiomassInput := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_GasNetStorage=' then
          Input_GasNetStorage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Filnavn_Industry_Ngas=' then
          Filnavn_Industry_Ngas := Data[x + 1];
        if Data[x] = 'Filnavn_Transport_Ngas=' then
          Filnavn_transport_Ngas := Data[x + 1];
        if Data[x] = 'input_button_BiogasBiomassOutput=' then
          input_button_BiogasBiomassOutput := Data[x + 1];
        if Data[x] = 'input_Inv_Biogas=' then
          Input_inv_Biogas := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Biogas=' then
          input_Period_biogas := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Biogas=' then
          input_FOM_Biogas := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Inv_Gasi=' then
          input_Inv_Gasi := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Gasi=' then
          input_Period_gasi := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Gasi=' then
          input_FOM_Gasi := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt1[10]=' then
          Input_fuel_price_alt1[10] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt2[10]=' then
          Input_fuel_price_alt2[10] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt1[11]=' then
          Input_fuel_price_alt1[11] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt2[11]=' then
          Input_fuel_price_alt2[11] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price[10]=' then
          Input_fuel_price[10] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price[11]=' then
          Input_fuel_price[11] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_BioCon[4]=' then
          Input_Handling_BioCon[4] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_BioCon[10]=' then
          Input_Handling_BioCon[10] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Handling_BioCon[11]=' then
          Input_Handling_BioCon[11] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Filnavn_BioDiesel_Elec=' then
          Filnavn_BioDiesel_elec := Data[x + 1];
        if Data[x] = 'Input_BioDieselInput=' then
          Input_BioDieselInput := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BioDieselElecShare=' then
          Input_BioDieselElecShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BioDieselShare=' then
          Input_BioDieselShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BioDieselBiomassShare=' then
          Input_BioDieselBiomassShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_HP_StorageMaxCapLimit=' then
          Input_HH_HP_StorageMaxCapLimit := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_HH_HP_StorageMinCapLimit=' then
          Input_HH_HP_StorageMinCapLimit := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Filnavn_BioPetrol_dh=' then
          Filnavn_BioPetrol_DH := Data[x + 1];
        if Data[x] = 'Input_BioPetrolElecShare=' then
          Input_BioPetrolElecShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BioPetrolSteamShare=' then
          Input_BioPetrolSteamShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BioPetrolSteamEff=' then
          Input_BioPetrolSteamEff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BioPetrolEff=' then
          Input_BioPetrolEff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BioPetrolFoodShare=' then
          Input_BioPetrolFoodShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BioPetrolFoodValue=' then
          Input_BioPetrolFoodValue := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BioPetrolDH3Share=' then
          Input_BioPetrolDH3Share := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BioPetrolInput=' then
          Input_BioPetrolInput := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_stabilisation_share_V2G=' then
          input_stabilisation_share_V2G := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_stabilisation_share_TransmissionLine=' then
          input_stabilisation_share_TransmissionLine :=
            strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_inv_BioDiesel=' then
          Input_inv_BioDiesel := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_FOM_BioDiesel=' then
          Input_FOM_BioDiesel := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Period_BioDiesel=' then
          Input_Period_BioDiesel := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'Input_Period_BioPetrol=' then
          Input_Period_BioPetrol := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'Input_FOM_BioPetrol=' then
          Input_FOM_BioPetrol := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_inv_BioPetrol=' then
          Input_inv_BioPetrol := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_HeatPumpRegulation=' then
          Input_HeatPumpRegulation := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Filnavn_BioJP_dh=' then
          Filnavn_BioJP_DH := Data[x + 1];
        if Data[x] = 'Input_BioJPElecShare=' then
          Input_BioJPElecShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BioJPSteamShare=' then
          Input_BioJPSteamShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BioJPSteamEff=' then
          Input_BioJPSteamEff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BioJPEff=' then
          Input_BioJPEff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BioJPFoodShare=' then
          Input_BioJPFoodShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BioJPFoodValue=' then
          Input_BioJPFoodValue := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BioJPDH3Share=' then
          Input_BioJPDH3Share := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_BioJPInput=' then
          Input_BioJPInput := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Filnavn_BioJP_dh=' then
          Filnavn_BioJP_DH := Data[x + 1];
        if Data[x] = 'Input_SynHydroSynGridGas=' then
          Input_SynHydroSynGridgas := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_SynHydro_HydrogenShare=' then
          Input_SynHydro_HydrogenShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_SynHydro_eff=' then
          Input_SynHydro_Eff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_SynHydro_MaxCapacity=' then
          Input_SynHydro_MaxCapacity := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_CO2HydroMaxCapacity=' then
          Input_CO2HydroMaxCapacity := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_CO2HydroSequestrationElecEff=' then
          Input_CO2HydroSequestrationElecEff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_CO2HydroSequestrationCO2Eff=' then
          Input_CO2HydroSequestrationCO2Eff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_CO2HydroSynGridGas=' then
          Input_CO2HydroSynGridGas := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_CO2HydroElectrolyserEff=' then
          Input_CO2HydroElectrolyserEff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_SynDiesel=' then
          Input_SynDiesel := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_SynDiesel_eff=' then
          Input_SynDiesel_Eff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_SynJP=' then
          Input_SynJP := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_SynJP_eff=' then
          Input_SynJP_Eff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_SynPetrol=' then
          Input_SynPetrol := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_SynPetrol_eff=' then
          Input_SynPetrol_Eff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_GeoPower_factor=' then
          input_GeoPower_factor := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Nuclear_factor=' then
          input_nuclear_factor := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price[12]=' then
          Input_fuel_price[12] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt1[12]=' then
          Input_fuel_price_alt1[12] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt2[12]=' then
          Input_fuel_price_alt2[12] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_CO2[8]=' then
          Input_fuel_CO2[8] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price[8]=' then
          Input_fuel_price[8] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt1[8]=' then
          Input_fuel_price_alt1[8] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_fuel_price_alt2[8]=' then
          Input_fuel_price_alt2[8] := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_inv_BioJP=' then
          Input_inv_BioJP := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_FOM_BioJP=' then
          Input_FOM_BioJP := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Period_BioJP=' then
          Input_Period_BioJP := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'Input_inv_Tidal=' then
          Input_inv_Tidal := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_FOM_Tidal=' then
          Input_FOM_Tidal := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Period_Tidal=' then
          Input_Period_Tidal := round(strtofloatSubst(Data[x + 1]));;
        if Data[x] = 'Input_inv_CSP=' then
          Input_inv_CSP := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_FOM_CSP=' then
          Input_FOM_CSP := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Period_CSP=' then
          Input_Period_CSP := round(strtofloatSubst(Data[x + 1]));;
        if Data[x] = 'Input_inv_CO2Hydro=' then
          Input_inv_CO2Hydro := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_FOM_CO2Hydro=' then
          Input_FOM_CO2Hydro := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Period_CO2Hydro=' then
          Input_Period_CO2Hydro := round(strtofloatSubst(Data[x + 1]));;
        if Data[x] = 'Input_inv_SynHydro=' then
          Input_inv_SynHydro := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_FOM_SynHydro=' then
          Input_FOM_SynHydro := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Period_SynHydro=' then
          Input_Period_SynHydro := round(strtofloatSubst(Data[x + 1]));;
        if Data[x] = 'Input_inv_SynFuel=' then
          Input_inv_SynFuel := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_FOM_SynFuel=' then
          Input_FOM_SynFuel := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Period_SynFuel=' then
          Input_Period_SynFuel := round(strtofloatSubst(Data[x + 1]));;
        if Data[x] = 'Input_inv_BiogasUpgrade=' then
          Input_inv_BiogasUpgrade := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_FOM_BiogasUpgrade=' then
          Input_FOM_BiogasUpgrade := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Period_BiogasUpgrade=' then
          Input_Period_BiogasUpgrade := round(strtofloatSubst(Data[x + 1]));;
        if Data[x] = 'Input_inv_GasificationUpgrade=' then
          Input_inv_GasificationUpgrade := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_FOM_GasificationUpgrade=' then
          Input_FOM_GasificationUpgrade := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Period_GasificationUpgrade=' then
          Input_Period_GasificationUpgrade :=
            round(strtofloatSubst(Data[x + 1]));;
        if Data[x] = 'Input_SynMethanSynGridGas=' then
          Input_SynMethanSynGridgas := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_SynMethan_HydrogenShare=' then
          Input_SynMethan_HydrogenShare := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_SynMethan_eff=' then
          Input_SynMethan_Eff := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_SynMethan_MaxCapacity=' then
          Input_SynMethan_MaxCapacity := strtofloatSubst(Data[x + 1]);
        if data[x]='Input_NaturalCooling_DHgr1=' then
          Input_NaturalCooling_DHgr1:=strtofloatSubst(data[x+1]);
        if data[x]='Input_NaturalCooling_DHgr2=' then
          Input_NaturalCooling_DHgr2:=strtofloatSubst(data[x+1]);
        if data[x]='Input_NaturalCooling_DHgr3=' then
         Input_NaturalCooling_DHgr3:=strtofloatSubst(data[x+1]);
        if Data[x] = 'Filnavn_naturalcooling_demand=' then
          Filnavn_naturalcooling_demand := Data[x + 1];
        if data[x]='Input_CO2Hydro_DHgr2_Share=' then Input_CO2Hydro_DHgr2_Share:=strtofloatSubst(data[x+1]);
        if data[x]='Input_CO2Hydro_DHgr3_Share=' then Input_CO2Hydro_DHgr3_Share:=strtofloatSubst(data[x+1]);
        if data[x]='Input_TransElt_DHgr2_Share=' then Input_TransElt_DHgr2_Share:=strtofloatSubst(data[x+1]);
        if data[x]='Input_TransElt_DHgr3_Share=' then Input_TransElt_DHgr3_Share:=strtofloatSubst(data[x+1]);
        if data[x]='Input_CO2HydroHydrogenRatio=' then Input_CO2HydroHydrogenRatio:=strtofloatSubst(data[x+1]);
        if data[x]='Filnavn_Freshwater=' then Filnavn_Freshwater:=data[x+1];
        if data[x]='FreshWaterDemand=' then input_FreshWaterDemand:=strtofloatSubst(data[x+1]);
        if data[x]='input_FreshWaterStorageCapacity=' then input_FreshWaterStorageCapacity:=strtofloatSubst(data[x+1]);
        if data[x]='input_FreshWaterPumpEfficiency=' then input_FreshWaterPumpEfficiency:=strtofloatSubst(data[x+1]);
        if data[x]='input_FreshWaterPumpCapacity=' then input_FreshWaterPumpCapacity:=strtofloatSubst(data[x+1]);
        if data[x]='input_DesalinationPlantCapacity=' then input_DesalinationPlantCapacity:=strtofloatSubst(data[x+1]);
        if data[x]='input_DesalinationPlantEfficiency=' then input_DesalinationPlantEfficiency:=strtofloatSubst(data[x+1]);
        if data[x]='input_FreshWaterShare=' then input_FreshWaterShare:=strtofloatSubst(data[x+1]);
        if data[x]='input_BrineShare=' then input_BrineShare:=strtofloatSubst(data[x+1]);
        if data[x]='input_DesalinationTurbineEfficiency=' then input_DesalinationTurbineEfficiency:=strtofloatSubst(data[x+1]);
        if data[x]='input_DesalinationPumpEfficiency=' then input_DesalinationPumpEfficiency:=strtofloatSubst(data[x+1]);
        if data[x]='input_DesalinationTurbineCapacity=' then input_DesalinationTurbineCapacity:=strtofloatSubst(data[x+1]);
        if data[x]='input_DesalinationPumpCapacity=' then input_DesalinationPumpCapacity:=strtofloatSubst(data[x+1]);
        if data[x]='input_BrineStorageCapacity=' then input_BrineStorageCapacity:=strtofloatSubst(data[x+1]);
        if data[x]='input_BrineEnergyEquivalent=' then input_BrineEnergyEquivalent:=strtofloatSubst(data[x+1]);
        if Data[x] = 'Input_inv_Desalination=' then
          Input_inv_Desalination := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_FOM_Desalination=' then
          Input_FOM_Desalination := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Period_Desalination=' then
          Input_Period_Desalination :=
            round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'Input_inv_WaterStorage=' then
          Input_inv_WaterStorage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_FOM_WaterStorage=' then
          Input_FOM_WaterStorage := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'Input_Period_WaterStorage=' then
          Input_Period_WaterStorage :=
            round(strtofloatSubst(Data[x + 1]));

        if Data[x] = 'input_Inv_Boilers_dh_gr1=' then
          input_Inv_Boilers_dh_gr1 := strtofloatSubst(Data[x + 1]);
        if Data[x] = 'input_Period_Boilers_dh_gr1=' then
          input_Period_Boilers_dh_gr1 := round(strtofloatSubst(Data[x + 1]));
        if Data[x] = 'input_FOM_Boilers_dh_gr1=' then
          input_FOM_Boilers_dh_gr1 := strtofloatSubst(Data[x + 1]);

        if Data[x] = 'ThermalStorageDays=' then
          input_ThermalStorageDays := strtofloatSubst(Data[x + 1]);

        if data[x]='input_CO2_CCS=' then Input_CO2_CCS:=strtofloatSubst(data[x+1]);
        Input_fuel_price_alt0 := Input_fuel_price;
      end
    end;
  End;


procedure TExecuteToolMain.TestRESClick(Sender: TObject);
var lfile, lpath : string;
showresult : boolean ;

begin
  LabelTestWarning.visible:=false;
  showresult:=true;
  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile1;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res1.Visible:=true;
        res1.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile2;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res2.Visible:=true;
        res2.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile3;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res3.Visible:=true;
        res3.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile4;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res4.Visible:=true;
        res4.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile5;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res5.Visible:=true;
        res5.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

   begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile6;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res6.Visible:=true;
        res6.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile7;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res7.Visible:=true;
        res7.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile8;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res8.Visible:=true;
        res8.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

    begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile9;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res9.Visible:=true;
        res9.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

    begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile10;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res10.Visible:=true;
        res10.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile11;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res11.Visible:=true;
        res11.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile12;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res12.Visible:=true;
        res12.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile13;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res13.Visible:=true;
        res13.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile14;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res14.Visible:=true;
        res14.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile15;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res15.Visible:=true;
        res15.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile16;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res16.Visible:=true;
        res16.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile17;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res17.Visible:=true;
        res17.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile18;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res18.Visible:=true;
        res18.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile19;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res19.Visible:=true;
        res19.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile20;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res20.Visible:=true;
        res20.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile21;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res21.Visible:=true;
        res21.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

    begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile22;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res22.Visible:=true;
        res22.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

    begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile23;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res23.Visible:=true;
        res23.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile24;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res24.Visible:=true;
        res24.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

    begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile25;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res25.Visible:=true;
        res25.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

    begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile26;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res26.Visible:=true;
        res26.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

    begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile27;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res27.Visible:=true;
        res27.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

    begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile28;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if (NameRES1=TestNameRES1) and (NameRES2=TestNameRES2)
      and (NameRES3=TestNameRES3) and (NameRES4=TestNameRES4) then
      Begin
        TestRESFail.kind :=bkOK;
        TestRESFail.Caption := 'OK !';
        end else
        Begin
        res28.Visible:=true;
        res28.Caption:='RES unit issue';
        TestRESFail.Kind :=bkAbort;
        TestRESFail.Caption := 'Fail !';
        showresult:=false;
        end;
    end;
  end;

 If showresult=true then
  begin
    TestRESFail.kind :=bkOK;
    TestRESFail.Caption := 'OK !';
  end else
  begin
  showmessage('RES Names do not match. Check input tab');
    TestUnitFail.kind :=bkAbort;
    TestUnitFail.Caption := 'Fail !';
  end;
end;

procedure TExecuteToolMain.TestUnitClick(Sender: TObject);
var lfile, lpath : string;
    showresult : boolean;

begin
  LabelTestWarning.visible:=false;
  showresult:=true;
  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile1;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit1.Visible:=true;
        Unit1.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit1.Visible:=true;
        Unit1.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit1.Visible:=true;
        Unit1.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile2.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile2;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit2.Visible:=true;
        Unit2.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit2.Visible:=true;
        Unit2.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit2.Visible:=true;
        Unit2.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile3;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit3.Visible:=true;
        Unit3.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit3.Visible:=true;
        Unit3.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit3.Visible:=true;
        Unit3.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile4;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
         if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit4.Visible:=true;
        Unit4.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit4.Visible:=true;
        Unit4.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit4.Visible:=true;
        Unit4.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile5;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit5.Visible:=true;
        Unit5.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit5.Visible:=true;
        Unit5.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit5.Visible:=true;
        Unit5.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile6;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit6.Visible:=true;
        Unit6.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit6.Visible:=true;
        Unit6.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit6.Visible:=true;
        Unit6.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile7;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit7.Visible:=true;
        Unit7.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit7.Visible:=true;
        Unit7.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit7.Visible:=true;
        Unit7.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile8;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
         if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit8.Visible:=true;
        Unit8.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit8.Visible:=true;
        Unit8.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit8.Visible:=true;
        Unit8.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile9;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit9.Visible:=true;
        Unit9.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit9.Visible:=true;
        Unit9.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit9.Visible:=true;
        Unit9.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile10;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit10.Visible:=true;
        Unit10.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit10.Visible:=true;
        Unit10.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit10.Visible:=true;
        Unit10.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile11;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit11.Visible:=true;
        Unit11.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit11.Visible:=true;
        Unit11.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit11.Visible:=true;
        Unit11.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;


  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile12;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit12.Visible:=true;
        Unit12.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit12.Visible:=true;
        Unit12.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit12.Visible:=true;
        Unit12.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile13;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit13.Visible:=true;
        Unit13.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit13.Visible:=true;
        Unit13.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit13.Visible:=true;
        Unit13.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile14;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit14.Visible:=true;
        Unit14.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit14.Visible:=true;
        Unit14.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit14.Visible:=true;
        Unit14.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile15;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
         if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit15.Visible:=true;
        Unit15.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit15.Visible:=true;
        Unit15.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit15.Visible:=true;
        Unit15.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile16;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit16.Visible:=true;
        Unit16.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit16.Visible:=true;
        Unit16.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit16.Visible:=true;
        Unit16.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile17;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit17.Visible:=true;
        Unit17.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit17.Visible:=true;
        Unit17.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit17.Visible:=true;
        Unit17.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile18;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit18.Visible:=true;
        Unit18.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit18.Visible:=true;
        Unit18.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit18.Visible:=true;
        Unit18.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile19;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit19.Visible:=true;
        Unit19.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit19.Visible:=true;
        Unit19.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit19.Visible:=true;
        Unit19.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile20;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit20.Visible:=true;
        Unit20.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit20.Visible:=true;
        Unit20.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit20.Visible:=true;
        Unit20.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile21;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        unit21.Visible:=true;
        unit21.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit21.Visible:=true;
        Unit21.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit21.Visible:=true;
        Unit21.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile22;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit22.Visible:=true;
        Unit22.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit22.Visible:=true;
        Unit22.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit22.Visible:=true;
        Unit22.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile23;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit23.Visible:=true;
        Unit23.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit23.Visible:=true;
        Unit23.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit23.Visible:=true;
        Unit23.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile24;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit24.Visible:=true;
        Unit24.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit24.Visible:=true;
        Unit24.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit24.Visible:=true;
        Unit24.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile25;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit25.Visible:=true;
        Unit25.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit25.Visible:=true;
        Unit25.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit25.Visible:=true;
        Unit25.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile26;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit26.Visible:=true;
        Unit26.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit26.Visible:=true;
        Unit26.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit26.Visible:=true;
        Unit26.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile27;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit27.Visible:=true;
        Unit27.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit27.Visible:=true;
        Unit27.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit27.Visible:=true;
        Unit27.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;

  if ButtonIncludeInputFile1.Caption='Actice' then
  begin
    lfile := EnergyPlanExePath + '\energyPlan Data\Data\' + NameInputFile28;
    if FileExists(lFile) then
    begin
    read_data_file(lfile);
    Transfer_from_file_to_Input_variables;
      if CapacityUnit=TestCapacityUnit then
      Begin
        if MonetaryUnit=TestMonetaryUnit then
        Begin
        TestUnitFail.kind :=bkOK;
        TestUnitFail.Caption := 'OK !';
        end else
        Begin
        Unit28.Visible:=true;
        Unit28.Caption:='Monetary unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;

      End else
      if capacityunit<>testcapacityunit then
       Begin
       if MonetaryUnit=TestMonetaryUnit then
        Begin
        Unit28.Visible:=true;
        Unit28.Caption:='Energy unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end else
        begin
        Unit28.Visible:=true;
        Unit28.Caption:='Mon, E unit issue';
        TestUnitFail.Kind :=bkAbort;
        TestUnitFail.Caption := 'Fail !';
        showresult:=false;
        end;
      end;
    end;
  end;
 If showresult=true then
  begin
    TestUnitFail.kind :=bkOK;
    TestUnitFail.Caption := 'OK !';
  end else
  begin
  showmessage('Units do not match, check Input Files tab for more info');
    TestUnitFail.kind :=bkAbort;
    TestUnitFail.Caption := 'Fail !';
  end;
end;

procedure TExecuteToolMain.TextDblClick(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath;
  OpenDialog1.Execute;
  //edOnlinedumpfile.Text := ExtractFileName(OpenDialog1.FileName);
end;


procedure TExecuteToolMain.edProjectFileDblClick(Sender: TObject);
begin
  inherited;
  OpenDialog1.InitialDir := EnergyPlanExePath;
  OpenDialog1.Execute;
  //edProjectFile.Text := ExtractFileName(OpenDialog1.FileName);
end;

procedure TExecuteToolMain.FormCreate(Sender: TObject);

begin

  inherited;
  buSelectDataFileSum.kind :=bkHelp;
  buSelectDataFileSum.Caption := 'Not testet';
  TestUnitFail.kind :=bkHelp;
  TestUnitFail.Caption := 'Not testet';
  TestRESFail.kind :=bkHelp;
  TestResFail.Caption := 'Not testet';
  NameExecuteFile1 := 'energyPLAN.exe';
  NameExecuteFile2 := 'energyPLANold.exe';
  EnergyPlanExePath := ExtractFilePath(Application.ExeName);
  EnergyPlanExePath := StringrePlace(EnergyPlanExePath,'\energyPlan tools','',[rfIgnoreCase]);
        CapacityUnit:='MW';
    EmissionUnit := 'Mt';
    MegaUnit := 'M';
    EnergyUnit := 'TWh/year';
    StorageUnit := 'GWh';
    DesalinationUnit := '1000 m3 fresh water/hour';
    WaterStorageUnit := 'Mm3';
    MonetaryUnit:='DKK';
    NameRES1:='Wind';
    NameRES2:='Photo Voltaic';
    NameRES3:='Wave Power';
    NameRES4:='River Hydro';

  end;









procedure TExecuteToolMain.PageControl3Change(Sender: TObject);
begin
  inherited;
    StringGrid1.Cells[0, 0] := CapacityUnit;
end;

procedure TExecuteToolMain.PreviewReportClick(Sender: TObject);
begin
  inherited;
  ShowPreviewResult('MultipleExecuteToolMain');
end;

procedure TExecuteToolMain.PrinterClick(Sender: TObject);
var x, syntaks : integer;
  ELSum : double ;
begin

  inherited;
  input_printpage := True;
  input_title:=ChoseProgram.Caption;

  //monthly outputs
  for x:=1 to 8784 do hourarray_dh_gr1[x]:=DatasetSum[1,x];
  for x:=1 to 8784 do hourarray_dh_gr2[x]:=DatasetSum[2,x];
  for x:=1 to 8784 do hourarray_dh_gr3[x]:=DatasetSum[3,x];
  for x:=1 to 8784 do hourarray_dh_sum[x]:=hourarray_dh_gr1[x]+hourarray_dh_gr2[x]+hourarray_dh_gr3[x];
  calculatemonth(hourarray_dh_gr1, montharray_dh_gr1);
  calculatemonth(hourarray_dh_gr2, montharray_dh_gr2);
  calculatemonth(hourarray_dh_gr3, montharray_dh_gr3);
  calculatemonth(hourarray_dh_sum, montharray_dh);

  for x:=1 to 8784 do hourarray_solargr1[x]:=DatasetSum[4,x];
  for x:=1 to 8784 do hourarray_solargr2[x]:=DatasetSum[5,x];
  for x:=1 to 8784 do hourarray_solargr3[x]:=DatasetSum[6,x];
  for x:=1 to 8784 do hourarray_solar[x]:=hourarray_solargr1[x]+hourarray_solargr2[x]+hourarray_solargr3[x];
  calculatemonth(hourarray_solargr1, montharray_solar_gr1);
  calculatemonth(hourarray_solargr2, montharray_solar_gr2);
  calculatemonth(hourarray_solargr3, montharray_solar_gr3);
  calculatemonth(hourarray_solar, montharray_solar);
  output_solar_result_gr1:=hoursum(hourarray_solargr1);
  output_solar_result_gr1:=hoursum(hourarray_solargr2);
  output_solar_result_gr3:=hoursum(hourarray_solargr3);

  for x:=1 to 8784 do hourarray_cshp_th_gr1[x]:=DatasetSum[7,x];
  for x:=1 to 8784 do hourarray_cshp_th_gr2[x]:=DatasetSum[8,x];
  for x:=1 to 8784 do hourarray_cshp_th_gr3[x]:=DatasetSum[9,x];
  for x:=1 to 8784 do hourarray_cshp_th[x]:=hourarray_cshp_th_gr1[x]+hourarray_cshp_th_gr2[x]+hourarray_cshp_th_gr3[x];
    calculatemonth(hourarray_cshp_th_gr1, montharray_cshp_th_gr1);
  calculatemonth(hourarray_cshp_th_gr2, montharray_cshp_th_gr2);
  calculatemonth(hourarray_cshp_th_gr3, montharray_cshp_th_gr3);
  calculatemonth(hourarray_cshp_th, montharray_cshp_th);

  for x:=1 to 8784 do hourarray_dhp[x]:=DatasetSum[10,x];
  calculatemonth(hourarray_dhp, montharray_dhp);

  for x:=1 to 8784 do hourarray_chp_th_gr2[x]:=DatasetSum[11,x];
  for x:=1 to 8784 do hourarray_chp_th_gr3[x]:=DatasetSum[12,x];
  for x:=1 to 8784 do hourarray_chp_th[x]:=hourarray_chp_th_gr2[x]+hourarray_chp_th_gr3[x];
  calculatemonth(hourarray_chp_th_gr2, montharray_chp2_th);
  calculatemonth(hourarray_chp_th_gr3, montharray_chp3_th);
  calculatemonth(hourarray_chp_th, montharray_chp_th);

  for x:=1 to 8784 do hourarray_hp_th_gr2[x]:=DatasetSum[13,x];
  for x:=1 to 8784 do hourarray_hp_th_gr3[x]:=DatasetSum[14,x];
  for x:=1 to 8784 do hourarray_hp_th[x]:=hourarray_hp_th_gr2[x]+hourarray_hp_th_gr3[x];
  calculatemonth(hourarray_hp_th_gr2, montharray_hp2_th);
  calculatemonth(hourarray_hp_th_gr3, montharray_hp3_th);
  calculatemonth(hourarray_hp_th, montharray_hp_th);

  for x:=1 to 8784 do hourarray_elt2_th[x]:=DatasetSum[15,x];
  for x:=1 to 8784 do hourarray_elt3_th[x]:=DatasetSum[16,x];
  for x:=1 to 8784 do hourarray_elt_th[x]:=hourarray_elt2_th[x]+hourarray_elt3_th[x];
  calculatemonth(hourarray_elt2_th, montharray_elt2_th);
  calculatemonth(hourarray_elt3_th, montharray_elt3_th);
  calculatemonth(hourarray_elt_th, montharray_elt_th);

  for x:=1 to 8784 do hourarray_boiler2[x]:=DatasetSum[17,x];
  for x:=1 to 8784 do hourarray_boiler3[x]:=DatasetSum[18,x];
  for x:=1 to 8784 do hourarray_boiler[x]:=hourarray_boiler2[x]+hourarray_boiler3[x];
  calculatemonth(hourarray_boiler2, montharray_boiler2);
  calculatemonth(hourarray_boiler3, montharray_boiler3);
  calculatemonth(hourarray_boiler, montharray_boiler);

  for x:=1 to 8784 do hourarray_ep2[x]:=DatasetSum[19,x];
  for x:=1 to 8784 do hourarray_ep3[x]:=DatasetSum[20,x];
  for x:=1 to 8784 do hourarray_ep[x]:=hourarray_ep2[x]+hourarray_ep3[x];
  calculatemonth(hourarray_ep2, montharray_ep2);
  calculatemonth(hourarray_ep3, montharray_ep3);
  calculatemonth(hourarray_ep, montharray_ep);

  for x:=1 to 8784 do hourarray_heatstorage2[x]:=DatasetSum[21,x];
  for x:=1 to 8784 do hourarray_heatstorage3[x]:=DatasetSum[22,x];
  calculatemonth(hourarray_heatstorage2, montharray_heatstorage2);
  calculatemonth(hourarray_heatstorage3, montharray_heatstorage3);

  for x:=1 to 8784 do hourarray_heatbalance2[x]:=DatasetSum[23,x];
  for x:=1 to 8784 do hourarray_heatbalance3[x]:=DatasetSum[24,x];
  for x:=1 to 8784 do hourarray_heatbalance[x]:=hourarray_heatbalance2[x]+hourarray_heatbalance3[x];
  calculatemonth(hourarray_heatbalance2, montharray_heatbalance2);
  calculatemonth(hourarray_heatbalance3, montharray_heatbalance3);
  calculatemonth(hourarray_heatbalance, montharray_heatbalance);

  for x:=1 to 8784 do hourarray_RES1[x]:=DatasetSum[25,x];
  for x:=1 to 8784 do hourarray_RES2[x]:=DatasetSum[26,x];
  for x:=1 to 8784 do hourarray_RES3[x]:=DatasetSum[27,x];
  for x:=1 to 8784 do hourarray_RES4[x]:=DatasetSum[28,x];
  for x:=1 to 8784 do hourarray_RES_total[x]:= hourarray_RES1[x] + hourarray_RES2[x] + hourarray_RES3[x] + hourarray_RES4[x];
  calculatemonth(hourarray_RES1, montharray_RES1);
  calculatemonth(hourarray_RES2, montharray_RES2);
  calculatemonth(hourarray_RES3, montharray_RES3);
  calculatemonth(hourarray_RES4, montharray_RES4);
  calculatemonth(hourarray_RES_total, montharray_RES_total);

  for x:=1 to 8784 do hourarray_eldemand[x]:=DatasetSum[29,x];
  for x:=1 to 8784 do hourarray_Cooling_el_eldemand[x]:=DatasetSum[30,x];
  for x:=1 to 8784 do hourarray_flexible_sumprint[x]:=DatasetSum[31,x];
  for x:=1 to 8784 do hourarray_hp2_el[x]:=DatasetSum[32,x];
  for x:=1 to 8784 do hourarray_hp3_el[x]:=DatasetSum[33,x];
  for x:=1 to 8784 do hourarray_individual_HP[x]:=DatasetSum[34,x];
  calculatemonth(hourarray_eldemand, montharray_eldemand);
  calculatemonth(hourarray_eldemand_cooling, montharray_eldemand_cooling);
  calculatemonth(hourarray_flexible_sumprint, montharray_flexible_sumprint);

  for x:=1 to 8784 do hourarray_elt2_el[x]:=DatasetSum[35,x];
  for x:=1 to 8784 do hourarray_elt3_el[x]:=DatasetSum[36,x];
  calculatemonth(hourarray_elt2_el, montharray_elt2_el);
  calculatemonth(hourarray_elt3_el, montharray_elt3_el);
  for x:=1 to 8784 do hourarray_trans_electrolyser[x]:=DatasetSum[37,x];
  for x:=1 to 8784 do hourarray_CO2HydroElectricity[x]:=DatasetSum[38,x];
  for x:=1 to 8784 do hourarray_Indv_electrolyser[x]:=DatasetSum[39,x];
  For x:=1 to 8784 do hourarray_elt_el[x] := hourarray_elt2_el[x] + hourarray_elt3_el[x] +
      hourarray_trans_electrolyser[x] + hourarray_CO2HydroElectricity[x]
      + hourarray_Indv_electrolyser[x];
  calculatemonth(hourarray_elt_el, montharray_elt_el);

  for x:=1 to 8784 do hourarray_pump_el[x]:=DatasetSum[40,x];
  for x:=1 to 8784 do hourarray_Desalination_ElectricityProduction_Pump[x]:=DatasetSum[41,x];
  for x:=1 to 8784 do hourarray_DesalinationPump_ElectricityDemand[x]:=DatasetSum[42,x];
  For x:=1 to 8784 do hourarray_Pump_el_total[x] := hourarray_pump_el[x]
              + hourarray_Desalination_ElectricityProduction_Pump[x]
              + hourarray_DesalinationPump_ElectricityDemand[x];
  calculatemonth(hourarray_Pump_el_total, montharray_Pump_el_total);

  for x:=1 to 8784 do hourarray_turbine_el[x]:=DatasetSum[43,x];
  for x:=1 to 8784 do hourarray_Desalination_ElectricityProduction_Turbine[x]:=DatasetSum[44,x];
  For x:=1 to 8784 do hourarray_Turbine_el_total[x] := hourarray_turbine_el[x]
              + hourarray_Desalination_ElectricityProduction_Turbine[x];
  calculatemonth(hourarray_Turbine_el_total, montharray_turbine_el_total);

  for x:=1 to 8784 do hourarray_hydro_netresult[x]:=DatasetSum[45,x];
  for x:=1 to 8784 do hourarray_nuclear_geothermal[x]:=DatasetSum[46,x];
  for x:=1 to 8784 do hourarray_cshp_el[x]:=DatasetSum[47,x];
  for x:=1 to 8784 do hourarray_chp2_el[x]:=DatasetSum[48,x];
  for x:=1 to 8784 do hourarray_chp3_el[x]:=DatasetSum[49,x];
  for x:=1 to 8784 do hourarray_individual_CHP[x]:=DatasetSum[50,x];
  for x:=1 to 8784 do hourarray_pp_sum[x]:=DatasetSum[51,x];
  calculatemonth(hourarray_hydro_netresult, montharray_hydro_netresult);
  calculatemonth(hourarray_nuclear_geothermal, montharray_nuclear_geothermal);
  calculatemonth(hourarray_cshp_el, montharray_cshp_el);
  for x:=1 to 8784 do hourarray_chp_el[x] := hourarray_chp2_el[x] + hourarray_chp3_el[x] +
        hourarray_individual_CHP[x];
  calculatemonth(hourarray_chp_el, montharray_chp_el);
  calculatemonth(hourarray_pp_sum, montharray_pp_sum);

  for x:=1 to 8784 do hourarray_import[x]:=DatasetSum[52,x];
  for x:=1 to 8784 do hourarray_export[x]:=DatasetSum[53,x];
  calculatemonth(hourarray_import, montharray_import);
  calculatemonth(hourarray_export, montharray_export);

  for x := 1 to 8784 do hourarray_Ngas_DHPandboilers[x]:=DatasetSum[54,x];
  for x := 1 to 8784 do hourarray_ngas_chp[x]:=DatasetSum[55,x];
  for x := 1 to 8784 do hourarray_powerplantsandcaes[x]:=DatasetSum[56,x];
  for x := 1 to 8784 do hourarray_ngas_HH[x]:=DatasetSum[57,x];
  for x := 1 to 8784 do hourarray_ngas_transport[x]:=DatasetSum[58,x];
  for x := 1 to 8784 do hourarray_ngas_industry[x]:=DatasetSum[59,x];
  for x := 1 to 8784 do hourarray_ngas_totaldemand[x]:=DatasetSum[60,x];
  for x := 1 to 8784 do hourarray_biogas_prod[x]:=DatasetSum[61,x];
  for x := 1 to 8784 do hourarray_syngas[x]:=DatasetSum[62,x];
  for x := 1 to 8784 do hourarray_CO2hydroSyngas[x]:=DatasetSum[63,x];
  for x := 1 to 8784 do hourarray_hydromathanation_sum[x]:=DatasetSum[64,x];
  for x := 1 to 8784 do hourarray_SynFuelSynGridGas[x]:=DatasetSum[65,x];
  for x := 1 to 8784 do hourarray_ngas_storage[x]:=DatasetSum[66,x];
  for x := 1 to 8784 do hourarray_ngas_sum[x]:=DatasetSum[67,x];
  for x := 1 to 8784 do hourarray_ngas_import[x]:=DatasetSum[68,x];
  for x := 1 to 8784 do hourarray_ngas_export[x]:=DatasetSum[69,x];
  calculatemonth(hourarray_ngas_dhpandboilers, montharray_ngas_dhpandboilers);
  calculatemonth(hourarray_ngas_chp,montharray_ngas_chp);
  calculatemonth(hourarray_PowerPlantsandCAES, montharray_ngas_powerplantsandcaes);
  calculatemonth(hourarray_ngas_hh, montharray_ngas_individual);
  calculatemonth(hourarray_ngas_transport, montharray_ngas_transport);
  calculatemonth(hourarray_ngas_industry, montharray_ngas_IndustryandVarious);
  calculatemonth (hourarray_ngas_totaldemand, montharray_ngas_totaldemand);
  calculatemonth(hourarray_biogas_prod, montharray_ngas_biogas);
  calculatemonth(hourarray_syngas, montharray_ngas_syngas);
  calculatemonth(hourarray_CO2hydroSyngas,montharray_CO2hydroSyngas);
  calculatemonth(hourarray_hydromathanation_sum,montharray_hydromathanation_sum);
  calculatemonth(hourarray_SynFuelSynGridGas,montharray_SynFuelSynGridGas);
  calculatemonth(hourarray_ngas_storage,montharray_ngas_storage);
  calculatemonth(hourarray_ngas_sum,montharray_ngas_sum);
  calculatemonth(hourarray_ngas_import,montharray_ngas_import);
  calculatemonth(hourarray_ngas_export,montharray_ngas_export);

  for x := 1 to 8784 do hourarray_h2storage_gr2[x]:=DatasetSum[70,x];
  for x := 1 to 8784 do hourarray_h2storage_gr3[x]:=DatasetSum[71,x];
  calculatemonth(hourarray_h2storage_gr2, montharray_h2storage_gr2);
  calculatemonth(hourarray_h2storage_gr3, montharray_h2storage_gr3);

  for x := 1 to 8784 do hourarray_KEOL[x]:=DatasetSum[72,x];
  for x := 1 to 8784 do hourarray_EEOL[x]:=DatasetSum[73,x];
  calculatemonth(hourarray_KEOL,montharray_KEOL);
  calculatemonth(hourarray_EEOL,montharray_EEOL);

  for x := 1 to 8784 do hourarray_stabload[x]:=DatasetSum[203,x];
  calculatemonth(hourarray_stabload,montharray_stabload);

  for x := 1 to 8784 do hourarray_import_payment[x]:=DatasetSum[204,x];
  for x := 1 to 8784 do hourarray_export_payment[x]:=DatasetSum[205,x];
  calculatemonth(hourarray_import_payment,montharray_import_payment);
  calculatemonth(hourarray_export_payment,montharray_export_payment);

for x:= 1 to 8784 do output_annual_costs_nuclear:=DatasetSum[206,x];
for x:= 1 to 8784 do output_annual_costs_coal:=DatasetSum[207,x];
for x:= 1 to 8784 do output_annual_costs_fueloil:=DatasetSum[208,x];
for x:= 1 to 8784 do output_annual_costs_gasdiesel:=DatasetSum[209,x];
for x:= 1 to 8784 do output_annual_costs_petrol:=DatasetSum[210,x];
for x:= 1 to 8784 do output_annual_costs_ngas:=DatasetSum[211,x];
for x:= 1 to 8784 do output_annual_costs_biomass:=DatasetSum[212,x];
for x:= 1 to 8784 do output_annual_costs_food:=DatasetSum[213,x];
for x:= 1 to 8784 do output_annual_costs_waste:=DatasetSum[214,x];
for x:= 1 to 8784 do output_annual_costs_import:=DatasetSum[215,x];
for x:= 1 to 8784 do output_annual_costs_export:=DatasetSum[216,x];
for x:= 1 to 8784 do output_annual_costs_bottleneck:=DatasetSum[217,x];
for x:= 1 to 8784 do output_annual_costs_addexport:=DatasetSum[218,x];
for x:= 1 to 8784 do output_annual_costs_fuel:=DatasetSum[219,x];
for x:= 1 to 8784 do output_annual_costs_operation:=DatasetSum[220,x];
for x:= 1 to 8784 do output_annual_costs_exchange:=DatasetSum[221,x];
for x:= 1 to 8784 do output_annual_costs_CO2:=DatasetSum[222,x];
for x:= 1 to 8784 do output_annual_costs_NgasExchange:=DatasetSum[223,x];
for x:= 1 to 8784 do output_annual_costs_total:=DatasetSum[224,x];
for x:= 1 to 8784 do output_sum_fom[100]:=DatasetSum[225,x];
for x:= 1 to 8784 do output_sum_inv:=DatasetSum[226,x];




   //fuels
  for x := 1 to 9 do output_fuel_dhp[x]:=DatasetSum[74,x];
  for x := 1 to 9 do output_fuel_chp2[x]:=DatasetSum[75,x];
  for x := 1 to 9 do output_fuel_chp3[x]:=DatasetSum[76,x];
  for x := 1 to 9 do output_fuel_boiler2[x]:=DatasetSum[77,x];
  for x := 1 to 9 do output_fuel_boiler3[x]:=DatasetSum[78,x];
  for x := 1 to 9 do output_fuel_pp_pp2_sum[x]:=DatasetSum[79,x];
  for x := 1 to 9 do output_fuel_nuclear[x]:=DatasetSum[80,x];
  for x := 1 to 9 do output_fuel_hydro[x]:=DatasetSum[81,x];
  for x := 1 to 9 do output_fuel_waste[x]:=DatasetSum[82,x];
  for x := 1 to 9 do output_fuel_caes[x]:=DatasetSum[83,x];
  for x := 1 to 9 do output_fuel_bioconversion[x]:=DatasetSum[84,x];
  for x := 1 to 9 do output_fuel_synteticfuel[x]:=DatasetSum[85,x];
  for x := 1 to 9 do output_fuel_res1[x]:=DatasetSum[86,x];
  for x := 1 to 9 do output_fuel_res2[x]:=DatasetSum[87,x];
  for x := 1 to 9 do output_fuel_res3[x]:=DatasetSum[88,x];
  for x := 1 to 9 do output_fuel_res4[x]:=DatasetSum[89,x];
  for x := 1 to 9 do output_fuel_solar[x]:=DatasetSum[90,x];
  for x := 1 to 9 do output_fuel_transport[x]:=DatasetSum[91,x];
  for x := 1 to 9 do output_fuel_households[x]:=DatasetSum[92,x];
  for x := 1 to 9 do output_fuel_cshp[x]:=DatasetSum[93,x];
  for x := 1 to 9 do output_fuel_sum[x]:=DatasetSum[94,x];
  for x := 1 to 9 do output_fuel_imp_exp[x]:=DatasetSum[95,x];
  for x := 1 to 9 do output_fuel_korrigeret[x]:=DatasetSum[96,x];
  for x := 1 to 9 do output_co2[x]:=DatasetSum[97,x];
  for x := 1 to 9 do output_co2_korrigeret[x]:=DatasetSum[98,x];
  {stringfunktion(output_fuel_dhp[x],syntaks)   ;
  stringfunktion(output_fuel_chp2[x],syntaks)   ;
  stringfunktion(output_fuel_chp3[x],syntaks)   ;
  stringfunktion(output_fuel_boiler2[x],syntaks)   ;
  stringfunktion(output_fuel_boiler3[x],syntaks)   ;
  stringfunktion(output_fuel_pp_pp2_sum[x],syntaks)   ;
  stringfunktion(output_fuel_nuclear[x],syntaks)   ;
  stringfunktion(output_fuel_hydro[x],syntaks)   ;
  stringfunktion(output_fuel_waste[x],syntaks)   ;
  stringfunktion(output_fuel_caes[x],syntaks)   ;
  stringfunktion(output_fuel_bioconversion[x],syntaks)   ;
  stringfunktion(output_fuel_synteticfuel[x],syntaks)   ;
  stringfunktion(output_fuel_res1[x],syntaks)   ;
  stringfunktion(output_fuel_res2[x],syntaks)   ;
  stringfunktion(output_fuel_res3[x],syntaks)   ;
  stringfunktion(output_fuel_res4[x],syntaks)   ;
  stringfunktion(output_fuel_solar[x],syntaks)   ;
  stringfunktion(output_fuel_transport[x],syntaks)   ;
  stringfunktion(output_fuel_households[x],syntaks)   ;
  stringfunktion(output_fuel_cshp[x],syntaks)   ;
  stringfunktion(output_fuel_sum[x],syntaks)   ;
  stringfunktion(output_fuel_imp_exp[x],syntaks)   ;
  stringfunktion(output_fuel_korrigeret[x],syntaks)   ;
  stringfunktion(output_co2[x],syntaks)   ;
  stringfunktion(output_co2_korrigeret[x],syntaks)   ; }

  //inputs
  input_cooling_el_demand:=DatasetSum[99,x]  ;
  input_HH_EB_heat:=DatasetSum[100,x];

  input_res1_capacity:=DatasetSum[101,x];
  Input_res2_capacity:=DatasetSum[102,x];
  input_res3_capacity:=DatasetSum[103,x];
  input_res4_capacity:=DatasetSum[104,x];
  input_hydro_cap:=DatasetSum[105,x];
  input_nuclear_cap:=DatasetSum[106,x];
  input_geopower_cap:=DatasetSum[107,x];
  input_dh_ann_gr1:=DatasetSum[108,x];
  input_cshp_th_gr1:=DatasetSum[109,x];
  input_dh_ann_gr2:=DatasetSum[110,x];
  input_cshp_th_gr2:=DatasetSum[111,x];
  input_dh_ann_gr3:=DatasetSum[112,x];
  input_cshp_th_gr3:=DatasetSum[113,x];

  input_res1_stab_share:=DatasetSum[114,x];
  input_res2_stab_share:=DatasetSum[115,x];
  input_res3_stab_share:=DatasetSum[116,x];
  input_res4_stab_share:=DatasetSum[117,x];

  input_flexible_day_twh:=DatasetSum[118,x];
 input_flexible_week_twh:=DatasetSum[119,x];
  input_flexible_4weeks_twh:=DatasetSum[120,x];
  input_addexport_twh:=DatasetSum[121,x];
  input_transport_twh:=DatasetSum[122,x];
  input_transport_twh_v2g:=DatasetSum[123,x];

  input_cap_chp2_el:=DatasetSum[124,x];
  input_cap_hp2_el:=DatasetSum[125,x];
  input_cap_chp3_el:=DatasetSum[126,x];
  input_cap_hp3_el:=DatasetSum[127,x];
  input_cap_pp_el:=DatasetSum[128,x];
  input_storage_gr2_cap:=DatasetSum[129,x];
 { input_fixedboiler2:=DatasetSum[130,x];         }

  input_cap_boiler2_th:=DatasetSum[131,x];
  output_cap_chp2_th:=DatasetSum[136,x];
  output_cap_chp3_th:=DatasetSum[137,x];
  input_cap_boiler3_th:=DatasetSum[132,x];
  input_cshp_el_gr1:=DatasetSum[133,x];
  input_cshp_el_gr2:=DatasetSum[134,x];
  input_cshp_el_gr3:=DatasetSum[135,x];

{ input_eff_chp2_el:=hoursum(hourarray_chp2_el) / output_fuel_chp2[9];
  input_eff_chp3_el:=hoursum(hourarray_chp3_el) / output_fuel_chp3[9];
  input_eff_pp_el:=hoursum(hourarray_pp)/output_fuel_pp[9];    }

  input_storage_gr3_cap:=DatasetSum[139,x];
 { input_Fixedboiler3:=DatasetSum[140,x];

  input_eff_chp2_th:=montharray_chp2_th[16] / output_fuel_chp2[9];
  input_eff_chp3_th :=montharray_chp3_th[16] / output_fuel_chp3[9];
  input_eff_boiler2_th:=montharray_boiler2[16] / output_fuel_boiler2[9];
  input_eff_boiler3_th:=montharray_boiler3[16] / output_fuel_boiler3[9];}

  {input_eff_hp2_cop:=DatasetSum[145,x];
  input_eff_hp3_cop:=DatasetSum[146,x];   }

 { input_waste1_waste:=DatasetSum[147,x];
  input_waste1_eff_el:=DatasetSum[148,x];
  input_waste2_waste:=DatasetSum[149,x];
  input_waste2_eff_el:=DatasetSum[150,x];
  input_waste3_waste:=DatasetSum[151,x];
  input_waste3_eff_el:=DatasetSum[152,x];   }

  output_waste1_el_prod:=DatasetSum[147,x];
  output_waste2_el_prod:=DatasetSum[148,x];
  output_waste3_el_prod:=DatasetSum[149,x];

  input_stabilisation_share_min:=DatasetSum[153,x];
  input_stabilisation_share_chp2:=DatasetSum[154,x];
  input_chpgr3_cap_minimum:=DatasetSum[155,x];
  input_pp_cap_minimum:=DatasetSum[156,x];
  input_hp_maxload:=DatasetSum[157,x];
  input_max_imp_exp:=DatasetSum[158,x];



  input_nordpool_add_fac:=DatasetSum[159,x];
  input_nordpool_mult_fac:=DatasetSum[160,x];
  input_depend_fac:=DatasetSum[161,x];
  input_gasNetStorage:=DatasetSum[162,x];
  output_gasi:=DatasetSum[163,x];
  BiogasMaxProd:=DatasetSum[164,x];

  input_cap_pump_el:=DatasetSum[165,x];
  input_cap_turbine_el:=DatasetSum[166,x];
  input_cap_elt2_el:=DatasetSum[167,x];
  input_cap_elt3_el:=DatasetSum[168,x];
  input_cap_ELTtrans_el:=DatasetSum[169,x];
  input_cap_eltCHPindv_el:=DatasetSum[170,x];
  input_storage_pump_cap:=DatasetSum[171,x];
  input_H2storage_gr2_cap:=DatasetSum[172,x];
  input_h2storage_gr3_cap:=DatasetSum[173,x];
  input_h2storage_trans_cap:=DatasetSum[174,x];
  input_h2storage_CHPindv_cap:=DatasetSum[175,x];
  input_caes_fuel_ratio:=DatasetSum[176,x];

  if input_cap_pump_el=0 then
  input_eff_pump_el:=0
  else
  input_eff_pump_el:=DatasetSum[184,x]/input_cap_pump_el;

  if input_cap_turbine_el=0 then
  input_eff_turbine_el:=0 else
  input_eff_turbine_el:=DatasetSum[185,x]/input_cap_turbine_el;

  if input_cap_elt2_el=0 then
  input_eff_elt2_fuel:=0 else
  input_eff_elt2_fuel:=DatasetSum[186,x]/input_cap_elt2_el;

  if input_cap_elt3_el=0 then
  input_eff_elt3_fuel:=0 else
  input_eff_elt3_fuel:=DatasetSum[187,x]/input_cap_elt3_el;

  if input_cap_ELTtrans_el=0 then
  input_eff_ELTtrans_fuel:=0 else
  input_eff_ELTtrans_fuel:=DatasetSum[188,x]/input_cap_ELTtrans_el;

  if input_cap_eltCHPindv_el=0 then
  input_eff_eltCHPindv_fuel:=0 else
  input_eff_eltCHPindv_fuel:=DatasetSum[189,x]/input_cap_eltCHPindv_el;

  input_fuel_households[1]:=DatasetSum[177,x];
  input_fuel_cshp[1]:=DatasetSum[178,x];
  input_fuel_various[1]:=DatasetSum[179,x];
  input_fuel_transport[2]:=DatasetSum[180,x];
  input_fuel_households[2]:=DatasetSum[181,x];
  input_fuel_cshp[2]:=DatasetSum[182,x];
  input_fuel_various[2]:=DatasetSum[183,x];
  input_fuel_transport[1]:=DatasetSum[190,x];
  input_Fuel_transport[5]:=DatasetSum[191,x];

  if input_cap_elt2_el=0 then
  input_eff_elt2_th:=0 else
  input_eff_elt2_th:=DatasetSum[192,x]/input_cap_elt2_el;

  if input_cap_elt3_el=0 then
  input_eff_elt3_th:=0 else
  input_eff_elt3_th:=DatasetSum[193,x]/input_cap_elt3_el;

  input_fuel_transport[3]:=DatasetSum[194,x];
  input_fuel_transport[9]:=DatasetSum[195,x];
  input_fuel_households[3]:=DatasetSum[196,x];
  input_fuel_cshp[3]:=DatasetSum[197,x];
  input_fuel_various[3]:=DatasetSum[198,x];
  input_fuel_transport[4]:=DatasetSum[199,x];
  input_fuel_households[4]:=DatasetSum[200,x];
  input_fuel_cshp[4]:=DatasetSum[201,x];
  input_fuel_various[4]:=DatasetSum[202,x];



 // output_Waste1_el_prod := input_Waste1_Waste * input_Waste1_Eff_el;
 // output_Waste2_el_prod := input_Waste2_Waste * input_Waste2_Eff_el;
 // output_Waste3_el_prod := input_Waste3_Waste * input_Waste3_Eff_el;
  output_Sum_Waste_el_prod := output_Waste1_el_prod + output_Waste2_el_prod + output_Waste3_el_prod;


  for x := 1 to 8784 do hourarray_nordpool_prices[x]:=DatasetSum[235,x];
  output_average_price := hourave(hourarray_nordpool_prices)/countinc ;


  for x := 1 to 16 do montharray_geopower[x]:=DatasetSum[227,x];
  for x := 1 to 8784 do hourarray_waste_el_gr1[x]:=DatasetSum[228,x];
  for x := 1 to 8784 do hourarray_waste_el_gr2[x]:=DatasetSum[229,x];
  for x := 1 to 8784 do hourarray_waste_el_gr3[x]:=DatasetSum[230,x];
  for x := 1 to 16 do montharray_hp_el[x]:=DatasetSum[231,x];
    for x := 1 to 16 do montharray_EB_el_total[x]:=DatasetSum[232,x];
  for x := 1 to 16 do montharray_pp[x]:=DatasetSum[234,x] ;

  for x := 1 to 8784 do hourarray_pp[x]:=DatasetSum[141,x];
  for x := 1 to 8784 do hourarrayfixedboiler2[x]:=DatasetSum[143,x];
  for x := 1 to 8784 do hourarrayfixedboiler3[x]:=DatasetSum[144,x];
 for x := 1 to 9 do output_fuel_pp[x]:=DatasetSum[142,x];
      







  //Beregninger

  //efficiencies

      // fuel price levels

 { begin
    if input_cap_elt2_el=0 then
    input_eff_elt2_fuel:=0
    else
   input_eff_elt2_fuel:=mid_input_eff_elt2_fuel * input_cap_elt2_el/input_cap_pump_el;

  end;     }

  begin
    if output_fuel_chp2[9] = 0 then
    input_eff_chp2_th:=0
    else
    if hoursum(hourarray_chp2_el) > 0 then
    input_eff_chp2_el:=hoursum(hourarray_chp2_el) / output_fuel_chp2[9]
    else
    input_eff_chp2_el:=0
  end;
  begin
    if output_fuel_chp3[9] = 0 then
    input_eff_chp3_el:=0
    else
    if hoursum(hourarray_chp3_el) > 0 then
    input_eff_chp3_el:=hoursum(hourarray_chp3_el) / output_fuel_chp3[9]
    else
    input_eff_chp3_el:=0
  end;
 Begin
    if output_fuel_pp[9] = 0 then
    input_eff_pp_el:=0
    else
    if hoursum(hourarray_pp_sum) > 0 then
    input_eff_pp_el:=hoursum(hourarray_pp) / output_fuel_pp[9]
    else
    input_eff_pp_el:=0
  End;     
  Begin
    if output_fuel_chp2[9] = 0 then
    input_eff_chp2_th:=0
    else
    if hoursum(hourarray_chp_th_gr2)>0 then
    input_eff_chp2_th:=hoursum(hourarray_chp_th_gr2) / output_fuel_chp2[9]
    else
    input_eff_chp2_th:=0
  End;
  Begin
    if output_fuel_chp3[9] = 0 then
    input_eff_chp3_th:=0
    else
    if hoursum(hourarray_chp_th_gr3)>0 then
    input_eff_chp3_th:=hoursum(hourarray_chp_th_gr3) / output_fuel_chp3[9]
    else
    input_eff_chp3_th:=0
  End;
  Begin
    if output_fuel_boiler2[9] = 0 then
    input_eff_boiler2_th:=0
    else
    if hoursum(hourarray_boiler2)>0 then
    input_eff_boiler2_th:=montharray_boiler2[16] / output_fuel_boiler2[9]
    else
    input_eff_boiler2_th:=0
  End;
  Begin
    if output_fuel_boiler3[9] = 0 then
    input_eff_boiler3_th:=0
    else
    if hoursum(hourarray_boiler3)>0 then
    input_eff_boiler3_th:=montharray_boiler3[16] / output_fuel_boiler3[9]
    else
    input_eff_boiler3_th:=0
  End;

  Begin
    if hoursum(hourarray_hp2_el)<>0 then
    input_eff_hp2_cop:=hoursum(hourarray_hp_th_gr2)/hoursum(hourarray_hp2_el);

  End;
    Begin
    if hoursum(hourarray_hp3_el)<>0 then
    input_eff_hp3_cop:=hoursum(hourarray_hp_th_gr3)/hoursum(hourarray_hp3_el);

  End;

  // fixed boiler  
  Begin
    if hourarrayfixedboiler2[x] > 0 then
    begin
      for x := 1 to 8784 do
      input_fixedboiler2:=hourarrayfixedboiler2[x]/hoursum(hourarray_dh_gr2)*100*8784/1000000;
      end
   else
    for x := 1 to 8784 do
      input_fixedboiler2:=0;

  End;

   Begin
    if hourarrayfixedboiler3[x] > 0 then
    begin
      for x := 1 to 8784 do
      input_fixedboiler3:=hourarrayfixedboiler3[x]/hoursum(hourarray_dh_gr3)*100*8784/1000000;
      end
   else
    for x := 1 to 8784 do
      input_fixedboiler3:=0;

  End;

  
  Begin
  If output_fuel_sum[9] <> 0 then
    VEandel_fuel := (output_fuel_sum[4] + output_fuel_sum[5])
      / output_fuel_sum[9] * 100
  else
    VEandel_fuel := 0;
  VEelprod := Output_fuel_res1[9] + output_fuel_res2[9] + output_fuel_res3[9]
    + output_fuel_res4[9] + output_fuel_hydro[9] + montharray_GeoPower[16]
    + hoursum(hourarray_waste_el_gr1) + hoursum(hourarray_waste_el_gr2)
    + hoursum(hourarray_waste_el_gr3);
  If Output_fuel_chp2[9] <> 0 then
    VEelprod := VEelprod + hoursum(hourarray_chp2_el) * Output_fuel_chp2[4]
      / Output_fuel_chp2[9];
  If Output_fuel_chp3[9] <> 0 then
    VEelprod := VEelprod + hoursum(hourarray_chp3_el) * Output_fuel_chp3[4]
      / Output_fuel_chp3[9];
  If Output_fuel_pp_pp2_Sum[9] <> 0 then
    VEelprod := VEelprod + montharray_pp[16] * Output_fuel_pp_pp2_Sum[4]
      / Output_fuel_pp_pp2_Sum[9];
  ElSum := montharray_eldemand[16]{ + montharray_flexible_sumprint[16]
    + montharray_hp_el[16] + montharray_elt_el[16] + montharray_EB_el_total
    [16] + montharray_pump_el[16]};   //Den giver ikke helt det samme som i originalen? Det er som om noget mangler?
  if ElSum <> 0 then
    VEandel_el := VEelprod / ElSum * 100
  else
    VEandel_el := 100;
End;

  Begin
  if input_eff_chp2_el <> 0 then
    output_cap_chp2_th := input_cap_chp2_el * input_eff_chp2_th /
      input_eff_chp2_el
  else
    output_cap_chp2_th := 0;
  output_cap_hp2_th := input_cap_hp2_el * input_eff_hp2_cop;

  if input_eff_chp3_el <> 0 then
    output_cap_chp3_th := input_cap_chp3_el * input_eff_chp3_th /
      input_eff_chp3_el
  else
    output_cap_chp3_th := 0;
  output_cap_hp3_th := input_cap_hp3_el * input_eff_hp3_cop;

  if input_eff_elt2_fuel <> 0 then
    output_cap_elt2_th := input_cap_elt2_el * input_eff_elt2_th
  else
    output_cap_elt2_th := 0;

  if input_eff_elt3_fuel <> 0 then
    output_cap_elt3_th := input_cap_elt3_el * input_eff_elt3_th
  else
    output_cap_elt3_th := 0;
end;

//costs






  PrintDialog1.Execute                 ;
  MainResultRepFrm.PrintOut;
end;



procedure TExecuteToolMain.RunEnergyPlan(ACommandline,AEnergyPLANVersion: String);
var
  SEInfo: TShellExecuteInfo;
  ExitCode: DWORD;
  ExecuteFile: string;
begin
  FillChar(SEInfo, SizeOf(SEInfo), 0);
  SEInfo.cbSize := SizeOf(TShellExecuteInfo);
  with SEInfo do
  begin
    fMask := SEE_MASK_NOCLOSEPROCESS;
    Wnd := Application.Handle;
    lpFile := pChar(EnergyPlanExePath+AEnergyPLANVersion);
    lpParameters := PChar(ACommandline);
    nShow := SW_SHOWNORMAL;
  end;
  if ShellExecuteEx(@SEInfo) then
  begin
    repeat
      Application.ProcessMessages;
      GetExitCodeProcess(SEInfo.hProcess, ExitCode);
    until (ExitCode <> STILL_ACTIVE) or Application.Terminated;
  end
  else
    showmessage('Error starting Tool!');
end;








procedure TExecuteToolMain.ShapeToMoveMouseMove(Sender: TObject;
  Shift: TShiftState; X, Y: Integer);
begin
  inherited;
   if ssLeft in Shift then // only move it when Left-click is down
    MoveControl(Sender as TControl, X, Y);
end;

Procedure Findlenght (InputFile : string; var result : string);
var x, slut : integer;
    ch : char;
begin
  result:='';
  slut:= length(InputFile);
  if slut>26 then slut:=26;
  for x:=1 to 28 do
  begin
    if x<=slut
    then ch:=Inputfile[x]
    else ch:=' ';
    result:=result+ch;
  end;
end;

procedure TExecuteToolMain.FindLinesTESTNEW(Lines: TStringList);
var
  x,y,syntaks : integer;
  test: TStringList;
  txt, filtxt : string;

Begin
  {for x:=1 to 8784 do hourarray_import[x]:=DatasetSum[52,x];
  for x:=1 to 8784 do hourarray_export[x]:=DatasetSum[53,x];
  calculatemonth(hourarray_import, montharray_import);
  calculatemonth(hourarray_export, montharray_export);

  for x := 1 to 8784 do hourarray_import[x]:=DataFile1[52,x];
  for x := 1 to 8784 do hourarray_import[x]:=DataFile1[53,x];
  calculatemonth(hourarray_import, montharray_import);
  calculatemonth(hourarray_export, montharray_export);
   }


  txt:='TEST RESULT NEW:';
  Lines.add(txt);
  Lines.Add('');
  txt:='                    '+'Sum'+'              ';

  SetLength(NameInputFile1,10);
  SetLength(NameInputFile2,10);
  SetLength(NameInputFile3,10);
  SetLength(NameInputFile4,10);
  SetLength(NameInputFile5,10);
  SetLength(NameInputFile6,10);
  SetLength(NameInputFile7,10);
  SetLength(NameInputFile8,10);
  SetLength(NameInputFile9,10);
  SetLength(NameInputFile10,10);
  SetLength(NameInputFile11,10);
  SetLength(NameInputFile12,10);
  SetLength(NameInputFile13,10);
  SetLength(NameInputFile14,10);
  SetLength(NameInputFile15,10);
  SetLength(NameInputFile16,10);
  SetLength(NameInputFile17,10);
  SetLength(NameInputFile18,10);
  SetLength(NameInputFile19,10);
  SetLength(NameInputFile20,10);
  SetLength(NameInputFile21,10);
  SetLength(NameInputFile22,10);
  SetLength(NameInputFile23,10);
  SetLength(NameInputFile24,10);
  SetLength(NameInputFile25,10);
  SetLength(NameInputFile26,10);
  SetLength(NameInputFile27,10);
  SetLength(NameInputFile28,10);

  If ButtonIncludeInputFile1.Caption='Actice' then txt:=txt+NameInputFile1+'      ';
  If ButtonIncludeInputFile2.Caption='Actice' then txt:=txt+NameInputFile2+'      ';
  If ButtonIncludeInputFile3.Caption='Actice' then txt:=txt+NameInputFile3+'      ';
  If ButtonIncludeInputFile4.Caption='Actice' then txt:=txt+NameInputFile4+'      ';
  If ButtonIncludeInputFile5.Caption='Actice' then txt:=txt+NameInputFile5+'      ';
  If ButtonIncludeInputFile6.Caption='Actice' then txt:=txt+NameInputFile6+'      ';
  If ButtonIncludeInputFile7.Caption='Actice' then txt:=txt+NameInputFile7+'      ';
  If ButtonIncludeInputFile8.Caption='Actice' then txt:=txt+NameInputFile8+'      ';
  If ButtonIncludeInputFile9.Caption='Actice' then txt:=txt+NameInputFile9+'      ';
  If ButtonIncludeInputFile10.Caption='Actice' then txt:=txt+NameInputFile10+'      ';
  If ButtonIncludeInputFile11.Caption='Actice' then txt:=txt+NameInputFile11+'      ';
  If ButtonIncludeInputFile12.Caption='Actice' then txt:=txt+NameInputFile12+'      ';
  If ButtonIncludeInputFile13.Caption='Actice' then txt:=txt+NameInputFile13+'      ';
  If ButtonIncludeInputFile14.Caption='Actice' then txt:=txt+NameInputFile14+'      ';
  If ButtonIncludeInputFile15.Caption='Actice' then txt:=txt+NameInputFile15+'      ';
  If ButtonIncludeInputFile16.Caption='Actice' then txt:=txt+NameInputFile16+'      ';
  If ButtonIncludeInputFile17.Caption='Actice' then txt:=txt+NameInputFile17+'      ';
  If ButtonIncludeInputFile18.Caption='Actice' then txt:=txt+NameInputFile18+'      ';
  If ButtonIncludeInputFile19.Caption='Actice' then txt:=txt+NameInputFile19+'      ';
  If ButtonIncludeInputFile20.Caption='Actice' then txt:=txt+NameInputFile20+'      ';
  If ButtonIncludeInputFile21.Caption='Actice' then txt:=txt+NameInputFile21+'      ';
  If ButtonIncludeInputFile22.Caption='Actice' then txt:=txt+NameInputFile22+'      ';
  If ButtonIncludeInputFile23.Caption='Actice' then txt:=txt+NameInputFile23+'      ';
  If ButtonIncludeInputFile24.Caption='Actice' then txt:=txt+NameInputFile24+'      ';
  If ButtonIncludeInputFile25.Caption='Actice' then txt:=txt+NameInputFile25+'      ';
  If ButtonIncludeInputFile26.Caption='Actice' then txt:=txt+NameInputFile26+'      ';
  If ButtonIncludeInputFile27.Caption='Actice' then txt:=txt+NameInputFile27+'      ';
  If ButtonIncludeInputFile28.Caption='Actice' then txt:=txt+NameInputFile28+'      ';
  Lines.add(txt);
  Lines.Add('');
  txt:='                   ';
  If ButtonIncludeInputFile1.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile1.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile2.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile3.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile4.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile5.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile6.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile7.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile8.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile9.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile10.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile11.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile12.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile13.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile14.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile15.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile16.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile17.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile18.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile19.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile20.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile21.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile22.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile23.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile24.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile25.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile26.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile27.Caption='Actice' then txt:=txt+' Import  Export ';
  if ButtonIncludeInputFile28.Caption='Actice' then txt:=txt+' Import  Export ';
  Lines.Add('');
  Lines.add(txt);
  for x:=1 to 16 do
  begin
   txt:='';
   case x of
   1  : txt:=' January    : ';
   2  : txt:=' February   : ';
   3  : txt:=' March      : ';
   4  : txt:=' April      : ';
   5  : txt:=' May        : ';
   6  : txt:=' June       : ';
   7  : txt:=' July       : ';
   8  : txt:=' August     : ';
   9  : txt:=' September  : ';
   10 : txt:=' October    : ';
   11 : txt:=' November   : ';
   12 : txt:=' December   : ';
   13 : txt:=' Average    : ';
   14 : txt:=' Maximum    : ';
   15 : txt:=' Minimum    : ';
   16 : txt:=' Sum        : ';
   end;
   syntaks:=0;
   if x=16 then syntaks:=2;
   If ButtonIncludeInputFile1.Caption='Actice' then
   Begin
   //SUM
   for y:=1 to 8784 do hourarray_import[y]:=DatasetSum[52,y];
  for y:=1 to 8784 do hourarray_export[y]:=DatasetSum[53,y];
  calculatemonth(hourarray_import, montharray_import);
  calculatemonth(hourarray_export, montharray_export);
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);

  //File 1

   end;

    If ButtonIncludeInputFile1.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile1[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile1[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);
   end;
   //File 2
       If ButtonIncludeInputFile2.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile2[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile2[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 3
          If ButtonIncludeInputFile3.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile3[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile3[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 4
          If ButtonIncludeInputFile4.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile4[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile4[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 5
          If ButtonIncludeInputFile5.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile5[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile5[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 6
          If ButtonIncludeInputFile6.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile6[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile6[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 7
          If ButtonIncludeInputFile7.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile7[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile7[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 8
          If ButtonIncludeInputFile8.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile8[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile8[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 9
          If ButtonIncludeInputFile9.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile9[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile9[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 10
          If ButtonIncludeInputFile10.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile10[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile10[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 11
    If ButtonIncludeInputFile11.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile11[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile11[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 12
          If ButtonIncludeInputFile12.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile12[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile12[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 13
          If ButtonIncludeInputFile13.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile13[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile13[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 14
          If ButtonIncludeInputFile14.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile14[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile14[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 15
          If ButtonIncludeInputFile15.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile15[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile15[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 16
          If ButtonIncludeInputFile16.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile16[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile16[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 17
          If ButtonIncludeInputFile17.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile17[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile17[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 18
          If ButtonIncludeInputFile18.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile18[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile18[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 19
          If ButtonIncludeInputFile19.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile19[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile19[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 20
          If ButtonIncludeInputFile20.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile20[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile20[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 21
          If ButtonIncludeInputFile21.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile21[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile21[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 22
          If ButtonIncludeInputFile22.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile22[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile22[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;
   //File 23
          If ButtonIncludeInputFile23.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile23[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile23[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 24
          If ButtonIncludeInputFile24.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile24[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile24[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 25
          If ButtonIncludeInputFile25.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile25[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile25[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 26
          If ButtonIncludeInputFile26.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile26[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile26[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 27
          If ButtonIncludeInputFile27.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile27[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile27[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;

   //File 28
          If ButtonIncludeInputFile28.Caption='Actice' then
    for y := 1 to 8784 do hourarray_import[y]:=DataFile28[52,y];
    for y := 1 to 8784 do hourarray_export[y]:=DataFile28[53,y];
    calculatemonth(hourarray_import, montharray_import);
    calculatemonth(hourarray_export, montharray_export)   ;

   Begin
     txt:= txt + stringfunktion(montharray_import[x], syntaks);
     txt:= txt + stringfunktion(montharray_export[x], syntaks);
     //txt:= txt + stringfunktion(DataSetSum[52,x], syntaks);
     //txt:= txt + stringfunktion(TestDataSet12[x], syntaks);

   end;


   Lines.add(txt);
  end;
end;


procedure TExecuteToolMain.FindLinesTEST(Lines: TStringList);
var
  x,syntaks : integer;
  test: TStringList;
  txt, filtxt : string;
Begin

End;
{  txt:='TEST RESULT:';
  Lines.add(txt);
  Lines.Add('');
  txt:='                     ';
  Findlenght(NameInputFile1,filtxt);
  If ButtonIncludeInputFile1.Caption='Actice'then txt:=txt+'   '+filtxt;
  Findlenght(NameInputFile2,filtxt);
  If ButtonIncludeInputFile2.Caption='Actice'then txt:=txt+'   '+filtxt;
  Findlenght(NameInputFile3,filtxt);
  If ButtonIncludeInputFile3.Caption='Actice'then txt:=txt+'   '+filtxt;
  Findlenght(NameInputFile4,filtxt);
  If ButtonIncludeInputFile4.Caption='Actice'then txt:=txt+'   '+filtxt;
  Findlenght(NameInputFile5,filtxt);
  If ButtonIncludeInputFile5.Caption='Actice'then txt:=txt+'   '+filtxt;
  Lines.add(txt);
  Lines.Add('');
  txt:='                     ';
  If ButtonIncludeInputFile1.Caption='Actice'then txt:=txt+'   Exe1    Exe2                ';
  If ButtonIncludeInputFile2.Caption='Actice'then txt:=txt+'   Exe1    Exe2                ';
  If ButtonIncludeInputFile3.Caption='Actice'then txt:=txt+'   Exe1    Exe2                ';
  If ButtonIncludeInputFile4.Caption='Actice'then txt:=txt+'   Exe1    Exe2                ';
  If ButtonIncludeInputFile5.Caption='Actice'then txt:=txt+'   Exe1    Exe2                ';
  Lines.add(txt);
  Lines.Add('');
  for x:=1 to 152 do
  begin
   txt:='';
   case x of
   1  : txt:=' Eldemand          : ';
   2  : txt:=' Eldemand(Cooling) : ';
   3  : txt:=' AddExport         : ';
   4  : txt:=' District Heating  : ';
   5  : txt:=' RES 1             : ';
   6  : txt:=' RES 2             : ';
   7  : txt:=' RES 3             : ';
   8  : txt:=' RES 4             : ';
   9  : txt:=' Hydro Power       : ';
   10 : txt:=' Hydro Pump        : ';
   11 : txt:=' Hydro_storage     : ';
   12 : txt:=' hydro_watersupply : ';
   13 : txt:=' hydro_waterLoss   : ';
   14 : txt:=' solar             : ';
   15 : txt:=' cshp1_th          : ';
   16 : txt:=' waste_th_gr1 m    : ';
   17 : txt:=' dhp               : ';
   18 : txt:=' cshp2_th[16]      : ';
   19 : txt:=' waste_th_gr2      : ';
   20 : txt:=' geothermal_th_gr2 : ';
   21 : txt:=' Waste_steam_gr2   : ';
   22 : txt:=' steamstorage2     : ';
   23 : txt:=' chp2_th           : ';
   24 : txt:=' hp2_th            : ';
   25 : txt:=' boiler2           : ';
   26 : txt:=' EP2               : ';
   27 : txt:=' elt2_th           : ';
   28 : txt:=' heatstorage2      : ';
   29 : txt:=' heatbalance2      : ';
   30 : txt:=' cshp3_th          : ';
   31 : txt:=' waste_th_gr3      : ';
   32 : txt:=' geothermal_th_gr3 : ';
   33 : txt:=' Waste_steam_gr3   : ';
   34 : txt:=' steamstorage3     : ';
   35 : txt:=' chp3_th           : ';
   36 : txt:=' hp3_th            : ';
   37 : txt:=' boiler3           : ';
   38 : txt:=' EP3               : ';
   39 : txt:=' elt3_th           : ';
   40 : txt:=' heatstorage3      : ';
   41 : txt:=' heatbalance3      : ';
   42 : txt:=' flexible_sum      : ';
   43 : txt:=' hp_el             : ';
   44 : txt:=' cshp_el           : ';
   45 : txt:=' chp_el            : ';
   46 : txt:=' pp                : ';
   47 : txt:=' pp2               : ';
   48 : txt:=' nuclear_geothermal: ';
   49 : txt:=' pump_el           : ';
   50 : txt:=' turbine_el        : ';
   51 : txt:=' PumpStorage       : ';
   52 : txt:=' elt2_el           : ';
   53 : txt:=' H2Storage_gr2     : ';
   54 : txt:=' elt3_el           : ';
   55 : txt:=' H2Storage_gr3     : ';
   56 : txt:=' transport_v2g     : ';
   57 : txt:=' v2g_charge        : ';
   58 : txt:=' v2g_discharge     : ';
   59 : txt:=' v2G_battery_cont. : ';
   60 : txt:=' trans_electrolyser: ';
   61 : txt:=' trans_H2Storage   : ';
   62 : txt:=' CO2HydroElectric  : ';
   63 : txt:=' individual_CHP    : ';
   64 : txt:=' individual_HP     : ';
   65 : txt:=' individual_HP_EB  : ';
   66 : txt:=' individual_EB     : ';
   67 : txt:=' Indv_electrolyser : ';
   68 : txt:=' Indv_H2_storage   : ';
   69 : txt:=' HH_H2CHP_price    : ';
   70 : txt:=' indv._demand_heat : ';
   71 : txt:=' indv_CHPandHP_heat: ';
   72 : txt:=' indv_Boiler_heat  : ';
   73 : txt:=' indv_Solar_heat   : ';
   74 : txt:=' indv_Storage_heat : ';
   75 : txt:=' indv_balance_heat : ';
   76 : txt:=' import            : ';
   77 : txt:=' export            : ';
   78 : txt:=' KEOL              : ';
   79 : txt:=' EEOL              : ';
   80 : txt:=' nordpool_prices   : ';
   81 : txt:=' MPrice_withoutProd: ';
   82 : txt:=' system_prices     : ';
   83 : txt:=' NordpoolDK_prices : ';
   84 : txt:=' Bottleneck_prices : ';
   85 : txt:=' import_payment    : ';
   86 : txt:=' export_payment    : ';
   87 : txt:=' flaskehals_payment: ';
   88 : txt:=' AddExport_payment : ';
   89 : txt:=' Ngas_DHPAndBoilers: ';
   90 : txt:=' Ngas_CHP             : ';
   91 : txt:=' Ngas_PPAndCAES    : ';
   92 : txt:=' Ngas_Individual   : ';
   93 : txt:=' Ngas_Transport    : ';
   94 : txt:=' Ngas_IndusAndVar  : ';
   95 : txt:=' Ngas_TotalDemand  : ';
   96 : txt:=' Ngas_Biogas       : ';
   97 : txt:=' Ngas_Syngas       : ';
   98 : txt:=' CO2HydroSynGas    : ';
   99 : txt:=' HydroMathanation  : ';
   100: txt:=' SynFuelSynGridGas : ';
   101: txt:=' Ngas_storage      : ';
   102: txt:=' Ngas_StorageCont  : ';
   103: txt:=' Ngas_Sum          : ';
   104: txt:=' Ngas_Import       : ';
   105: txt:=' Ngas_Export       : ';
   106: txt:=' fuel_dhp          : ';
   107: txt:=' fuel_chp2         : ';
   108: txt:=' fuel_chp3         : ';
   109: txt:=' fuel_boiler2      : ';
   110: txt:=' fuel_boiler3      : ';
   111: txt:=' fuel_pp_pp2_Sum   : ';
   112: txt:=' fuel_nuclear      : ';
   113: txt:=' fuel_hydro        : ';
   114: txt:=' fuel_waste        : ';
   115: txt:=' fuel_elt+fuel_CAES: ';
   116: txt:=' fuel_bioConversion: ';
   117: txt:=' fuel_SynteticFuel : ';
   118: txt:=' fuel_res1         : ';
   119: txt:=' fuel_res2         : ';
   120: txt:=' fuel_res3         : ';
   121: txt:=' fuel_res4         : ';
   122: txt:=' fuel_solar        : ';
   123: txt:=' fuel_transport    : ';
   124: txt:=' fuel_households   : ';
   125: txt:=' fuel_various+cshp : ';
   126: txt:=' fuel_sum          : ';
   127: txt:=' fuel_imp_exp      : ';
   128: txt:=' fuel_korrigeret   : ';
   129: txt:=' output_CO2        : ';
   130: txt:=' CO2_korrigeret    : ';
   131: txt:=' ann_costs_nuclear : ';
   132: txt:=' ann_costs_coal    : ';
   133: txt:=' ann_costs_fueloil : ';
   134: txt:=' ann_cost_gasdiesel: ';
   135: txt:=' ann_costs_petrol  : ';
   136: txt:=' ann_costs_Ngas    : ';
   137: txt:=' ann_costs_Biomass : ';
   138: txt:=' ann_costs_food    : ';
   139: txt:=' ann_costs_waste   : ';
   140: txt:=' ann_costs_import  : ';
   141: txt:=' ann_costs_export  : ';
   142: txt:=' ann_cos_bottleneck: ';
   143: txt:=' ann_cost_Addexport: ';
   144: txt:=' ann_costs_fuel    : ';
   145: txt:=' ann_cost_operation: ';
   146: txt:=' ann_costs_exchange: ';
   147: txt:=' ann_costs_CO2     : ';
   148: txt:=' costs_NgasExchange: ';
   149: txt:=' ann_costs_total   : ';
   150: txt:=' output_sum_FOM    : ';
   151: txt:=' output_sum_Invest : ';
   152: txt:=' costs_total       : ';
   end;
   syntaks:=3;
   if x>130 then syntaks:=2;
   If ButtonIncludeInputFile1.Caption='Actice' then
   Begin
     txt:= txt + stringfunktion(TestDataSet11[1,x], syntaks);
     txt:= txt + stringfunktion(TestDataSet12[x], syntaks);
     if TestDataSet11[1,x]<>TestDataSet12[x]
     then txt:=txt + ' !!!  Fail !!! '
     else txt:=txt + '               ';
   end;
   If ButtonIncludeInputFile2.Caption='Actice' then
   Begin
     txt:= txt + stringfunktion(TestDataSet21[x], syntaks);
     txt:= txt + stringfunktion(TestDataSet22[x], syntaks);
     if TestDataSet21[x]<>TestDataSet22[x]
     then txt:=txt + ' !!!  Fail !!! '
     else txt:=txt + '               ';
   end;
   If ButtonIncludeInputFile3.Caption='Actice' then
   Begin
     txt:= txt + stringfunktion(TestDataSet31[x], syntaks);
     txt:= txt + stringfunktion(TestDataSet32[x], syntaks);
     if TestDataSet31[x]<>TestDataSet32[x]
     then txt:=txt + ' !!!  Fail !!! '
     else txt:=txt + '               ';
   end;
   If ButtonIncludeInputFile4.Caption='Actice' then
   Begin
     txt:= txt + stringfunktion(TestDataSet41[x], syntaks);
     txt:= txt + stringfunktion(TestDataSet42[x], syntaks);
     if TestDataSet41[x]<>TestDataSet42[x]
     then txt:=txt + ' !!!  Fail !!! '
     else txt:=txt + '               ';
   end;
   If ButtonIncludeInputFile5.Caption='Actice' then
   Begin
     txt:= txt + stringfunktion(TestDataSet51[x], syntaks);
     txt:= txt + stringfunktion(TestDataSet52[x], syntaks);
     if TestDataSet51[x]<>TestDataSet52[x]
     then txt:=txt + ' !!!  Fail !!! '
     else txt:=txt + '               ';
   end;
   Lines.add(txt);
  end;
End; }

end.


